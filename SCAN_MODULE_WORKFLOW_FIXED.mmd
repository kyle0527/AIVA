flowchart TB
    %% AIVA Scan Module Complete Workflow
    
    subgraph Entry["Entry Layer"]
        A[UnifiedScanEngine] 
        A1[create_fast_scan]
        A2[create_comprehensive_scan]
        B[ScanOrchestrator]
    end
    
    subgraph Strategy["Strategy Control"]
        C[StrategyController]
        C1[ConfigControlCenter]
        D1[CONSERVATIVE]
        D2[BALANCED]
        D3[DEEP]
        D4[FAST]
        D5[AGGRESSIVE]
        D6[STEALTH]
    end
    
    subgraph Config["Configuration"]
        E1[CrawlingConfig]
        E2[DynamicScanConfig]
        E3[FingerprintConfig]
        E4[SecurityConfig]
        E5[PerformanceConfig]
    end
    
    subgraph Static["Static Scan Engine"]
        H[HiHttpClient]
        H1[UrlQueueManager]
        H2[StaticContentParser]
    end
    
    subgraph Dynamic["Dynamic Scan Engine"]
        I[HeadlessBrowserPool]
        J[DynamicContentExtractor]
        K[JSInteractionSimulator]
        L[AjaxApiHandler]
    end
    
    subgraph Info["Information Gathering"]
        M[SensitiveInfoDetector]
        N[JavaScriptSourceAnalyzer]
        O[PassiveFingerprinter]
        P[FingerprintCollector]
    end
    
    subgraph Network["Network Scanning"]
        Q[NetworkScanner]
        R[ServiceDetector]
        S[VulnerabilityScanner]
        T[SensitiveDataScanner]
    end
    
    subgraph Processing["Result Processing"]
        V[ScanResultProcessor]
        W[AIOperationRecorder]
        X[EnhancedScanIntegration]
    end
    
    A1 --> A
    A2 --> A
    A --> B
    B --> C
    C --> C1
    
    C --> D1
    C --> D2
    C --> D3
    C --> D4
    C --> D5
    C --> D6
    
    C1 --> E1
    C1 --> E2
    C1 --> E3
    C1 --> E4
    C1 --> E5
    
    E1 --> H
    E2 --> I
    H --> H1
    H --> H2
    I --> J
    I --> K
    I --> L
    
    H --> M
    H --> N
    H --> O
    H --> P
    
    B --> Q
    B --> R
    B --> S
    B --> T
    
    M --> V
    N --> V
    P --> V
    Q --> V
    R --> V
    S --> V
    T --> V
    V --> W
    V --> X
    
    D1 -.-> H
    D2 -.-> H
    D2 -.-> I
    D3 -.-> I
    D4 -.-> H
    D5 -.-> I
    D6 -.-> H
    
    classDef entryStyle fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef strategyStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef engineStyle fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    
    class A,A1,A2,B entryStyle
    class C,C1,D1,D2,D3,D4,D5,D6 strategyStyle
    class H,H1,H2,I,J,K,L,M,N,O,P,Q,R,S,T engineStyle