{
  "timestamp": "2025-10-16",
  "analysis": {
    "old_files": {
      "schemas_count": 126,
      "enums_count": 31,
      "schemas_list": [
        "AIExperienceCreatedEvent",
        "AIModelDeployCommand",
        "AIModelUpdatedEvent",
        "AITraceCompletedEvent",
        "AITrainingCompletedPayload",
        "AITrainingProgressPayload",
        "AITrainingStartPayload",
        "AIVACommand",
        "AIVAEvent",
        "AIVARequest",
        "AIVAResponse",
        "AIVerificationRequest",
        "AIVerificationResult",
        "APISchemaPayload",
        "APISecurityTestPayload",
        "APITestCase",
        "AivaMessage",
        "Asset",
        "AssetInventoryItem",
        "AssetLifecyclePayload",
        "AttackPathEdge",
        "AttackPathNode",
        "AttackPathPayload",
        "AttackPathRecommendation",
        "AttackPlan",
        "AttackStep",
        "AuthZAnalysisPayload",
        "AuthZCheckPayload",
        "AuthZResultPayload",
        "Authentication",
        "BizLogicResultPayload",
        "BizLogicTestPayload",
        "CVEReference",
        "CVSSv3Metrics",
        "CWEReference",
        "CodeLevelRootCause",
        "ConfigUpdatePayload",
        "DiscoveredAsset",
        "EASMAsset",
        "EASMDiscoveryPayload",
        "EASMDiscoveryResult",
        "EnhancedAttackPath",
        "EnhancedAttackPathNode",
        "EnhancedFindingPayload",
        "EnhancedFunctionTaskTarget",
        "EnhancedIOCRecord",
        "EnhancedModuleStatus",
        "EnhancedRiskAssessment",
        "EnhancedScanRequest",
        "EnhancedScanScope",
        "EnhancedTaskExecution",
        "EnhancedVulnerability",
        "EnhancedVulnerabilityCorrelation",
        "ExecutionError",
        "ExperienceSample",
        "ExploitPayload",
        "ExploitResult",
        "FeedbackEventPayload",
        "FindingEvidence",
        "FindingImpact",
        "FindingPayload",
        "FindingRecommendation",
        "Fingerprints",
        "FunctionExecutionResult",
        "FunctionTaskContext",
        "FunctionTaskPayload",
        "FunctionTaskTarget",
        "FunctionTaskTestConfig",
        "FunctionTelemetry",
        "HeartbeatPayload",
        "JavaScriptAnalysisResult",
        "MessageHeader",
        "ModelTrainingConfig",
        "ModelTrainingResult",
        "ModuleStatus",
        "NotificationPayload",
        "OastEvent",
        "OastProbe",
        "PlanExecutionMetrics",
        "PlanExecutionResult",
        "PostExResultPayload",
        "PostExTestPayload",
        "RAGKnowledgeUpdatePayload",
        "RAGQueryPayload",
        "RAGResponsePayload",
        "RateLimit",
        "RemediationGeneratePayload",
        "RemediationResultPayload",
        "RiskAssessmentContext",
        "RiskAssessmentResult",
        "RiskFactor",
        "RiskTrendAnalysis",
        "SARIFLocation",
        "SARIFReport",
        "SARIFResult",
        "SARIFRule",
        "SARIFRun",
        "SARIFTool",
        "SASTDASTCorrelation",
        "SIEMEvent",
        "SIEMEventPayload",
        "ScanCompletedPayload",
        "ScanScope",
        "ScanStartPayload",
        "ScenarioTestResult",
        "SensitiveMatch",
        "SessionState",
        "StandardScenario",
        "Summary",
        "SystemOrchestration",
        "Target",
        "TaskDependency",
        "TaskQueue",
        "TaskUpdatePayload",
        "TechnicalFingerprint",
        "TestExecution",
        "TestStrategy",
        "ThreatIntelLookupPayload",
        "ThreatIntelResultPayload",
        "TraceRecord",
        "Vulnerability",
        "VulnerabilityCorrelation",
        "VulnerabilityDiscovery",
        "VulnerabilityLifecyclePayload",
        "VulnerabilityUpdatePayload",
        "WebhookPayload"
      ],
      "enums_list": [
        "AccessDecision",
        "AssetExposure",
        "AssetStatus",
        "AssetType",
        "AttackPathEdgeType",
        "AttackPathNodeType",
        "BusinessCriticality",
        "ComplianceFramework",
        "Confidence",
        "DataSensitivity",
        "Environment",
        "Exploitability",
        "IOCType",
        "IntelSource",
        "Location",
        "ModuleName",
        "Permission",
        "PersistenceType",
        "PostExTestType",
        "RemediationStatus",
        "RemediationType",
        "RiskLevel",
        "ScanStatus",
        "SensitiveInfoType",
        "Severity",
        "TaskStatus",
        "TestStatus",
        "ThreatLevel",
        "Topic",
        "VulnerabilityStatus",
        "VulnerabilityType"
      ]
    }
  },
  "migration_status": {
    "schemas": {
      "old_count": 126,
      "new_count": 126,
      "missing": [],
      "extra": [],
      "complete": true
    },
    "enums": {
      "old_count": 31,
      "new_count": 31,
      "missing": [],
      "extra": [],
      "complete": true
    }
  },
  "file_structure": {
    "schemas": {
      "modules": {
        "ai": {
          "classes": [
            "AIExperienceCreatedEvent",
            "AIModelDeployCommand",
            "AIModelUpdatedEvent",
            "AITraceCompletedEvent",
            "AITrainingCompletedPayload",
            "AITrainingProgressPayload",
            "AITrainingStartPayload",
            "AttackPlan",
            "AttackStep",
            "CVSSv3Metrics",
            "EnhancedVulnerability",
            "ExperienceSample",
            "ModelTrainingConfig",
            "PlanExecutionMetrics",
            "PlanExecutionResult",
            "RAGKnowledgeUpdatePayload",
            "RAGQueryPayload",
            "RAGResponsePayload",
            "SARIFLocation",
            "SARIFReport",
            "SARIFResult",
            "SARIFRule",
            "SARIFRun",
            "SARIFTool",
            "TraceRecord"
          ],
          "size": 21724,
          "lines": 584
        },
        "api_testing": {
          "classes": [],
          "size": 294,
          "lines": 15
        },
        "assets": {
          "classes": [
            "AssetInventoryItem",
            "AssetLifecyclePayload",
            "DiscoveredAsset",
            "EASMAsset",
            "TechnicalFingerprint",
            "VulnerabilityLifecyclePayload",
            "VulnerabilityUpdatePayload"
          ],
          "size": 7110,
          "lines": 187
        },
        "base": {
          "classes": [
            "Asset",
            "Authentication",
            "ExecutionError",
            "Fingerprints",
            "MessageHeader",
            "RateLimit",
            "RiskFactor",
            "ScanScope",
            "Summary",
            "TaskDependency"
          ],
          "size": 2981,
          "lines": 114
        },
        "enhanced": {
          "classes": [
            "EnhancedAttackPath",
            "EnhancedAttackPathNode",
            "EnhancedFindingPayload",
            "EnhancedFunctionTaskTarget",
            "EnhancedIOCRecord",
            "EnhancedRiskAssessment",
            "EnhancedScanRequest",
            "EnhancedScanScope",
            "EnhancedTaskExecution",
            "EnhancedVulnerabilityCorrelation"
          ],
          "size": 13706,
          "lines": 337
        },
        "findings": {
          "classes": [
            "AIVerificationRequest",
            "AIVerificationResult",
            "CodeLevelRootCause",
            "FindingEvidence",
            "FindingImpact",
            "FindingPayload",
            "FindingRecommendation",
            "JavaScriptAnalysisResult",
            "SASTDASTCorrelation",
            "SensitiveMatch",
            "Target",
            "Vulnerability",
            "VulnerabilityCorrelation"
          ],
          "size": 8376,
          "lines": 258
        },
        "messaging": {
          "classes": [
            "AIVACommand",
            "AIVAEvent",
            "AIVARequest",
            "AIVAResponse",
            "AivaMessage"
          ],
          "size": 2028,
          "lines": 80
        },
        "references": {
          "classes": [
            "CVEReference",
            "CWEReference",
            "TechnicalFingerprint",
            "VulnerabilityDiscovery"
          ],
          "size": 4952,
          "lines": 126
        },
        "risk": {
          "classes": [
            "AttackPathEdge",
            "AttackPathNode",
            "AttackPathPayload",
            "AttackPathRecommendation",
            "RiskAssessmentContext",
            "RiskAssessmentResult",
            "RiskTrendAnalysis"
          ],
          "size": 3176,
          "lines": 117
        },
        "system": {
          "classes": [
            "EnhancedModuleStatus",
            "ModelTrainingResult",
            "SessionState",
            "SystemOrchestration",
            "TaskQueue",
            "WebhookPayload"
          ],
          "size": 8076,
          "lines": 200
        },
        "tasks": {
          "classes": [
            "APISchemaPayload",
            "APISecurityTestPayload",
            "APITestCase",
            "AuthZAnalysisPayload",
            "AuthZCheckPayload",
            "AuthZResultPayload",
            "BizLogicResultPayload",
            "BizLogicTestPayload",
            "ConfigUpdatePayload",
            "EASMDiscoveryPayload",
            "EASMDiscoveryResult",
            "ExploitPayload",
            "ExploitResult",
            "FeedbackEventPayload",
            "FunctionTaskContext",
            "FunctionTaskPayload",
            "FunctionTaskTarget",
            "FunctionTaskTestConfig",
            "PostExResultPayload",
            "PostExTestPayload",
            "RemediationGeneratePayload",
            "RemediationResultPayload",
            "ScanCompletedPayload",
            "ScanStartPayload",
            "ScenarioTestResult",
            "StandardScenario",
            "TaskUpdatePayload",
            "TestExecution",
            "TestStrategy",
            "ThreatIntelLookupPayload",
            "ThreatIntelResultPayload"
          ],
          "size": 18364,
          "lines": 549
        },
        "telemetry": {
          "classes": [
            "FunctionExecutionResult",
            "FunctionTelemetry",
            "HeartbeatPayload",
            "ModuleStatus",
            "NotificationPayload",
            "OastEvent",
            "OastProbe",
            "SIEMEvent",
            "SIEMEventPayload"
          ],
          "size": 6723,
          "lines": 195
        }
      },
      "total_classes": [
        "AIExperienceCreatedEvent",
        "AIModelDeployCommand",
        "AIModelUpdatedEvent",
        "AITraceCompletedEvent",
        "AITrainingCompletedPayload",
        "AITrainingProgressPayload",
        "AITrainingStartPayload",
        "AIVACommand",
        "AIVAEvent",
        "AIVARequest",
        "AIVAResponse",
        "AIVerificationRequest",
        "AIVerificationResult",
        "APISchemaPayload",
        "APISecurityTestPayload",
        "APITestCase",
        "AivaMessage",
        "Asset",
        "AssetInventoryItem",
        "AssetLifecyclePayload",
        "AttackPathEdge",
        "AttackPathNode",
        "AttackPathPayload",
        "AttackPathRecommendation",
        "AttackPlan",
        "AttackStep",
        "AuthZAnalysisPayload",
        "AuthZCheckPayload",
        "AuthZResultPayload",
        "Authentication",
        "BizLogicResultPayload",
        "BizLogicTestPayload",
        "CVEReference",
        "CVSSv3Metrics",
        "CWEReference",
        "CodeLevelRootCause",
        "ConfigUpdatePayload",
        "DiscoveredAsset",
        "EASMAsset",
        "EASMDiscoveryPayload",
        "EASMDiscoveryResult",
        "EnhancedAttackPath",
        "EnhancedAttackPathNode",
        "EnhancedFindingPayload",
        "EnhancedFunctionTaskTarget",
        "EnhancedIOCRecord",
        "EnhancedModuleStatus",
        "EnhancedRiskAssessment",
        "EnhancedScanRequest",
        "EnhancedScanScope",
        "EnhancedTaskExecution",
        "EnhancedVulnerability",
        "EnhancedVulnerabilityCorrelation",
        "ExecutionError",
        "ExperienceSample",
        "ExploitPayload",
        "ExploitResult",
        "FeedbackEventPayload",
        "FindingEvidence",
        "FindingImpact",
        "FindingPayload",
        "FindingRecommendation",
        "Fingerprints",
        "FunctionExecutionResult",
        "FunctionTaskContext",
        "FunctionTaskPayload",
        "FunctionTaskTarget",
        "FunctionTaskTestConfig",
        "FunctionTelemetry",
        "HeartbeatPayload",
        "JavaScriptAnalysisResult",
        "MessageHeader",
        "ModelTrainingConfig",
        "ModelTrainingResult",
        "ModuleStatus",
        "NotificationPayload",
        "OastEvent",
        "OastProbe",
        "PlanExecutionMetrics",
        "PlanExecutionResult",
        "PostExResultPayload",
        "PostExTestPayload",
        "RAGKnowledgeUpdatePayload",
        "RAGQueryPayload",
        "RAGResponsePayload",
        "RateLimit",
        "RemediationGeneratePayload",
        "RemediationResultPayload",
        "RiskAssessmentContext",
        "RiskAssessmentResult",
        "RiskFactor",
        "RiskTrendAnalysis",
        "SARIFLocation",
        "SARIFReport",
        "SARIFResult",
        "SARIFRule",
        "SARIFRun",
        "SARIFTool",
        "SASTDASTCorrelation",
        "SIEMEvent",
        "SIEMEventPayload",
        "ScanCompletedPayload",
        "ScanScope",
        "ScanStartPayload",
        "ScenarioTestResult",
        "SensitiveMatch",
        "SessionState",
        "StandardScenario",
        "Summary",
        "SystemOrchestration",
        "Target",
        "TaskDependency",
        "TaskQueue",
        "TaskUpdatePayload",
        "TechnicalFingerprint",
        "TestExecution",
        "TestStrategy",
        "ThreatIntelLookupPayload",
        "ThreatIntelResultPayload",
        "TraceRecord",
        "Vulnerability",
        "VulnerabilityCorrelation",
        "VulnerabilityDiscovery",
        "VulnerabilityLifecyclePayload",
        "VulnerabilityUpdatePayload",
        "WebhookPayload"
      ],
      "count": 126
    },
    "enums": {
      "modules": {
        "assets": {
          "classes": [
            "AssetExposure",
            "AssetStatus",
            "AssetType",
            "BusinessCriticality",
            "ComplianceFramework",
            "DataSensitivity",
            "Environment"
          ],
          "size": 1751,
          "lines": 80
        },
        "common": {
          "classes": [
            "Confidence",
            "RemediationStatus",
            "RiskLevel",
            "ScanStatus",
            "Severity",
            "TaskStatus",
            "TestStatus",
            "ThreatLevel"
          ],
          "size": 1883,
          "lines": 92
        },
        "modules": {
          "classes": [
            "ModuleName",
            "Topic"
          ],
          "size": 4280,
          "lines": 112
        },
        "security": {
          "classes": [
            "AccessDecision",
            "AttackPathEdgeType",
            "AttackPathNodeType",
            "Exploitability",
            "IOCType",
            "IntelSource",
            "Location",
            "Permission",
            "PersistenceType",
            "PostExTestType",
            "RemediationType",
            "SensitiveInfoType",
            "VulnerabilityStatus",
            "VulnerabilityType"
          ],
          "size": 5271,
          "lines": 211
        }
      },
      "total_classes": [
        "AccessDecision",
        "AssetExposure",
        "AssetStatus",
        "AssetType",
        "AttackPathEdgeType",
        "AttackPathNodeType",
        "BusinessCriticality",
        "ComplianceFramework",
        "Confidence",
        "DataSensitivity",
        "Environment",
        "Exploitability",
        "IOCType",
        "IntelSource",
        "Location",
        "ModuleName",
        "Permission",
        "PersistenceType",
        "PostExTestType",
        "RemediationStatus",
        "RemediationType",
        "RiskLevel",
        "ScanStatus",
        "SensitiveInfoType",
        "Severity",
        "TaskStatus",
        "TestStatus",
        "ThreatLevel",
        "Topic",
        "VulnerabilityStatus",
        "VulnerabilityType"
      ],
      "count": 31
    }
  },
  "validation": {
    "import_tests": [
      {
        "test": "基本模組導入",
        "status": "✅ PASS",
        "detail": "schemas: 126, enums: 31"
      },
      {
        "test": "aiva_common.schemas.ScanStartPayload",
        "status": "✅ PASS",
        "detail": "導入成功"
      },
      {
        "test": "aiva_common.schemas.FunctionTaskPayload",
        "status": "✅ PASS",
        "detail": "導入成功"
      },
      {
        "test": "aiva_common.schemas.FindingPayload",
        "status": "✅ PASS",
        "detail": "導入成功"
      },
      {
        "test": "aiva_common.schemas.MessageHeader",
        "status": "✅ PASS",
        "detail": "導入成功"
      },
      {
        "test": "aiva_common.enums.ModuleName",
        "status": "✅ PASS",
        "detail": "導入成功"
      },
      {
        "test": "aiva_common.enums.VulnerabilityType",
        "status": "✅ PASS",
        "detail": "導入成功"
      },
      {
        "test": "aiva_common.enums.Severity",
        "status": "✅ PASS",
        "detail": "導入成功"
      },
      {
        "test": "aiva_common.enums.Topic",
        "status": "✅ PASS",
        "detail": "導入成功"
      }
    ]
  }
}