# æ ¸å¿ƒæ¨¡çµ„ CLI ä½¿ç”¨å¯èƒ½æ€§è¨ˆç®—å·¥å…·

## ğŸ“¦ å°ˆæ¡ˆæ¦‚è¿°

é€™å€‹å·¥å…·é›†ç”¨æ–¼**ç²¾ç¢ºè¨ˆç®—**æ ¸å¿ƒæ¨¡çµ„ï¼ˆ`services/core/**`ï¼‰ä¸­æ‰€æœ‰ CLI å…¥å£é»çš„ä½¿ç”¨å¯èƒ½æ€§æ•¸é‡ã€‚åŸºæ–¼å¯¦éš›ç¨‹å¼ç¢¼åˆ†æï¼Œæä¾›æ©Ÿå™¨å¯è®€çš„çµ±è¨ˆå ±å‘Šã€‚

---

## ğŸ¯ è¨ˆç®—çµæœæ‘˜è¦

### æ ¸å¿ƒç™¼ç¾

- **CLI å…¥å£é»æ•¸é‡**: 1 å€‹
- **å”¯ä¸€å…¥å£**: `services/core/aiva_core/ui_panel/auto_server.py`
- **ç¸½ä½¿ç”¨å¯èƒ½æ€§**: **978 ç¨®**ï¼ˆåŸºæ–¼é è¨­é…ç½®ï¼‰

### åƒæ•¸ç©ºé–“

| åƒæ•¸ | é¡å‹ | å¯é¸å€¼/å€™é¸ | æ•¸é‡ |
|------|------|-------------|------|
| `--mode` | æšèˆ‰ | `ui`, `ai`, `hybrid` | 3 |
| `--host` | å­—ä¸² | `127.0.0.1` | 1 |
| `--ports` | åˆ—è¡¨ï¼ˆæœ‰åºï¼‰ | `[3000, 8000, 8080, 8888, 9000]` | 325 ç¨®åºåˆ— |

### è¨ˆç®—å…¬å¼

```
ç¸½æ•¸ = 3 (modes) Ã— 1 (hosts) Ã— (325 (port sequences) + 1 (auto))
     = 978
```

---

## ğŸ“ ç”¢å‡ºæª”æ¡ˆ

### 1. ä¸»å·¥å…·ï¼šè¨ˆç®—å™¨
- **æª”æ¡ˆ**: `tools/count_core_cli_possibilities.py`
- **åŠŸèƒ½**: æƒææ ¸å¿ƒæ¨¡çµ„ï¼Œåˆ†æåƒæ•¸ç©ºé–“ï¼Œè¨ˆç®—ä½¿ç”¨å¯èƒ½æ€§
- **è¼¸å‡º**: JSON æ ¼å¼å ±å‘Š + å‘½ä»¤åˆ—æ‘˜è¦

### 2. é©—è­‰å·¥å…·
- **æª”æ¡ˆ**: `tools/verify_cli_calculation.py`
- **åŠŸèƒ½**: é©—è­‰æ•¸å­¸å…¬å¼æ­£ç¢ºæ€§ï¼Œåˆ—èˆ‰æ¨£æœ¬çµ„åˆ
- **ç”¨é€”**: ç¢ºä¿è¨ˆç®—é‚è¼¯ç„¡èª¤

### 3. è¨­å®šæª”ç¯„ä¾‹
- **æª”æ¡ˆ**: `tools/cli_count_config.example.json`
- **å…§å®¹**: ä¸»æ©Ÿå’Œç«¯å£å€™é¸é›†åˆçš„é…ç½®ç¯„ä¾‹
- **ç”¨é€”**: è‡ªè¨‚åƒæ•¸å€™é¸å€¼

### 4. è¼¸å‡ºå ±å‘Š
- **ä¸»å ±å‘Š**: `_out/core_cli_possibilities.json`ï¼ˆæ©Ÿå™¨å¯è®€ï¼‰
- **ç¯„ä¾‹é›†**: `_out/core_cli_possibilities_examples.json`ï¼ˆTop-K å¸¸ç”¨çµ„åˆï¼‰
- **è©³ç´°æ–‡æª”**: `_out/CORE_CLI_POSSIBILITIES_REPORT.md`ï¼ˆäººé¡å¯è®€ï¼‰

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### åŸºæœ¬ä½¿ç”¨

```bash
# ä½¿ç”¨é è¨­é…ç½®åŸ·è¡Œ
python tools/count_core_cli_possibilities.py

# æŸ¥çœ‹å ±å‘Š
cat _out/core_cli_possibilities.json

# é©—è­‰è¨ˆç®—
python tools/verify_cli_calculation.py
```

### ä½¿ç”¨è‡ªè¨‚é…ç½®

1. å»ºç«‹é…ç½®æª” `my_config.json`ï¼š
   ```json
   {
     "host_candidates": ["127.0.0.1", "0.0.0.0"],
     "port_candidates": [3000, 8080, 9000]
   }
   ```

2. åŸ·è¡Œè¨ˆç®—ï¼š
   ```bash
   python tools/count_core_cli_possibilities.py --config my_config.json
   ```

### ç”Ÿæˆæ›´å¤šç¯„ä¾‹

```bash
# ç”Ÿæˆ Top-20 å¸¸ç”¨çµ„åˆ
python tools/count_core_cli_possibilities.py --examples 20
```

---

## ğŸ“Š è¨ˆç®—é‚è¼¯èªªæ˜

### Port Sequences è¨ˆç®—

ç”±æ–¼ `--ports` åƒæ•¸ï¼š
- æ¥å— 1 å€‹æˆ–å¤šå€‹æ•´æ•¸
- **é †åºæœ‰æ„ç¾©**ï¼ˆæœƒä¾åºå˜—è©¦ç«¯å£ï¼‰
- ä¸é‡è¤‡ï¼ˆåŒä¸€å€‹ç«¯å£ä¸æœƒåˆ—å…©æ¬¡ï¼‰

å¾ N=5 å€‹å€™é¸ç«¯å£ä¸­çš„æ‰€æœ‰å¯èƒ½åºåˆ—æ•¸ï¼š

$$
\sum_{k=1}^{5} P(5,k) = \sum_{k=1}^{5} \frac{5!}{(5-k)!} = 5 + 20 + 60 + 120 + 120 = 325
$$

### ç¸½æ•¸åˆ†è§£

```
978 = 3 (modes) Ã— 326 (æ¯ç¨®æ¨¡å¼çš„çµ„åˆ)

æ¯ç¨®æ¨¡å¼çš„ 326 ç¨®çµ„åˆï¼š
  - 325 ç¨®ï¼šæŒ‡å®šä¸åŒçš„ --ports åºåˆ—
  - 1 ç¨®ï¼šä¸æŒ‡å®š --portsï¼ˆè‡ªå‹•é¸æ“‡ï¼‰
```

---

## ğŸ” å¯¦éš›ç¯„ä¾‹

### ä¸‹ç•Œï¼ˆæœ€å°å¯å€åˆ†ï¼‰

æœ€ç°¡å–®çš„ 3 ç¨®ä½¿ç”¨æ–¹å¼ï¼š

```bash
python -m services.core.aiva_core.ui_panel.auto_server --mode ui
python -m services.core.aiva_core.ui_panel.auto_server --mode ai
python -m services.core.aiva_core.ui_panel.auto_server --mode hybrid
```

### æŒ‡å®šå–®ä¸€ç«¯å£

```bash
python -m services.core.aiva_core.ui_panel.auto_server --mode ui --ports 8080
```

### æŒ‡å®šå¤šç«¯å£é †åº

```bash
python -m services.core.aiva_core.ui_panel.auto_server --mode ui --ports 3000 8000 8080
```

èªªæ˜ï¼šå„ªå…ˆå˜—è©¦ 3000ï¼Œè‹¥è¢«ä½”ç”¨å‰‡å˜—è©¦ 8000ï¼Œå†ä¸è¡Œå‰‡ 8080ã€‚

---

## ğŸ“ˆ åƒæ•¸å½±éŸ¿åˆ†æ

ä¸åŒé…ç½®å°ç¸½æ•¸çš„å½±éŸ¿ï¼š

| é…ç½® | ä¸»æ©Ÿæ•¸ | ç«¯å£æ•¸ | ç«¯å£åºåˆ— | ç¸½è¨ˆ |
|------|--------|--------|----------|------|
| é è¨­ | 1 | 5 | 325 | **978** |
| å¢åŠ ä¸»æ©Ÿ | 3 | 5 | 325 | **2,934** |
| æ¸›å°‘ç«¯å£ | 1 | 3 | 15 | **48** |
| å¢åŠ ç«¯å£ | 1 | 7 | 13,699 | **41,100** |

---

## ğŸ› ï¸ å‘½ä»¤åˆ—é¸é …

### count_core_cli_possibilities.py

```bash
python tools/count_core_cli_possibilities.py [OPTIONS]

é¸é …:
  --config PATH            è¨­å®šæª”è·¯å¾‘ï¼ˆJSON æ ¼å¼ï¼‰
  --output PATH            è¼¸å‡ºå ±å‘Šè·¯å¾‘ï¼ˆé è¨­: _out/core_cli_possibilities.jsonï¼‰
  --examples N             ç”Ÿæˆ Top-N ç¯„ä¾‹ï¼ˆé è¨­: 10ï¼‰
  --examples-output PATH   ç¯„ä¾‹è¼¸å‡ºè·¯å¾‘
```

### ç¯„ä¾‹

```bash
# ä½¿ç”¨è‡ªè¨‚é…ç½®å’Œè¼¸å‡ºè·¯å¾‘
python tools/count_core_cli_possibilities.py \
  --config my_config.json \
  --output reports/cli_stats.json \
  --examples 20
```

---

## ğŸ”¬ é©—è­‰èˆ‡æ¸¬è©¦

### åŸ·è¡Œé©—è­‰

```bash
python tools/verify_cli_calculation.py
```

é©—è­‰é …ç›®ï¼š
1. âœ“ æ’åˆ—å…¬å¼æ­£ç¢ºæ€§
2. âœ“ æ¨£æœ¬çµ„åˆåˆ—èˆ‰
3. âœ“ ç¸½æ•¸è¨ˆç®—é‚è¼¯
4. âœ“ åƒæ•¸ç¸®æ”¾å½±éŸ¿

### è¼¸å‡ºç¤ºä¾‹

```
é©—è­‰æ’åˆ—å…¬å¼ P(n,k) = n! / (n-k)!
  k=1: P(5,1) = 5
  k=2: P(5,2) = 20
  k=3: P(5,3) = 60
  k=4: P(5,4) = 120
  k=5: P(5,5) = 120
  ç¸½è¨ˆ: 325

âœ“ é©—è­‰é€šéï¼šç¸½ä½¿ç”¨å¯èƒ½æ€§ = 978 ç¨®
```

---

## ğŸ“ æ•¸å­¸èƒŒæ™¯

### æ’åˆ— vs çµ„åˆ

**ç‚ºä»€éº¼ç”¨æ’åˆ—ï¼ˆPermutationï¼‰è€Œéçµ„åˆï¼ˆCombinationï¼‰ï¼Ÿ**

å› ç‚º `--ports` åƒæ•¸çš„é †åºæœƒå½±éŸ¿è¡Œç‚ºï¼š
- `--ports 3000 8000`ï¼šå„ªå…ˆ 3000ï¼Œæ¬¡é¸ 8000
- `--ports 8000 3000`ï¼šå„ªå…ˆ 8000ï¼Œæ¬¡é¸ 3000

é€™å…©ç¨®æ˜¯**ä¸åŒçš„ä½¿ç”¨æ–¹å¼**ï¼Œå› æ­¤éœ€è¦ç”¨æ’åˆ—è¨ˆç®—ã€‚

### å…¬å¼æ¨å°

å¾ N å€‹å…ƒç´ ä¸­é¸å– k å€‹å…ƒç´ çš„æœ‰åºæ’åˆ—æ•¸ï¼š

$$
P(N, k) = \frac{N!}{(N-k)!}
$$

æ‰€æœ‰éç©ºåºåˆ—ç¸½æ•¸ï¼š

$$
\sum_{k=1}^{N} P(N, k) = \sum_{k=1}^{N} \frac{N!}{(N-k)!}
$$

---

## ğŸ“š ç›¸é—œæ–‡æª”

- [è©³ç´°å ±å‘Š](_out/CORE_CLI_POSSIBILITIES_REPORT.md)
- [æ©Ÿå™¨å¯è®€å ±å‘Š](_out/core_cli_possibilities.json)
- [ä½¿ç”¨ç¯„ä¾‹](_out/core_cli_possibilities_examples.json)
- [CLI å…¥å£é»åŸå§‹ç¢¼](services/core/aiva_core/ui_panel/auto_server.py)

---

## ğŸ”„ CI/CD æ•´åˆ

### GitHub Actions ç¯„ä¾‹

```yaml
name: Count CLI Possibilities

on: [push, pull_request]

jobs:
  count-cli:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      
      - name: Count CLI possibilities
        run: |
          python tools/count_core_cli_possibilities.py
          python tools/verify_cli_calculation.py
      
      - name: Upload reports
        uses: actions/upload-artifact@v3
        with:
          name: cli-reports
          path: _out/core_cli_*
```

---

## ğŸš§ å·²çŸ¥é™åˆ¶èˆ‡æœªä¾†æ”¹é€²

### å·²çŸ¥é™åˆ¶

1. **éœæ…‹åˆ†æ**: åŸºæ–¼ç¨‹å¼ç¢¼æ–‡æœ¬åˆ†æï¼Œä¸åŸ·è¡Œå‹•æ…‹è¿½è¹¤
2. **å–®ä¸€å…¥å£é»**: ç›®å‰æ ¸å¿ƒæ¨¡çµ„åªæœ‰ä¸€å€‹ CLI å…¥å£
3. **ä½”ä½ç¬¦è™Ÿ**: æŸäº›æª”æ¡ˆåŒ…å« `...` ä½”ä½ï¼Œå¯èƒ½æœ‰æœªå…¬é–‹çš„ CLI

### æœªä¾†æ”¹é€²

1. [ ] æ”¯æ´åƒæ•¸ä¾è³´é—œä¿‚ï¼ˆæŸäº›çµ„åˆç„¡æ•ˆï¼‰
2. [ ] æ•´åˆä½¿ç”¨æ—¥èªŒåˆ†æï¼ˆå¯¦éš›ä½¿ç”¨é »ç‡ï¼‰
3. [ ] è‡ªå‹•ç”Ÿæˆæ¸¬è©¦æ¡ˆä¾‹
4. [ ] æ”¯æ´æ›´å¤š CLI æ¡†æ¶ï¼ˆclick, typerï¼‰
5. [ ] ç”Ÿæˆäº’å‹•å¼æ–‡æª”ï¼ˆHTML/Mermaidï¼‰

---

## ğŸ“ ç‰ˆæœ¬æ­·å²

### v1.0.0 (2025-10-17)
- âœ¨ åˆå§‹ç‰ˆæœ¬
- âœ¨ æ”¯æ´ auto_server.py åˆ†æ
- âœ¨ å®Œæ•´æ•¸å­¸é©—è­‰
- âœ¨ æ©Ÿå™¨å¯è®€ JSON è¼¸å‡º
- âœ¨ Top-K ç¯„ä¾‹ç”Ÿæˆ

---

## ğŸ™ è²¢ç»æŒ‡å—

è‹¥è¦æ–°å¢å…¶ä»– CLI å…¥å£é»çš„åˆ†æï¼š

1. åœ¨ `CLIAnalyzer` é¡åˆ¥ä¸­æ–°å¢åˆ†ææ–¹æ³•
2. åœ¨ `analyze_all()` ä¸­èª¿ç”¨
3. æ›´æ–°æ¸¬è©¦å’Œé©—è­‰è…³æœ¬
4. åŸ·è¡Œé©—è­‰ç¢ºä¿æ­£ç¢ºæ€§

---

## ğŸ“„ æˆæ¬Š

èˆ‡ä¸»å°ˆæ¡ˆç›¸åŒã€‚

---

## âœ¨ çµè«–

é€™å€‹å·¥å…·é›†æä¾›äº†**ç²¾æº–ã€å¯è¿½è¹¤ã€å¯æ“´å±•**çš„æ ¸å¿ƒæ¨¡çµ„ CLI ä½¿ç”¨å¯èƒ½æ€§è¨ˆç®—ã€‚

- âœ… æ‰€æœ‰æ•¸å­—éƒ½æœ‰æ•¸å­¸è­‰æ˜
- âœ… åŸºæ–¼å¯¦éš›ç¨‹å¼ç¢¼ï¼Œéä¼°ç®—
- âœ… æ©Ÿå™¨å¯è®€ï¼Œæ˜“æ–¼ CI æ•´åˆ
- âœ… å®Œæ•´é©—è­‰ï¼Œç¢ºä¿æ­£ç¢ºæ€§

**æ ¸å¿ƒæ¨¡çµ„ç•¶å‰ CLI ä½¿ç”¨å¯èƒ½æ€§ç¸½æ•¸ï¼š978 ç¨®**
