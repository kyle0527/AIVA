flowchart TB
    n1([開始])
    n2([結束])
    n3[&amp;&#35;39;Probe common internal service ports using th...]
    n4[detected_services: list&#91;dict&#91;str, Any&#93;&#93; =...]
    n5[test_host = &amp;&#35;39;127.0.0.1&amp;&#35;39;]
    n6{for port in self._internal_se...}
    n7[try]
    n8[test_url = f&amp;&#35;39;http://&#123;test_host&#125;...]
    n9[response = test_function&#40;url, p...]
    n10{if self._is_service_response&#40;r...}
    n11[service_type = self._identify_servi...]
    n12[detected_services.append&#40;&#123;&amp;&#35;39;host&amp;...]
    n13[logger.info&#40;f&amp;&#35;39;Internal service detected: ...]
    n14[]
    n15[]
    n16[except Exception]
    n17[logger.debug&#40;f&amp;&#35;39;Error testing port &#123;p...]
    n18[continue]
    n19[]
    n20[return detected_services]
    n1 --> n3
    n3 --> n4
    n4 --> n5
    n5 --> n6
    n6 -->|Yes| n7
    n6 -->|No| n19
    n7 --> n8
    n7 --> n16
    n8 --> n9
    n9 --> n10
    n10 -->|Yes| n11
    n10 -->|No| n14
    n11 --> n12
    n12 --> n13
    n13 --> n14
    n14 --> n15
    n15 --> n6
    n16 --> n17
    n17 --> n18
    n18 --> n15
    n19 --> n20
    n20 --> n2