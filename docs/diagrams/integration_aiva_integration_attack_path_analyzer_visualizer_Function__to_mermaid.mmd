flowchart TB
    n1([開始])
    n2([結束])
    n3[&amp;&#35;39;\n        轉換為 Mermaid 流程圖\n\n        Args:\n...]
    n4[lines = &#91;&amp;&#35;39;```mermaid&amp;&#35;39;, &amp;&...]
    n5[node_ids = set&#40;&#41;]
    n6[edges = &#91;&#93;]
    n7{for &#40;_, path&#41; in enumerate&#40;paths&#41;}
    n8{for &#40;i, node&#41; in enumerate&#40;path.no...}
    n9[node_id = node.get&#40;&amp;&#35;39;id&amp;&#35;39;, f&am...]
    n10[node_type = list&#40;node.get&#40;&amp;&#35;39;label...]
    n11[safe_id = node_id.replace&#40;&amp;&#35;39;-&amp;&#35;39;...]
    n12{if safe_id not in node_ids}
    n13[shape = AttackPathVisualizer...]
    n14[lines.append&#40;f&amp;&#35;39;    &#123;safe_id&#125;&#1...]
    n15[node_ids.add&#40;safe_id&#41;]
    n16[]
    n17{if i &amp;gt; 0}
    n18[prev_node = path.nodes&#91;i - 1&#93;]
    n19[prev_id = prev_node.get&#40;&amp;&#35;39;id&amp;&#35;39;,...]
    n20{if i - 1 &amp;lt; len&#40;path.edges&#41;}
    n21[edge = path.edges&#91;i - 1&#93;]
    n22[edge_type = edge.get&#40;&amp;&#35;39;type&amp;&#35;39;, ...]
    n23[edge_label = f&amp;&#35;39;&#124;&#123;edge_type&#125;&#1...]
    n24[edge_label = &amp;&#35;39;&amp;&#35;39;]
    n25[]
    n26[edges.append&#40;f&amp;&#35;39;    &#123;prev_id&#125; --...]
    n27[]
    n28[]
    n29[]
    n30[lines.extend&#40;edges&#41;]
    n31[lines.extend&#40;&#91;&amp;&#35;39;&amp;&#35;39;, &amp;&#...]
    n32[lines.append&#40;&amp;&#35;39;```&amp;&#35;39;&#41;]
    n33[return &amp;&#35;39;\n&amp;&#35;39;.join&#40;lines&#41;]
    n1 --> n3
    n3 --> n4
    n4 --> n5
    n5 --> n6
    n6 --> n7
    n7 -->|Yes| n8
    n7 -->|No| n29
    n8 -->|Yes| n9
    n8 -->|No| n28
    n9 --> n10
    n10 --> n11
    n11 --> n12
    n12 -->|Yes| n13
    n12 -->|No| n16
    n13 --> n14
    n14 --> n15
    n15 --> n16
    n16 --> n17
    n17 -->|Yes| n18
    n17 -->|No| n27
    n18 --> n19
    n19 --> n20
    n20 -->|Yes| n21
    n20 -->|No| n24
    n21 --> n22
    n22 --> n23
    n23 --> n25
    n24 --> n25
    n25 --> n26
    n26 --> n27
    n27 --> n8
    n28 --> n7
    n29 --> n30
    n30 --> n31
    n31 --> n32
    n32 --> n33
    n33 --> n2