flowchart TB
    n1([開始])
    n2([結束])
    n3[parameter = &#40;task.target.paramet...]
    n4[location = &#40;task.target.paramet...]
    n5[tokens = self._tokenize&#40;param...]
    n6[plan = AnalysisPlan&#40;&#41;]
    n7[payloads = list&#40;self._build_pay...]
    n8[requires_redirect = bool&#40;self._REDIRECT_...]
    n9[requires_file = bool&#40;self._FILE_KEYW...]
    n10[requires_protocol = bool&#40;self._PROTOCOL_...]
    n11{if not payloads}
    n12[payloads = list&#40;self._DEFAULT_P...]
    n13[]
    n14{for payload in payloads}
    n15[plan.vectors.append&#40;SsrfTestVector&#40;payload=payloa...]
    n16[]
    n17{if requires_redirect}
    n18[plan.vectors.append&#40;SsrfTestVector&#40;payload=&amp;&...]
    n19[]
    n20{if requires_file}
    n21{for payload in self._FILE_PAYLOADS}
    n22[plan.vectors.append&#40;SsrfTestVector&#40;payload=payloa...]
    n23[]
    n24[]
    n25{if requires_protocol}
    n26{for payload in self._PROTOCOL_PA...}
    n27[plan.vectors.append&#40;SsrfTestVector&#40;payload=payloa...]
    n28[]
    n29[]
    n30[requested = &#123;p.strip&#40;&#41;.lower&#40;&#41; f...]
    n31[headers = task.target.headers ...]
    n32[protocols_hdr = headers.get&#40;&amp;&#35;39;X-SSRF-...]
    n33[selected_protocols: set&#91;str&#93; = set&#40;&#41;]
    n34{if protocols_hdr}
    n35[selected_protocols = &#123;p.strip&#40;&#41;.lower&#40;&#...]
    n36{if &#123;&amp;&#35;39;cross&amp;&#35;39;, &amp;&#35;39;ad...}
    n37[selected_protocols = &#123;&amp;&#35;39;gopher&amp;&#35;3...]
    n38[]
    n39[]
    n40{for proto in selected_protocols}
    n41{for payload in self._CROSS_PROTO...}
    n42[plan.vectors.append&#40;SsrfTestVector&#40;payload=payloa...]
    n43[]
    n44[]
    n45{if self._should_enable_oast&#40;to...}
    n46[plan.vectors.append&#40;SsrfTestVector&#40;payload=f&amp;...]
    n47[]
    n48[return plan]
    n1 --> n3
    n3 --> n4
    n4 --> n5
    n5 --> n6
    n6 --> n7
    n7 --> n8
    n8 --> n9
    n9 --> n10
    n10 --> n11
    n11 -->|Yes| n12
    n11 -->|No| n13
    n12 --> n13
    n13 --> n14
    n14 -->|Yes| n15
    n14 -->|No| n16
    n15 --> n14
    n16 --> n17
    n17 -->|Yes| n18
    n17 -->|No| n19
    n18 --> n19
    n19 --> n20
    n20 -->|Yes| n21
    n20 -->|No| n24
    n21 -->|Yes| n22
    n21 -->|No| n23
    n22 --> n21
    n23 --> n24
    n24 --> n25
    n25 -->|Yes| n26
    n25 -->|No| n29
    n26 -->|Yes| n27
    n26 -->|No| n28
    n27 --> n26
    n28 --> n29
    n29 --> n30
    n30 --> n31
    n31 --> n32
    n32 --> n33
    n33 --> n34
    n34 -->|Yes| n35
    n34 -->|No| n36
    n35 --> n39
    n36 -->|Yes| n37
    n36 -->|No| n38
    n37 --> n38
    n38 --> n39
    n39 --> n40
    n40 -->|Yes| n41
    n40 -->|No| n44
    n41 -->|Yes| n42
    n41 -->|No| n43
    n42 --> n41
    n43 --> n40
    n44 --> n45
    n45 -->|Yes| n46
    n45 -->|No| n47
    n46 --> n47
    n47 --> n48
    n48 --> n2