flowchart TB
    n1([開始])
    n2([結束])
    n3[&amp;&#35;39;生成修復步驟（按優先級排序）&amp;&#35;39;]
    n4[steps = &#91;&#93;]
    n5[vulnerabilities = &#91;node for node in pa...]
    n6[severity_order = &#123;&amp;&#35;39;CRITICAL&amp;&#35;39;...]
    n7[vulnerabilities.sort&#40;key=lambda v: severity_order....]
    n8{for &#40;i, vuln&#41; in enumerate&#40;vulnera...}
    n9[vuln_name = vuln.get&#40;&amp;&#35;39;name&amp;&#35;39;, ...]
    n10[severity = vuln.get&#40;&amp;&#35;39;severity&amp;&#35;39...]
    n11[step = f&amp;&#35;39;【優先級 &#123;i&#125;】修復 &#123;vuln_...]
    n12{if vuln_name == &amp;&#35;39;SQLI&amp;&#35;39;}
    n13[step += &amp;&#35;39;  - 使用參數化查詢 &#40;Prepared Statements...]
    n14[step += &amp;&#35;39;  - 啟用 ORM 框架的參數綁定功能\n&amp;&#35;39;]
    n15[step += &amp;&#35;39;  - 實施輸入驗證和過濾\n&amp;&#35;39;]
    n16[step += &amp;&#35;39;  - 使用最小權限資料庫帳號\n&amp;&#35;39;]
    n17[step += &amp;&#35;39;  - 部署 WAF 規則攔截 SQL 注入攻擊&amp;&#35;39;]
    n18{if vuln_name == &amp;&#35;39;XSS&amp;&#35;39;}
    n19[step += &amp;&#35;39;  - 實施 Content Security Policy &#40;...]
    n20[step += &amp;&#35;39;  - 對所有使用者輸入進行 HTML 編碼\n&amp;&#35;39;]
    n21[step += &amp;&#35;39;  - 使用安全的模板引擎\n&amp;&#35;39;]
    n22[step += &amp;&#35;39;  - 啟用 HttpOnly 和 Secure Cookie 標誌\n...]
    n23[step += &amp;&#35;39;  - 部署 WAF XSS 防護規則&amp;&#35;39;]
    n24{if vuln_name == &amp;&#35;39;SSRF&amp;&#35;39;}
    n25[step += &amp;&#35;39;  - 實施嚴格的 URL 白名單\n&amp;&#35;39;]
    n26[step += &amp;&#35;39;  - 禁止存取內部 IP 範圍 &#40;RFC1918&#41;\n...]
    n27[step += &amp;&#35;39;  - 禁止存取雲端元資料端點 &#40;169.254.169.254...]
    n28[step += &amp;&#35;39;  - 使用獨立的網路隔離環境\n&amp;&#35;39;]
    n29[step += &amp;&#35;39;  - 限制出站連線&amp;&#35;39;]
    n30{if vuln_name in &#91;&amp;&#35;39;IDOR&amp;&#35;39;, &amp...}
    n31[step += &amp;&#35;39;  - 實施嚴格的授權檢查\n&amp;&#35;39;]
    n32[step += &amp;&#35;39;  - 使用 UUID 取代順序 ID\n&amp;&#35;39;]
    n33[step += &amp;&#35;39;  - 在每個端點驗證使用者權限\n&amp;&#35;39;]
    n34[step += &amp;&#35;39;  - 實施 RBAC 或 ABAC 存取控制\n&amp;&#35;39;]
    n35[step += &amp;&#35;39;  - 記錄所有授權失敗嘗試&amp;&#35;39;]
    n36{if vuln_name == &amp;&#35;39;AUTHENTICATIO...}
    n37[step += &amp;&#35;39;  - 修復認證邏輯漏洞\n&amp;&#35;39;]
    n38[step += &amp;&#35;39;  - 實施多因素認證 &#40;MFA&#41;\n&amp;&#35...]
    n39[step += &amp;&#35;39;  - 加強 Session 管理\n&amp;&#35;39;]
    n40[step += &amp;&#35;39;  - 實施帳號鎖定機制\n&amp;&#35;39;]
    n41[step += &amp;&#35;39;  - 定期審查認證程式碼&amp;&#35;39;]
    n42{if vuln_name == &amp;&#35;39;RCE&amp;&#35;39;}
    n43[step += &amp;&#35;39;  - 【緊急】立即修補已知 RCE 漏洞\n&amp;&#35;39;]
    n44[step += &amp;&#35;39;  - 禁止執行使用者提供的程式碼\n&amp;&#35;39;]
    n45[step += &amp;&#35;39;  - 實施應用程式沙箱\n&amp;&#35;39;]
    n46[step += &amp;&#35;39;  - 移除或禁用危險函數\n&amp;&#35;39;]
    n47[step += &amp;&#35;39;  - 部署 Runtime Application Self-Prot...]
    n48[step += f&amp;quot;  - 參考 CWE-&#123;vuln.get&#40;&amp;&#3...]
    n49[step += &amp;&#35;39;  - 實施輸入驗證和輸出編碼\n&amp;&#35;39;]
    n50[step += &amp;&#35;39;  - 進行安全程式碼審查\n&amp;&#35;39;]
    n51[step += &amp;&#35;39;  - 部署相應的安全控制措施&amp;&#35;39;]
    n52[]
    n53[]
    n54[]
    n55[]
    n56[]
    n57[]
    n58[steps.append&#40;step&#41;]
    n59[]
    n60[steps.append&#40;&amp;&#35;39;【通用防護】加強整體安全態勢:\n  - 部署 Web...]
    n61[return steps]
    n1 --> n3
    n3 --> n4
    n4 --> n5
    n5 --> n6
    n6 --> n7
    n7 --> n8
    n8 -->|Yes| n9
    n8 -->|No| n59
    n9 --> n10
    n10 --> n11
    n11 --> n12
    n12 -->|Yes| n13
    n12 -->|No| n18
    n13 --> n14
    n14 --> n15
    n15 --> n16
    n16 --> n17
    n17 --> n57
    n18 -->|Yes| n19
    n18 -->|No| n24
    n19 --> n20
    n20 --> n21
    n21 --> n22
    n22 --> n23
    n23 --> n56
    n24 -->|Yes| n25
    n24 -->|No| n30
    n25 --> n26
    n26 --> n27
    n27 --> n28
    n28 --> n29
    n29 --> n55
    n30 -->|Yes| n31
    n30 -->|No| n36
    n31 --> n32
    n32 --> n33
    n33 --> n34
    n34 --> n35
    n35 --> n54
    n36 -->|Yes| n37
    n36 -->|No| n42
    n37 --> n38
    n38 --> n39
    n39 --> n40
    n40 --> n41
    n41 --> n53
    n42 -->|Yes| n43
    n42 -->|No| n48
    n43 --> n44
    n44 --> n45
    n45 --> n46
    n46 --> n47
    n47 --> n52
    n48 --> n49
    n49 --> n50
    n50 --> n51
    n51 --> n52
    n52 --> n53
    n53 --> n54
    n54 --> n55
    n55 --> n56
    n56 --> n57
    n57 --> n58
    n58 --> n8
    n59 --> n60
    n60 --> n61
    n61 --> n2