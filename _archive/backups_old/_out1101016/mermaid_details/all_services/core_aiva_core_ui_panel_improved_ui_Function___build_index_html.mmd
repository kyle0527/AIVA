flowchart TB
    n1([開始])
    n2([結束])
    n3[&amp;&#35;39;Construct the HTML for the index page.\n\n  ...]
    n4[stats: dict&#91;str, Any&#93; = dashboard.get_stats&#40;&...]
    n5[tasks = dashboard.get_tasks&#40;...]
    n6[detections = dashboard.get_detect...]
    n7[ai_history = dashboard.get_ai_his...]
    n8[task_rows = &amp;&#35;39;&amp;&#35;39;]
    n9{for task in tasks}
    n10[task_id = task.get&#40;&amp;&#35;39;task_id&amp;&#35;39;,...]
    n11[target = task.get&#40;&amp;&#35;39;target&amp;&#35;39;, &...]
    n12[scan_type = task.get&#40;&amp;&#35;39;scan_type&amp;&#35;...]
    n13[status = task.get&#40;&amp;&#35;39;status&amp;&#35;39;, &...]
    n14[created_by = task.get&#40;&amp;&#35;39;created_by...]
    n15[ai_result = task.get&#40;&amp;&#35;39;ai_result&amp;&#35;...]
    n16[ai_result_text = &amp;&#35;39;AI&amp;&#35;39; if ai_resul...]
    n17[task_rows += f&amp;&#35;39;&amp;lt;tr&amp;gt;&amp;lt;td&a...]
    n18[]
    n19{if not task_rows}
    n20[task_rows = &amp;quot;&amp;lt;tr&amp;gt;&amp;lt;td colspa...]
    n21[]
    n22[detection_rows = &amp;&#35;39;&amp;&#35;39;]
    n23{for det in detections}
    n24[vuln_type = det.get&#40;&amp;&#35;39;vuln_type&amp;&#35;3...]
    n25[target = det.get&#40;&amp;&#35;39;target&amp;&#35;39;, &a...]
    n26[status = det.get&#40;&amp;&#35;39;status&amp;&#35;39;, &a...]
    n27[method = det.get&#40;&amp;&#35;39;method&amp;&#35;39;, &a...]
    n28[result = det.get&#40;&amp;&#35;39;result&amp;&#35;39;, de...]
    n29{if isinstance&#40;result, list &#124; d...}
    n30[result_preview = &amp;&#35;39;&#91;複雜結果&#93;&amp;&#35;39;]
    n31[result_str = str&#40;result&#41;]
    n32[result_preview = result_str&#91;:50&#93; + &#40;&amp;&#35...]
    n33[]
    n34[detection_rows += f&amp;&#35;39;&amp;lt;tr&amp;gt;&amp;lt...]
    n35[]
    n36{if not detection_rows}
    n37[detection_rows = &amp;quot;&amp;lt;tr&amp;gt;&amp;lt;td c...]
    n38[]
    n39[history_rows = &amp;&#35;39;&amp;&#35;39;]
    n40{for record in ai_history}
    n41[status = record.get&#40;&amp;&#35;39;status&amp;&#35;39;,...]
    n42[tool_used = record.get&#40;&amp;&#35;39;tool_use...]
    n43[confidence = record.get&#40;&amp;&#35;39;confiden...]
    n44[result = record.get&#40;&amp;&#35;39;result&amp;&#35;39;,...]
    n45{if isinstance&#40;confidence, float&#41;}
    n46[conf_display = f&amp;&#35;39;&#123;confidence:.2%&#125;&a...]
    n47[conf_display = str&#40;confidence&#41;]
    n48[]
    n49[result_str = str&#40;result&#41;]
    n50[result_preview = result_str&#91;:50&#93; + &#40;&amp;&#35...]
    n51[history_rows += f&amp;&#35;39;&amp;lt;tr&amp;gt;&amp;lt;t...]
    n52[]
    n53{if not history_rows}
    n54[history_rows = &amp;quot;&amp;lt;tr&amp;gt;&amp;lt;td col...]
    n55[]
    n56[ai_card_html: str = &amp;&#35;39;&amp;&#35;39;]
    n57{if stats.get&#40;&amp;&#35;39;ai_enabled&amp;&#35;39;&#41;}
    n58[ai_card_html = &amp;&#35;39;\n                &amp;lt;...]
    n59[]
    n60[html = f&amp;quot;&amp;quot;&amp;quot;\n    &amp;lt;!DOCT...]
    n61[return html]
    n1 --> n3
    n3 --> n4
    n4 --> n5
    n5 --> n6
    n6 --> n7
    n7 --> n8
    n8 --> n9
    n9 -->|Yes| n10
    n9 -->|No| n18
    n10 --> n11
    n11 --> n12
    n12 --> n13
    n13 --> n14
    n14 --> n15
    n15 --> n16
    n16 --> n17
    n17 --> n9
    n18 --> n19
    n19 -->|Yes| n20
    n19 -->|No| n21
    n20 --> n21
    n21 --> n22
    n22 --> n23
    n23 -->|Yes| n24
    n23 -->|No| n35
    n24 --> n25
    n25 --> n26
    n26 --> n27
    n27 --> n28
    n28 --> n29
    n29 -->|Yes| n30
    n29 -->|No| n31
    n30 --> n33
    n31 --> n32
    n32 --> n33
    n33 --> n34
    n34 --> n23
    n35 --> n36
    n36 -->|Yes| n37
    n36 -->|No| n38
    n37 --> n38
    n38 --> n39
    n39 --> n40
    n40 -->|Yes| n41
    n40 -->|No| n52
    n41 --> n42
    n42 --> n43
    n43 --> n44
    n44 --> n45
    n45 -->|Yes| n46
    n45 -->|No| n47
    n46 --> n48
    n47 --> n48
    n48 --> n49
    n49 --> n50
    n50 --> n51
    n51 --> n40
    n52 --> n53
    n53 -->|Yes| n54
    n53 -->|No| n55
    n54 --> n55
    n55 --> n56
    n56 --> n57
    n57 -->|Yes| n58
    n57 -->|No| n59
    n58 --> n59
    n59 --> n60
    n60 --> n61
    n61 --> n2