flowchart TB
    n1([開始])
    n2([結束])
    n3[&amp;&#35;39;從樣本中提取特徵向量\n\n        Args:\n            sam...]
    n4[features: list&#91;float&#93; = &#91;&#93;]
    n5[attack_types = &#91;&amp;&#35;39;SQLI&amp;&#35;39;, &amp;...]
    n6[attack_type = sample.context.get&#40;&amp;&#35;39;...]
    n7[attack_one_hot = &#91;1.0 if t == attack_...]
    n8[features.extend&#40;attack_one_hot&#41;]
    n9[features.append&#40;float&#40;len&#40;sample.plan.steps&#...]
    n10[features.append&#40;float&#40;len&#40;sample.plan.depende...]
    n11[metrics = sample.metrics]
    n12[features.extend&#40;&#91;metrics.completion_rate, metrics...]
    n13[target_info = sample.context.get&#40;&amp;&#35;39;...]
    n14[features.append&#40;1.0 if target_info.get&#40;&amp;&#35;...]
    n15[features.append&#40;len&#40;target_info.get&#40;&amp;&#35...]
    n16[return np.array&#40;features, dtype=np.fl...]
    n1 --> n3
    n3 --> n4
    n4 --> n5
    n5 --> n6
    n6 --> n7
    n7 --> n8
    n8 --> n9
    n9 --> n10
    n10 --> n11
    n11 --> n12
    n12 --> n13
    n13 --> n14
    n14 --> n15
    n15 --> n16
    n16 --> n2