flowchart TB
    n1([開始])
    n2([結束])
    n3[&amp;&#35;39;準備監督學習數據\n\n        Args:\n            sampl...]
    n4[X = &#91;&#93;]
    n5[y = &#91;&#93;]
    n6{for sample in samples}
    n7[features = self._extract_featur...]
    n8[X.append&#40;features&#41;]
    n9[label = 1 if sample.label ==...]
    n10[y.append&#40;label&#41;]
    n11[]
    n12[X = np.array&#40;X&#41;]
    n13[y = np.array&#40;y&#41;]
    n14[split_idx = int&#40;len&#40;X&#41; * &#40;1 - va...]
    n15[indices = np.random.permutatio...]
    n16[X = X&#91;indices&#93;]
    n17[y = y&#91;indices&#93;]
    n18[&#40;X_train, X_val&#41; = &#40;X&#91;:split_idx&#93;, X&...]
    n19[&#40;y_train, y_val&#41; = &#40;y&#91;:split_idx&#93;, y&...]
    n20[return &#40;X_train, y_train, X_val, y_va...]
    n1 --> n3
    n3 --> n4
    n4 --> n5
    n5 --> n6
    n6 -->|Yes| n7
    n6 -->|No| n11
    n7 --> n8
    n8 --> n9
    n9 --> n10
    n10 --> n6
    n11 --> n12
    n12 --> n13
    n13 --> n14
    n14 --> n15
    n15 --> n16
    n16 --> n17
    n17 --> n18
    n18 --> n19
    n19 --> n20
    n20 --> n2