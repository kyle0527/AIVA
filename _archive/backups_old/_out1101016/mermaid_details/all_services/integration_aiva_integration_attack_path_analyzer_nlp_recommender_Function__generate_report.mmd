flowchart TB
    n1([開始])
    n2([結束])
    n3[&amp;&#35;39;\n        生成完整的推薦報告\n\n        Args:\n      ...]
    n4[report = &amp;&#35;39;&#35; 攻擊路徑分析與修復建議報告\n\n...]
    n5[report += f&amp;&#35;39;**生成時間**: &#123;self._get_current...]
    n6[report += &amp;&#35;39;---\n\n&amp;&#35;39;]
    n7[report += &amp;&#35;39;&#35;&#35; 📊 執行摘要\n\n&amp;&#35;39;]
    n8[report += f&amp;&#35;39;本次分析發現 **&#123;len&#40;recommenda...]
    n9[risk_counts = dict.fromkeys&#40;RiskLe...]
    n10{for rec in recommendations}
    n11[risk_counts&#91;rec.risk_level&#93; += 1]
    n12[]
    n13[report += &amp;&#35;39;&#35;&#35;&#35; 風險等級分布\n\n&amp;&#3...]
    n14[report += f&amp;&#35;39;- 🔴 **CRITICAL**: &#123;risk_coun...]
    n15[report += f&amp;&#35;39;- 🟠 **HIGH**: &#123;risk_counts&#...]
    n16[report += f&amp;&#35;39;- 🟡 **MEDIUM**: &#123;risk_counts...]
    n17[report += f&amp;&#35;39;- 🟢 **LOW**: &#123;risk_counts&#9...]
    n18{if risk_counts&#91;RiskLevel.CRITI...}
    n19[report += &amp;&#35;39;&#35;&#35;&#35; ⚠️ 緊急建議\n\n&amp;&#...]
    n20[report += f&amp;&#35;39;發現 &#123;risk_counts&#91;RiskLeve...]
    n21[report += &amp;&#35;39;建議立即召開緊急會議，在 24 小時內開始修復工作。\n\n&amp...]
    n22[]
    n23[report += &amp;&#35;39;---\n\n&amp;&#35;39;]
    n24[report += &amp;&#35;39;&#35;&#35; 🎯 詳細推薦\n\n&amp;&#35;39;]
    n25{for &#40;i, rec&#41; in enumerate&#40;recomme...}
    n26[report += f&amp;&#35;39;&#35;&#35;&#35; 路徑 &#123;i&#125;:...]
    n27[report += rec.executive_summary + &amp;&#35;39;\n\n&amp;&...]
    n28[report += rec.technical_explanation + &amp;&#35;39;\n\n&a...]
    n29[report += rec.business_impact + &amp;&#35;39;\n\n&amp;&#3...]
    n30{if rec.quick_wins}
    n31[report += &amp;&#35;39;&#35;&#35;&#35; ⚡ 快速修復建議\n\n&amp;&...]
    n32{for quick_win in rec.quick_wins}
    n33[report += f&amp;&#35;39;- &#123;quick_win&#125;\n&amp;&#3...]
    n34[]
    n35[report += &amp;&#35;39;\n&amp;&#35;39;]
    n36[]
    n37[report += &amp;&#35;39;&#35;&#35;&#35; 🔧 詳細修復步驟\n\n&amp;&...]
    n38{for &#40;j, step&#41; in enumerate&#40;rec.rem...}
    n39[report += f&amp;&#35;39;&#123;j&#125;. &#123;step&#125;\n...]
    n40[]
    n41{if rec.affected_assets}
    n42[report += &amp;&#35;39;&#35;&#35;&#35; 📦 受影響資產\n\n&amp;&#...]
    n43{for asset in rec.affected_assets}
    n44[report += f&amp;&#35;39;- `&#123;asset&#125;`\n&amp;&#35;39;]
    n45[]
    n46[report += &amp;&#35;39;\n&amp;&#35;39;]
    n47[]
    n48[report += &amp;&#35;39;&#35;&#35;&#35; 📈 修復評估\n\n&amp;&#3...]
    n49[report += f&amp;&#35;39;- **預估工作量**: &#123;rec.estimated_...]
    n50[report += f&amp;&#35;39;- **預估風險降低**: &#123;rec.estimated...]
    n51[report += f&amp;&#35;39;- **優先級分數**: &#123;rec.priority_s...]
    n52[report += &amp;&#35;39;---\n\n&amp;&#35;39;]
    n53[]
    n54[report += &amp;&#35;39;&#35;&#35; 📝 總結與後續行動\n\n&amp;&#35;39;]
    n55[report += &amp;&#35;39;&#35;&#35;&#35; 建議的行動優先順序\n\n&amp;...]
    n56[critical_recs = &#91;r for r in recommen...]
    n57[high_recs = &#91;r for r in recommen...]
    n58{if critical_recs}
    n59[report += &amp;&#35;39;**立即行動 &#40;24小時內&#41;**:\n&amp;&#...]
    n60{for rec in critical_recs&#91;:3&#93;}
    n61[report += f&amp;&#35;39;- 修復路徑: &#123;rec.path_id&#125;\n...]
    n62[]
    n63[report += &amp;&#35;39;\n&amp;&#35;39;]
    n64[]
    n65{if high_recs}
    n66[report += &amp;&#35;39;**短期行動 &#40;1週內&#41;**:\n&amp;&#35...]
    n67{for rec in high_recs&#91;:3&#93;}
    n68[report += f&amp;&#35;39;- 修復路徑: &#123;rec.path_id&#125;\n...]
    n69[]
    n70[report += &amp;&#35;39;\n&amp;&#35;39;]
    n71[]
    n72[report += &amp;&#35;39;**中長期行動**:\n&amp;&#35;39;]
    n73[report += &amp;&#35;39;- 建立持續的漏洞掃描和攻擊路徑分析機制\n&amp;&#35;39;]
    n74[report += &amp;&#35;39;- 加強安全開發培訓\n&amp;&#35;39;]
    n75[report += &amp;&#35;39;- 實施安全左移 &#40;Shift-Left Security&...]
    n76[report += &amp;&#35;39;- 定期進行紅隊演練\n\n&amp;&#35;39;]
    n77[return report]
    n1 --> n3
    n3 --> n4
    n4 --> n5
    n5 --> n6
    n6 --> n7
    n7 --> n8
    n8 --> n9
    n9 --> n10
    n10 -->|Yes| n11
    n10 -->|No| n12
    n11 --> n10
    n12 --> n13
    n13 --> n14
    n14 --> n15
    n15 --> n16
    n16 --> n17
    n17 --> n18
    n18 -->|Yes| n19
    n18 -->|No| n22
    n19 --> n20
    n20 --> n21
    n21 --> n22
    n22 --> n23
    n23 --> n24
    n24 --> n25
    n25 -->|Yes| n26
    n25 -->|No| n53
    n26 --> n27
    n27 --> n28
    n28 --> n29
    n29 --> n30
    n30 -->|Yes| n31
    n30 -->|No| n36
    n31 --> n32
    n32 -->|Yes| n33
    n32 -->|No| n34
    n33 --> n32
    n34 --> n35
    n35 --> n36
    n36 --> n37
    n37 --> n38
    n38 -->|Yes| n39
    n38 -->|No| n40
    n39 --> n38
    n40 --> n41
    n41 -->|Yes| n42
    n41 -->|No| n47
    n42 --> n43
    n43 -->|Yes| n44
    n43 -->|No| n45
    n44 --> n43
    n45 --> n46
    n46 --> n47
    n47 --> n48
    n48 --> n49
    n49 --> n50
    n50 --> n51
    n51 --> n52
    n52 --> n25
    n53 --> n54
    n54 --> n55
    n55 --> n56
    n56 --> n57
    n57 --> n58
    n58 -->|Yes| n59
    n58 -->|No| n64
    n59 --> n60
    n60 -->|Yes| n61
    n60 -->|No| n62
    n61 --> n60
    n62 --> n63
    n63 --> n64
    n64 --> n65
    n65 -->|Yes| n66
    n65 -->|No| n71
    n66 --> n67
    n67 -->|Yes| n68
    n67 -->|No| n69
    n68 --> n67
    n69 --> n70
    n70 --> n71
    n71 --> n72
    n72 --> n73
    n73 --> n74
    n74 --> n75
    n75 --> n76
    n76 --> n77
    n77 --> n2