flowchart TB
    n1([開始])
    n2([結束])
    n3[&amp;&#35;39;訓練一個 epoch\n\n        Args:\n            X: ...]
    n4[n_samples = len&#40;X&#41;]
    n5[batch_size = self.config.batch_si...]
    n6[total_loss = 0.0]
    n7[correct = 0]
    n8{for i in range&#40;0, n_sample...}
    n9[batch_X = X&#91;i:i + batch_size&#93;]
    n10[batch_y = y&#91;i:i + batch_size&#93;]
    n11[predictions = self._forward_batch&#40;...]
    n12[loss = np.mean&#40;&#40;predictions...]
    n13[total_loss += loss]
    n14[correct += np.sum&#40;np.abs&#40;predictions - batch_y&#4...]
    n15[self._backward_batch&#40;batch_X, batch_y, predictions...]
    n16[]
    n17[avg_loss = total_loss / &#40;n_samp...]
    n18[accuracy = correct / n_samples]
    n19[return &#40;avg_loss, accuracy&#41;]
    n1 --> n3
    n3 --> n4
    n4 --> n5
    n5 --> n6
    n6 --> n7
    n7 --> n8
    n8 -->|Yes| n9
    n8 -->|No| n16
    n9 --> n10
    n10 --> n11
    n11 --> n12
    n12 --> n13
    n13 --> n14
    n14 --> n15
    n15 --> n8
    n16 --> n17
    n17 --> n18
    n18 --> n19
    n19 --> n2