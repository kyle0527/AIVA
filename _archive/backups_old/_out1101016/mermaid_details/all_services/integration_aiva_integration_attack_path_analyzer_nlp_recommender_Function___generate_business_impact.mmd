flowchart TB
    n1([開始])
    n2([結束])
    n3[&amp;&#35;39;生成業務影響說明&amp;&#35;39;]
    n4[impact = &amp;&#35;39;&#35;&#35; 業務影響評估\n\n&amp;&#35;39;]
    n5{if risk_level == RiskLevel.CRI...}
    n6[impact += &amp;&#35;39;&#35;&#35;&#35; 🚨 嚴重業務影響\n\n&amp;&...]
    n7[impact += &amp;&#35;39;此攻擊路徑若被利用，可能導致:\n\n&amp;&#35;39;]
    n8[impact += &amp;&#35;39;- **資料洩露風險**: 極高，敏感資料可能完全洩露\n&amp;...]
    n9[impact += &amp;&#35;39;- **服務中斷風險**: 高，可能導致服務完全停擺\n&amp;&...]
    n10[impact += &amp;&#35;39;- **財務損失**: 可能超過數百萬元，包含罰款、補償、商譽損失\...]
    n11[impact += &amp;&#35;39;- **法規合規**: 可能違反 GDPR、PCI-DSS 等法規，...]
    n12[impact += &amp;&#35;39;- **商譽損害**: 嚴重，可能導致客戶流失和媒體負面報導\n\n...]
    n13[impact += &amp;&#35;39;**建議行動**: 立即召集緊急會議，24小時內完成修復\n&amp...]
    n14{if risk_level == RiskLevel.HIGH}
    n15[impact += &amp;&#35;39;&#35;&#35;&#35; ⚠️ 高度業務影響\n\n&amp;...]
    n16[impact += &amp;&#35;39;此攻擊路徑具有顯著風險:\n\n&amp;&#35;39;]
    n17[impact += &amp;&#35;39;- **資料洩露風險**: 高，部分敏感資料可能洩露\n&amp;&...]
    n18[impact += &amp;&#35;39;- **服務中斷風險**: 中等，可能影響部分服務\n&amp;&#...]
    n19[impact += &amp;&#35;39;- **財務損失**: 可能達到數十萬元\n&amp;&#35;39;]
    n20[impact += &amp;&#35;39;- **法規合規**: 需要注意合規風險\n&amp;&#35;39;]
    n21[impact += &amp;&#35;39;- **商譽損害**: 中等，需要謹慎處理\n\n&amp;&#35...]
    n22[impact += &amp;&#35;39;**建議行動**: 優先處理，一週內完成修復\n&amp;&#35;39;]
    n23{if risk_level == RiskLevel.MEDIUM}
    n24[impact += &amp;&#35;39;&#35;&#35;&#35; ⚡ 中度業務影響\n\n&amp;&...]
    n25[impact += &amp;&#35;39;此攻擊路徑需要關注:\n\n&amp;&#35;39;]
    n26[impact += &amp;&#35;39;- **資料洩露風險**: 中等\n&amp;&#35;39;]
    n27[impact += &amp;&#35;39;- **服務中斷風險**: 低\n&amp;&#35;39;]
    n28[impact += &amp;&#35;39;- **財務損失**: 可能數萬元\n&amp;&#35;39;]
    n29[impact += &amp;&#35;39;- **商譽損害**: 有限\n\n&amp;&#35;39;]
    n30[impact += &amp;&#35;39;**建議行動**: 納入修復計劃，一個月內完成\n&amp;&#35...]
    n31[impact += &amp;&#35;39;&#35;&#35;&#35; ℹ️ 低度業務影響\n\n&amp;...]
    n32[impact += &amp;&#35;39;此攻擊路徑風險較低，但仍需注意。\n\n&amp;&#35;39;]
    n33[impact += &amp;&#35;39;**建議行動**: 常規維護週期內處理\n&amp;&#35;39;]
    n34[]
    n35[]
    n36[]
    n37[target_node = path.nodes&#91;-1&#93; if pa...]
    n38[target_labels = target_node.get&#40;&amp;&#35;39;lab...]
    n39[impact += &amp;&#35;39;\n&#35;&#35;&#35; 受影響的利益相關者\n\n&am...]
    n40{if &amp;&#35;39;Database&amp;&#35;39; in target_labels}
    n41[impact += &amp;&#35;39;- **資料所有者**: 客戶、使用者\n&amp;&#35;39;]
    n42[impact += &amp;&#35;39;- **負責團隊**: 資安團隊、DBA 團隊、應用開發團隊\n&a...]
    n43[impact += &amp;&#35;39;- **需通知對象**: CISO、法務、客服、公關\n&amp;&...]
    n44{if &amp;&#35;39;InternalNetwork&amp;&#35;39; in target...}
    n45[impact += &amp;&#35;39;- **負責團隊**: 網路安全團隊、基礎架構團隊\n&amp;&#...]
    n46[impact += &amp;&#35;39;- **需通知對象**: CISO、IT 主管\n&amp;&#35...]
    n47[impact += &amp;&#35;39;- **負責團隊**: 資安團隊、應用開發團隊\n&amp;&#35...]
    n48[impact += &amp;&#35;39;- **需通知對象**: CISO、產品負責人\n&amp;&#35...]
    n49[]
    n50[]
    n51[return impact]
    n1 --> n3
    n3 --> n4
    n4 --> n5
    n5 -->|Yes| n6
    n5 -->|No| n14
    n6 --> n7
    n7 --> n8
    n8 --> n9
    n9 --> n10
    n10 --> n11
    n11 --> n12
    n12 --> n13
    n13 --> n36
    n14 -->|Yes| n15
    n14 -->|No| n23
    n15 --> n16
    n16 --> n17
    n17 --> n18
    n18 --> n19
    n19 --> n20
    n20 --> n21
    n21 --> n22
    n22 --> n35
    n23 -->|Yes| n24
    n23 -->|No| n31
    n24 --> n25
    n25 --> n26
    n26 --> n27
    n27 --> n28
    n28 --> n29
    n29 --> n30
    n30 --> n34
    n31 --> n32
    n32 --> n33
    n33 --> n34
    n34 --> n35
    n35 --> n36
    n36 --> n37
    n37 --> n38
    n38 --> n39
    n39 --> n40
    n40 -->|Yes| n41
    n40 -->|No| n44
    n41 --> n42
    n42 --> n43
    n43 --> n50
    n44 -->|Yes| n45
    n44 -->|No| n47
    n45 --> n46
    n46 --> n49
    n47 --> n48
    n48 --> n49
    n49 --> n50
    n50 --> n51
    n51 --> n2