flowchart TB
    n1([開始])
    n2([結束])
    n3[&amp;&#35;39;Return a DOM detection result when the paylo...]
    n4{if not payload or not document}
    n5[return None]
    n6[]
    n7[index = document.find&#40;payloa...]
    n8{if index == -1}
    n9[return None]
    n10[]
    n11[window_start = max&#40;0, index - 160&#41;]
    n12[window_end = min&#40;len&#40;document&#41;, i...]
    n13[window = document&#91;window_star...]
    n14[lower_window = window.lower&#40;&#41;]
    n15{if &amp;&#35;39;&amp;lt;script&amp;&#35;39; in lower_wind...}
    n16[snippet = window.strip&#40;&#41;]
    n17[return DomDetectionResult&#40;payload=pay...]
    n18[]
    n19[return None]
    n1 --> n3
    n3 --> n4
    n4 -->|Yes| n5
    n4 -->|No| n6
    n5 --> n6
    n6 --> n7
    n7 --> n8
    n8 -->|Yes| n9
    n8 -->|No| n10
    n9 --> n10
    n10 --> n11
    n11 --> n12
    n12 --> n13
    n13 --> n14
    n14 --> n15
    n15 -->|Yes| n16
    n15 -->|No| n18
    n16 --> n17
    n17 --> n18
    n18 --> n19
    n19 --> n2