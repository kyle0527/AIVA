flowchart TB
    n1([開始])
    n2([結束])
    n3[&amp;&#35;39;生成技術解釋（給技術團隊看的）&amp;&#35;39;]
    n4[explanation = &amp;&#35;39;&#35;&#35; 攻擊路徑技術分析\n\n&amp;&#...]
    n5[explanation += &amp;&#35;39;&#35;&#35;&#35; 攻擊步驟\n\n&amp;...]
    n6{for &#40;i, node&#41; in enumerate&#40;path.no...}
    n7[node_labels = node.get&#40;&amp;&#35;39;labels&amp;&#35;3...]
    n8[node_type = node_labels&#91;0&#93; if no...]
    n9{if i == 0}
    n10[explanation += f&amp;&#35;39;**步驟 &#123;i + 1&#125;: 起點 -...]
    n11[explanation += &amp;&#35;39;  - 攻擊者從外部網路發起攻擊\n\n&amp;&#35...]
    n12{if &amp;&#35;39;Vulnerability&amp;&#35;39; in node_labels}
    n13[vuln_name = node.get&#40;&amp;&#35;39;name&amp;&#35;39;, ...]
    n14[severity = node.get&#40;&amp;&#35;39;severity&amp;&#35;39...]
    n15[cwe = node.get&#40;&amp;&#35;39;cwe&amp;&#35;39;, &amp;&#...]
    n16[explanation += f&amp;&#35;39;**步驟 &#123;i + 1&#125;: 利用漏洞...]
    n17[explanation += f&amp;&#35;39;  - **嚴重程度**: &#123;severity...]
    n18[explanation += f&amp;&#35;39;  - **CWE 編號**: &#123;cwe&#1...]
    n19{if vuln_name in self._vuln_des...}
    n20[vuln_info = self._vuln_descripti...]
    n21[explanation += f&amp;quot;  - **影響**: &#123;vuln_info&#91...]
    n22[explanation += f&amp;quot;  - **常見利用方式**: &#123;vuln_info...]
    n23[]
    n24{if i &amp;lt; len&#40;path.edges&#41;}
    n25[edge = path.edges&#91;i&#93;]
    n26[edge_type = edge.get&#40;&amp;&#35;39;type&amp;&#35;39;, ...]
    n27[edge_risk = edge.get&#40;&amp;&#35;39;risk&amp;&#35;39;, ...]
    n28[explanation += f&amp;&#35;39;  - **攻擊效果**: &#123;self._tr...]
    n29[explanation += f&amp;&#35;39;  - **路徑風險**: &#123;edge_ris...]
    n30[]
    n31[explanation += &amp;&#35;39;\n&amp;&#35;39;]
    n32{if i == len&#40;path.nodes&#41; - 1}
    n33[explanation += f&amp;&#35;39;**步驟 &#123;i + 1&#125;: 攻擊目標...]
    n34[explanation += f&amp;&#35;39;  - 攻擊者成功到達 &#123;self._get_...]
    n35[explanation += &amp;&#35;39;  - 可能的後果:\n&amp;&#35;39;]
    n36{if &amp;&#35;39;Database&amp;&#35;39; in node_labels}
    n37[explanation += &amp;&#35;39;    - 竊取、篡改或刪除敏感資料\n&amp;&#35...]
    n38[explanation += &amp;&#35;39;    - 獲取使用者憑證和個人資訊\n&amp;&#35...]
    n39[explanation += &amp;&#35;39;    - 破壞資料完整性\n&amp;&#35;39;]
    n40{if &amp;&#35;39;Credential&amp;&#35;39; in node_labels}
    n41[explanation += &amp;&#35;39;    - 劫持使用者帳號\n&amp;&#35;39;]
    n42[explanation += &amp;&#35;39;    - 橫向移動到其他系統\n&amp;&#35;39;]
    n43[explanation += &amp;&#35;39;    - 持久化存取\n&amp;&#35;39;]
    n44{if &amp;&#35;39;InternalNetwork&amp;&#35;39; in node_l...}
    n45[explanation += &amp;&#35;39;    - 探測內部網路拓撲\n&amp;&#35;39;]
    n46[explanation += &amp;&#35;39;    - 存取內部服務和 API\n&amp;&#35;39;]
    n47[explanation += &amp;&#35;39;    - 建立跳板進行進一步攻擊\n&amp;&#35;39;]
    n48{if &amp;&#35;39;APIEndpoint&amp;&#35;39; in node_labels}
    n49[explanation += &amp;&#35;39;    - 未授權存取敏感 API\n&amp;&#35;39;]
    n50[explanation += &amp;&#35;39;    - 資料洩露或篡改\n&amp;&#35;39;]
    n51[explanation += &amp;&#35;39;    - 業務邏輯繞過\n&amp;&#35;39;]
    n52[]
    n53[]
    n54[]
    n55[]
    n56[explanation += &amp;&#35;39;\n&amp;&#35;39;]
    n57[]
    n58[]
    n59[]
    n60[]
    n61[return explanation]
    n1 --> n3
    n3 --> n4
    n4 --> n5
    n5 --> n6
    n6 -->|Yes| n7
    n6 -->|No| n60
    n7 --> n8
    n8 --> n9
    n9 -->|Yes| n10
    n9 -->|No| n12
    n10 --> n11
    n11 --> n59
    n12 -->|Yes| n13
    n12 -->|No| n32
    n13 --> n14
    n14 --> n15
    n15 --> n16
    n16 --> n17
    n17 --> n18
    n18 --> n19
    n19 -->|Yes| n20
    n19 -->|No| n23
    n20 --> n21
    n21 --> n22
    n22 --> n23
    n23 --> n24
    n24 -->|Yes| n25
    n24 -->|No| n30
    n25 --> n26
    n26 --> n27
    n27 --> n28
    n28 --> n29
    n29 --> n30
    n30 --> n31
    n31 --> n58
    n32 -->|Yes| n33
    n32 -->|No| n57
    n33 --> n34
    n34 --> n35
    n35 --> n36
    n36 -->|Yes| n37
    n36 -->|No| n40
    n37 --> n38
    n38 --> n39
    n39 --> n55
    n40 -->|Yes| n41
    n40 -->|No| n44
    n41 --> n42
    n42 --> n43
    n43 --> n54
    n44 -->|Yes| n45
    n44 -->|No| n48
    n45 --> n46
    n46 --> n47
    n47 --> n53
    n48 -->|Yes| n49
    n48 -->|No| n52
    n49 --> n50
    n50 --> n51
    n51 --> n52
    n52 --> n53
    n53 --> n54
    n54 --> n55
    n55 --> n56
    n56 --> n57
    n57 --> n58
    n58 --> n59
    n59 --> n6
    n60 --> n61
    n61 --> n2