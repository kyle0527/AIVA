{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "aiva-schemas",
  "title": "AIVA Schema Bundle",
  "description": "AIVA 平台統一資料結構定義",
  "version": "1.0.0",
  "generated_at": "2025-10-18T16:13:20.511425",
  "generator": "Pydantic Official API",
  "$defs": {
    "ModuleName": {
      "enum": [
        "ApiGateway",
        "CoreModule",
        "ScanModule",
        "IntegrationModule",
        "FunctionModule",
        "FunctionXSS",
        "FunctionSQLI",
        "FunctionSSRF",
        "FunctionIDOR",
        "OASTService",
        "ThreatIntelModule",
        "AuthZModule",
        "PostExModule",
        "RemediationModule",
        "BizLogicModule"
      ],
      "title": "ModuleName",
      "type": "string"
    },
    "MessageHeader": {
      "description": "訊息標頭 - 用於所有訊息的統一標頭格式",
      "properties": {
        "message_id": {
          "title": "Message Id",
          "type": "string"
        },
        "trace_id": {
          "title": "Trace Id",
          "type": "string"
        },
        "correlation_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Correlation Id"
        },
        "source_module": {
          "$ref": "#/$defs/ModuleName"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        },
        "version": {
          "default": "1.0",
          "title": "Version",
          "type": "string"
        }
      },
      "required": [
        "message_id",
        "trace_id",
        "source_module"
      ],
      "title": "MessageHeader",
      "type": "object"
    },
    "Authentication": {
      "description": "認證資訊",
      "properties": {
        "method": {
          "default": "none",
          "title": "Method",
          "type": "string"
        },
        "credentials": {
          "anyOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Credentials"
        }
      },
      "title": "Authentication",
      "type": "object"
    },
    "RateLimit": {
      "description": "速率限制",
      "properties": {
        "requests_per_second": {
          "default": 25,
          "title": "Requests Per Second",
          "type": "integer"
        },
        "burst": {
          "default": 50,
          "title": "Burst",
          "type": "integer"
        }
      },
      "title": "RateLimit",
      "type": "object"
    },
    "ScanScope": {
      "description": "掃描範圍",
      "properties": {
        "exclusions": {
          "items": {
            "type": "string"
          },
          "title": "Exclusions",
          "type": "array"
        },
        "include_subdomains": {
          "default": true,
          "title": "Include Subdomains",
          "type": "boolean"
        },
        "allowed_hosts": {
          "items": {
            "type": "string"
          },
          "title": "Allowed Hosts",
          "type": "array"
        }
      },
      "title": "ScanScope",
      "type": "object"
    },
    "Asset": {
      "description": "資產基本資訊",
      "properties": {
        "asset_id": {
          "title": "Asset Id",
          "type": "string"
        },
        "type": {
          "title": "Type",
          "type": "string"
        },
        "value": {
          "title": "Value",
          "type": "string"
        },
        "parameters": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Parameters"
        },
        "has_form": {
          "default": false,
          "title": "Has Form",
          "type": "boolean"
        }
      },
      "required": [
        "asset_id",
        "type",
        "value"
      ],
      "title": "Asset",
      "type": "object"
    },
    "Summary": {
      "description": "掃描摘要",
      "properties": {
        "urls_found": {
          "default": 0,
          "title": "Urls Found",
          "type": "integer"
        },
        "forms_found": {
          "default": 0,
          "title": "Forms Found",
          "type": "integer"
        },
        "apis_found": {
          "default": 0,
          "title": "Apis Found",
          "type": "integer"
        },
        "scan_duration_seconds": {
          "default": 0,
          "title": "Scan Duration Seconds",
          "type": "integer"
        }
      },
      "title": "Summary",
      "type": "object"
    },
    "Fingerprints": {
      "description": "技術指紋",
      "properties": {
        "web_server": {
          "anyOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Web Server"
        },
        "framework": {
          "anyOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Framework"
        },
        "language": {
          "anyOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Language"
        },
        "waf_detected": {
          "default": false,
          "title": "Waf Detected",
          "type": "boolean"
        },
        "waf_vendor": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Waf Vendor"
        }
      },
      "title": "Fingerprints",
      "type": "object"
    },
    "ExecutionError": {
      "description": "執行錯誤統一格式",
      "properties": {
        "error_id": {
          "title": "Error Id",
          "type": "string"
        },
        "error_type": {
          "title": "Error Type",
          "type": "string"
        },
        "message": {
          "title": "Message",
          "type": "string"
        },
        "payload": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Payload"
        },
        "vector": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Vector"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        },
        "attempts": {
          "default": 1,
          "title": "Attempts",
          "type": "integer"
        }
      },
      "required": [
        "error_id",
        "error_type",
        "message"
      ],
      "title": "ExecutionError",
      "type": "object"
    },
    "RiskFactor": {
      "description": "風險因子",
      "properties": {
        "factor_name": {
          "description": "風險因子名稱",
          "title": "Factor Name",
          "type": "string"
        },
        "weight": {
          "description": "權重",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Weight",
          "type": "number"
        },
        "value": {
          "description": "因子值",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Value",
          "type": "number"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "因子描述",
          "title": "Description"
        }
      },
      "required": [
        "factor_name",
        "weight",
        "value"
      ],
      "title": "RiskFactor",
      "type": "object"
    },
    "TaskDependency": {
      "description": "任務依賴",
      "properties": {
        "dependency_type": {
          "description": "依賴類型",
          "title": "Dependency Type",
          "type": "string"
        },
        "dependent_task_id": {
          "description": "依賴任務ID",
          "title": "Dependent Task Id",
          "type": "string"
        },
        "condition": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "依賴條件",
          "title": "Condition"
        },
        "required": {
          "default": true,
          "description": "是否必需",
          "title": "Required",
          "type": "boolean"
        }
      },
      "required": [
        "dependency_type",
        "dependent_task_id"
      ],
      "title": "TaskDependency",
      "type": "object"
    },
    "Topic": {
      "enum": [
        "tasks.scan.start",
        "results.scan.completed",
        "tasks.function.start",
        "tasks.function.xss",
        "tasks.function.sqli",
        "tasks.function.ssrf",
        "tasks.function.idor",
        "results.function.completed",
        "tasks.ai.training.start",
        "tasks.ai.training.episode",
        "tasks.ai.training.stop",
        "results.ai.training.progress",
        "results.ai.training.completed",
        "results.ai.training.failed",
        "events.ai.experience.created",
        "events.ai.trace.completed",
        "events.ai.model.updated",
        "commands.ai.model.deploy",
        "tasks.rag.knowledge.update",
        "tasks.rag.query",
        "results.rag.response",
        "findings.detected",
        "log.results.all",
        "status.task.update",
        "feedback.core.strategy",
        "module.heartbeat",
        "command.task.cancel",
        "config.global.update",
        "tasks.threat_intel.lookup",
        "tasks.threat_intel.ioc_enrichment",
        "tasks.threat_intel.mitre_mapping",
        "results.threat_intel",
        "results.scan.progress",
        "results.scan.failed",
        "events.scan.asset.discovered",
        "results.function.progress",
        "results.function.failed",
        "events.function.vuln.found",
        "tasks.integration.analysis.start",
        "results.integration.analysis.progress",
        "results.integration.analysis.completed",
        "commands.integration.report.generate",
        "events.integration.report.generated",
        "events.ai.scenario.loaded",
        "tasks.authz.check",
        "tasks.authz.analyze",
        "results.authz",
        "tasks.postex.test",
        "tasks.postex.privilege_escalation",
        "tasks.postex.lateral_movement",
        "tasks.postex.data_exfiltration",
        "tasks.postex.persistence",
        "results.postex",
        "tasks.remediation.generate",
        "results.remediation"
      ],
      "title": "Topic",
      "type": "string"
    },
    "AivaMessage": {
      "description": "AIVA 統一訊息格式 - 訊息佇列的標準信封",
      "properties": {
        "header": {
          "$ref": "#/$defs/MessageHeader"
        },
        "topic": {
          "$ref": "#/$defs/Topic"
        },
        "schema_version": {
          "default": "1.0",
          "title": "Schema Version",
          "type": "string"
        },
        "payload": {
          "additionalProperties": true,
          "title": "Payload",
          "type": "object"
        }
      },
      "required": [
        "header",
        "topic",
        "payload"
      ],
      "title": "AivaMessage",
      "type": "object"
    },
    "AIVARequest": {
      "description": "統一的請求包裝器 - 用於模組間的請求消息",
      "properties": {
        "request_id": {
          "title": "Request Id",
          "type": "string"
        },
        "source_module": {
          "title": "Source Module",
          "type": "string"
        },
        "target_module": {
          "title": "Target Module",
          "type": "string"
        },
        "request_type": {
          "title": "Request Type",
          "type": "string"
        },
        "payload": {
          "additionalProperties": true,
          "title": "Payload",
          "type": "object"
        },
        "trace_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Trace Id"
        },
        "timeout_seconds": {
          "default": 30,
          "maximum": 300,
          "minimum": 1,
          "title": "Timeout Seconds",
          "type": "integer"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "timestamp": {
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "request_id",
        "source_module",
        "target_module",
        "request_type",
        "payload",
        "timestamp"
      ],
      "title": "AIVARequest",
      "type": "object"
    },
    "AIVAResponse": {
      "description": "統一的響應包裝器 - 用於模組間的響應消息",
      "properties": {
        "request_id": {
          "title": "Request Id",
          "type": "string"
        },
        "response_type": {
          "title": "Response Type",
          "type": "string"
        },
        "success": {
          "title": "Success",
          "type": "boolean"
        },
        "payload": {
          "anyOf": [
            {
              "additionalProperties": true,
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Payload"
        },
        "error_code": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Error Code"
        },
        "error_message": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Error Message"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "timestamp": {
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "request_id",
        "response_type",
        "success",
        "timestamp"
      ],
      "title": "AIVAResponse",
      "type": "object"
    },
    "AIVAEvent": {
      "description": "統一的事件包裝器 - 用於模組間的事件通知",
      "properties": {
        "event_id": {
          "title": "Event Id",
          "type": "string"
        },
        "event_type": {
          "title": "Event Type",
          "type": "string"
        },
        "source_module": {
          "title": "Source Module",
          "type": "string"
        },
        "payload": {
          "additionalProperties": true,
          "title": "Payload",
          "type": "object"
        },
        "trace_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Trace Id"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "timestamp": {
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "event_id",
        "event_type",
        "source_module",
        "payload",
        "timestamp"
      ],
      "title": "AIVAEvent",
      "type": "object"
    },
    "AIVACommand": {
      "description": "統一的命令包裝器 - 用於模組間的命令消息",
      "properties": {
        "command_id": {
          "title": "Command Id",
          "type": "string"
        },
        "command_type": {
          "title": "Command Type",
          "type": "string"
        },
        "source_module": {
          "title": "Source Module",
          "type": "string"
        },
        "target_module": {
          "title": "Target Module",
          "type": "string"
        },
        "payload": {
          "additionalProperties": true,
          "title": "Payload",
          "type": "object"
        },
        "priority": {
          "default": 0,
          "maximum": 10,
          "minimum": 0,
          "title": "Priority",
          "type": "integer"
        },
        "trace_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Trace Id"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "timestamp": {
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "command_id",
        "command_type",
        "source_module",
        "target_module",
        "payload",
        "timestamp"
      ],
      "title": "AIVACommand",
      "type": "object"
    },
    "ScanStartPayload": {
      "description": "掃描啟動 Payload",
      "properties": {
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "targets": {
          "items": {
            "format": "uri",
            "maxLength": 2083,
            "minLength": 1,
            "type": "string"
          },
          "title": "Targets",
          "type": "array"
        },
        "scope": {
          "$ref": "#/$defs/ScanScope"
        },
        "authentication": {
          "$ref": "#/$defs/Authentication"
        },
        "strategy": {
          "default": "deep",
          "title": "Strategy",
          "type": "string"
        },
        "rate_limit": {
          "$ref": "#/$defs/RateLimit"
        },
        "custom_headers": {
          "additionalProperties": {
            "type": "string"
          },
          "title": "Custom Headers",
          "type": "object"
        },
        "x_forwarded_for": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "X Forwarded For"
        }
      },
      "required": [
        "scan_id",
        "targets"
      ],
      "title": "ScanStartPayload",
      "type": "object"
    },
    "ScanCompletedPayload": {
      "description": "掃描完成 Payload",
      "properties": {
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "status": {
          "title": "Status",
          "type": "string"
        },
        "summary": {
          "$ref": "#/$defs/Summary"
        },
        "assets": {
          "default": [],
          "items": {
            "$ref": "#/$defs/Asset"
          },
          "title": "Assets",
          "type": "array"
        },
        "fingerprints": {
          "anyOf": [
            {
              "$ref": "#/$defs/Fingerprints"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "error_info": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Error Info"
        }
      },
      "required": [
        "scan_id",
        "status",
        "summary"
      ],
      "title": "ScanCompletedPayload",
      "type": "object"
    },
    "FunctionTaskContext": {
      "description": "功能測試上下文",
      "properties": {
        "db_type_hint": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Db Type Hint"
        },
        "waf_detected": {
          "default": false,
          "title": "Waf Detected",
          "type": "boolean"
        },
        "related_findings": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Related Findings"
        }
      },
      "title": "FunctionTaskContext",
      "type": "object"
    },
    "FunctionTaskTarget": {
      "description": "功能測試目標",
      "properties": {
        "url": {
          "title": "Url"
        },
        "parameter": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Parameter"
        },
        "method": {
          "default": "GET",
          "title": "Method",
          "type": "string"
        },
        "parameter_location": {
          "default": "query",
          "title": "Parameter Location",
          "type": "string"
        },
        "headers": {
          "additionalProperties": {
            "type": "string"
          },
          "title": "Headers",
          "type": "object"
        },
        "cookies": {
          "additionalProperties": {
            "type": "string"
          },
          "title": "Cookies",
          "type": "object"
        },
        "form_data": {
          "additionalProperties": true,
          "title": "Form Data",
          "type": "object"
        },
        "json_data": {
          "anyOf": [
            {
              "additionalProperties": true,
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Json Data"
        },
        "body": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Body"
        }
      },
      "required": [
        "url"
      ],
      "title": "FunctionTaskTarget",
      "type": "object"
    },
    "FunctionTaskTestConfig": {
      "description": "功能測試配置",
      "properties": {
        "payloads": {
          "items": {
            "type": "string"
          },
          "title": "Payloads",
          "type": "array"
        },
        "custom_payloads": {
          "items": {
            "type": "string"
          },
          "title": "Custom Payloads",
          "type": "array"
        },
        "blind_xss": {
          "default": false,
          "title": "Blind Xss",
          "type": "boolean"
        },
        "dom_testing": {
          "default": false,
          "title": "Dom Testing",
          "type": "boolean"
        },
        "timeout": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Timeout"
        }
      },
      "title": "FunctionTaskTestConfig",
      "type": "object"
    },
    "FunctionTaskPayload": {
      "description": "功能測試任務 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "priority": {
          "default": 5,
          "title": "Priority",
          "type": "integer"
        },
        "target": {
          "$ref": "#/$defs/FunctionTaskTarget"
        },
        "context": {
          "$ref": "#/$defs/FunctionTaskContext"
        },
        "strategy": {
          "default": "full",
          "title": "Strategy",
          "type": "string"
        },
        "custom_payloads": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Custom Payloads"
        },
        "test_config": {
          "$ref": "#/$defs/FunctionTaskTestConfig"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "target"
      ],
      "title": "FunctionTaskPayload",
      "type": "object"
    },
    "FeedbackEventPayload": {
      "description": "反饋事件 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "event_type": {
          "title": "Event Type",
          "type": "string"
        },
        "details": {
          "additionalProperties": true,
          "default": {},
          "title": "Details",
          "type": "object"
        },
        "form_url": {
          "anyOf": [
            {
              "format": "uri",
              "maxLength": 2083,
              "minLength": 1,
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Form Url"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "event_type"
      ],
      "title": "FeedbackEventPayload",
      "type": "object"
    },
    "TaskUpdatePayload": {
      "description": "任務更新 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "status": {
          "title": "Status",
          "type": "string"
        },
        "worker_id": {
          "title": "Worker Id",
          "type": "string"
        },
        "details": {
          "anyOf": [
            {
              "additionalProperties": true,
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Details"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "status",
        "worker_id"
      ],
      "title": "TaskUpdatePayload",
      "type": "object"
    },
    "ConfigUpdatePayload": {
      "description": "配置更新 Payload",
      "properties": {
        "update_id": {
          "title": "Update Id",
          "type": "string"
        },
        "config_items": {
          "additionalProperties": true,
          "default": {},
          "title": "Config Items",
          "type": "object"
        }
      },
      "required": [
        "update_id"
      ],
      "title": "ConfigUpdatePayload",
      "type": "object"
    },
    "IOCType": {
      "description": "IOC (Indicator of Compromise) 類型枚舉",
      "enum": [
        "ip_address",
        "domain",
        "url",
        "file_hash",
        "email",
        "cve"
      ],
      "title": "IOCType",
      "type": "string"
    },
    "IntelSource": {
      "description": "威脅情報來源枚舉",
      "enum": [
        "virustotal",
        "abuseipdb",
        "shodan",
        "alienvault_otx",
        "mitre_attack",
        "internal"
      ],
      "title": "IntelSource",
      "type": "string"
    },
    "ThreatIntelLookupPayload": {
      "description": "威脅情報查詢 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "indicator": {
          "title": "Indicator",
          "type": "string"
        },
        "indicator_type": {
          "$ref": "#/$defs/IOCType"
        },
        "sources": {
          "anyOf": [
            {
              "items": {
                "$ref": "#/$defs/IntelSource"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Sources"
        },
        "enrich": {
          "default": true,
          "title": "Enrich",
          "type": "boolean"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "indicator",
        "indicator_type"
      ],
      "title": "ThreatIntelLookupPayload",
      "type": "object"
    },
    "ThreatLevel": {
      "description": "威脅等級枚舉 - 用於威脅情報",
      "enum": [
        "critical",
        "high",
        "medium",
        "low",
        "info",
        "unknown"
      ],
      "title": "ThreatLevel",
      "type": "string"
    },
    "ThreatIntelResultPayload": {
      "description": "威脅情報查詢結果 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "indicator": {
          "title": "Indicator",
          "type": "string"
        },
        "indicator_type": {
          "$ref": "#/$defs/IOCType"
        },
        "threat_level": {
          "$ref": "#/$defs/ThreatLevel"
        },
        "sources": {
          "additionalProperties": true,
          "title": "Sources",
          "type": "object"
        },
        "mitre_techniques": {
          "items": {
            "type": "string"
          },
          "title": "Mitre Techniques",
          "type": "array"
        },
        "enrichment_data": {
          "additionalProperties": true,
          "title": "Enrichment Data",
          "type": "object"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "indicator",
        "indicator_type",
        "threat_level"
      ],
      "title": "ThreatIntelResultPayload",
      "type": "object"
    },
    "AuthZCheckPayload": {
      "description": "權限檢查 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "user_id": {
          "title": "User Id",
          "type": "string"
        },
        "resource": {
          "title": "Resource",
          "type": "string"
        },
        "permission": {
          "title": "Permission",
          "type": "string"
        },
        "context": {
          "additionalProperties": true,
          "title": "Context",
          "type": "object"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "user_id",
        "resource",
        "permission"
      ],
      "title": "AuthZCheckPayload",
      "type": "object"
    },
    "AuthZAnalysisPayload": {
      "description": "權限分析 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "analysis_type": {
          "title": "Analysis Type",
          "type": "string"
        },
        "target": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Target"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "analysis_type"
      ],
      "title": "AuthZAnalysisPayload",
      "type": "object"
    },
    "AuthZResultPayload": {
      "description": "權限分析結果 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "decision": {
          "title": "Decision",
          "type": "string"
        },
        "analysis": {
          "additionalProperties": true,
          "title": "Analysis",
          "type": "object"
        },
        "recommendations": {
          "items": {
            "type": "string"
          },
          "title": "Recommendations",
          "type": "array"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "decision"
      ],
      "title": "AuthZResultPayload",
      "type": "object"
    },
    "RemediationType": {
      "description": "修復類型枚舉",
      "enum": [
        "code_fix",
        "config_change",
        "patch",
        "upgrade",
        "workaround",
        "mitigation"
      ],
      "title": "RemediationType",
      "type": "string"
    },
    "VulnerabilityType": {
      "enum": [
        "XSS",
        "SQL Injection",
        "SSRF",
        "IDOR",
        "BOLA",
        "Information Leak",
        "Weak Authentication",
        "Remote Code Execution",
        "Authentication Bypass",
        "Price Manipulation",
        "Workflow Bypass",
        "Race Condition",
        "Forced Browsing",
        "State Manipulation"
      ],
      "title": "VulnerabilityType",
      "type": "string"
    },
    "RemediationGeneratePayload": {
      "description": "修復方案生成 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "finding_id": {
          "title": "Finding Id",
          "type": "string"
        },
        "vulnerability_type": {
          "$ref": "#/$defs/VulnerabilityType"
        },
        "remediation_type": {
          "$ref": "#/$defs/RemediationType"
        },
        "context": {
          "additionalProperties": true,
          "title": "Context",
          "type": "object"
        },
        "auto_apply": {
          "default": false,
          "title": "Auto Apply",
          "type": "boolean"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "finding_id",
        "vulnerability_type",
        "remediation_type"
      ],
      "title": "RemediationGeneratePayload",
      "type": "object"
    },
    "RemediationResultPayload": {
      "description": "修復方案結果 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "finding_id": {
          "title": "Finding Id",
          "type": "string"
        },
        "remediation_type": {
          "$ref": "#/$defs/RemediationType"
        },
        "status": {
          "title": "Status",
          "type": "string"
        },
        "patch_content": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Patch Content"
        },
        "instructions": {
          "items": {
            "type": "string"
          },
          "title": "Instructions",
          "type": "array"
        },
        "verification_steps": {
          "items": {
            "type": "string"
          },
          "title": "Verification Steps",
          "type": "array"
        },
        "risk_assessment": {
          "additionalProperties": true,
          "title": "Risk Assessment",
          "type": "object"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "finding_id",
        "remediation_type",
        "status"
      ],
      "title": "RemediationResultPayload",
      "type": "object"
    },
    "PostExTestType": {
      "description": "後滲透測試類型枚舉 - 僅用於授權測試環境",
      "enum": [
        "privilege_escalation",
        "lateral_movement",
        "data_exfiltration",
        "persistence",
        "credential_harvesting",
        "command_execution"
      ],
      "title": "PostExTestType",
      "type": "string"
    },
    "PostExTestPayload": {
      "description": "後滲透測試 Payload (僅用於授權測試環境)",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "test_type": {
          "$ref": "#/$defs/PostExTestType"
        },
        "target": {
          "title": "Target",
          "type": "string"
        },
        "safe_mode": {
          "default": true,
          "title": "Safe Mode",
          "type": "boolean"
        },
        "authorization_token": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Authorization Token"
        },
        "context": {
          "additionalProperties": true,
          "title": "Context",
          "type": "object"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "test_type",
        "target"
      ],
      "title": "PostExTestPayload",
      "type": "object"
    },
    "PostExResultPayload": {
      "description": "後滲透測試結果 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "test_type": {
          "$ref": "#/$defs/PostExTestType"
        },
        "findings": {
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Findings",
          "type": "array"
        },
        "risk_level": {
          "$ref": "#/$defs/ThreatLevel"
        },
        "safe_mode": {
          "title": "Safe Mode",
          "type": "boolean"
        },
        "authorization_verified": {
          "default": false,
          "title": "Authorization Verified",
          "type": "boolean"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "test_type",
        "risk_level",
        "safe_mode"
      ],
      "title": "PostExResultPayload",
      "type": "object"
    },
    "BizLogicTestPayload": {
      "description": "業務邏輯測試 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "test_type": {
          "title": "Test Type",
          "type": "string"
        },
        "target_urls": {
          "additionalProperties": {
            "type": "string"
          },
          "title": "Target Urls",
          "type": "object"
        },
        "test_config": {
          "additionalProperties": true,
          "title": "Test Config",
          "type": "object"
        },
        "product_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Product Id"
        },
        "workflow_steps": {
          "items": {
            "additionalProperties": {
              "type": "string"
            },
            "type": "object"
          },
          "title": "Workflow Steps",
          "type": "array"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "test_type",
        "target_urls"
      ],
      "title": "BizLogicTestPayload",
      "type": "object"
    },
    "BizLogicResultPayload": {
      "description": "業務邏輯測試結果 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "test_type": {
          "title": "Test Type",
          "type": "string"
        },
        "status": {
          "title": "Status",
          "type": "string"
        },
        "findings": {
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Findings",
          "type": "array"
        },
        "statistics": {
          "additionalProperties": true,
          "title": "Statistics",
          "type": "object"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "test_type",
        "status"
      ],
      "title": "BizLogicResultPayload",
      "type": "object"
    },
    "APISchemaPayload": {
      "description": "API Schema 解析 Payload",
      "properties": {
        "schema_id": {
          "title": "Schema Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "schema_type": {
          "title": "Schema Type",
          "type": "string"
        },
        "schema_content": {
          "anyOf": [
            {
              "additionalProperties": true,
              "type": "object"
            },
            {
              "type": "string"
            }
          ],
          "title": "Schema Content"
        },
        "base_url": {
          "title": "Base Url",
          "type": "string"
        },
        "authentication": {
          "$ref": "#/$defs/Authentication"
        }
      },
      "required": [
        "schema_id",
        "scan_id",
        "schema_type",
        "schema_content",
        "base_url"
      ],
      "title": "APISchemaPayload",
      "type": "object"
    },
    "APITestCase": {
      "description": "API 測試案例",
      "properties": {
        "test_id": {
          "title": "Test Id",
          "type": "string"
        },
        "test_type": {
          "title": "Test Type",
          "type": "string"
        },
        "endpoint": {
          "title": "Endpoint",
          "type": "string"
        },
        "method": {
          "title": "Method",
          "type": "string"
        },
        "test_vectors": {
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Test Vectors",
          "type": "array"
        },
        "expected_behavior": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Expected Behavior"
        }
      },
      "required": [
        "test_id",
        "test_type",
        "endpoint",
        "method"
      ],
      "title": "APITestCase",
      "type": "object"
    },
    "APISecurityTestPayload": {
      "description": "API 安全測試 Payload",
      "properties": {
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "api_type": {
          "title": "Api Type",
          "type": "string"
        },
        "api_schema": {
          "anyOf": [
            {
              "$ref": "#/$defs/APISchemaPayload"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "test_cases": {
          "items": {
            "$ref": "#/$defs/APITestCase"
          },
          "title": "Test Cases",
          "type": "array"
        },
        "authentication": {
          "$ref": "#/$defs/Authentication"
        }
      },
      "required": [
        "task_id",
        "scan_id",
        "api_type"
      ],
      "title": "APISecurityTestPayload",
      "type": "object"
    },
    "EASMDiscoveryPayload": {
      "description": "EASM 資產探索 Payload",
      "properties": {
        "discovery_id": {
          "title": "Discovery Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "discovery_type": {
          "title": "Discovery Type",
          "type": "string"
        },
        "targets": {
          "items": {
            "type": "string"
          },
          "title": "Targets",
          "type": "array"
        },
        "scope": {
          "$ref": "#/$defs/ScanScope"
        },
        "max_depth": {
          "default": 3,
          "title": "Max Depth",
          "type": "integer"
        },
        "passive_only": {
          "default": false,
          "title": "Passive Only",
          "type": "boolean"
        }
      },
      "required": [
        "discovery_id",
        "scan_id",
        "discovery_type",
        "targets"
      ],
      "title": "EASMDiscoveryPayload",
      "type": "object"
    },
    "EASMDiscoveryResult": {
      "description": "EASM 探索結果",
      "properties": {
        "discovery_id": {
          "title": "Discovery Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "status": {
          "title": "Status",
          "type": "string"
        },
        "discovered_assets": {
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Discovered Assets",
          "type": "array"
        },
        "statistics": {
          "additionalProperties": true,
          "title": "Statistics",
          "type": "object"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "discovery_id",
        "scan_id",
        "status"
      ],
      "title": "EASMDiscoveryResult",
      "type": "object"
    },
    "StandardScenario": {
      "description": "標準靶場場景 - 用於訓練和測試",
      "properties": {
        "scenario_id": {
          "title": "Scenario Id",
          "type": "string"
        },
        "name": {
          "title": "Name",
          "type": "string"
        },
        "description": {
          "title": "Description",
          "type": "string"
        },
        "vulnerability_type": {
          "$ref": "#/$defs/VulnerabilityType"
        },
        "difficulty_level": {
          "title": "Difficulty Level",
          "type": "string"
        },
        "target_config": {
          "additionalProperties": true,
          "title": "Target Config",
          "type": "object"
        },
        "expected_plan": {
          "additionalProperties": true,
          "title": "Expected Plan",
          "type": "object"
        },
        "success_criteria": {
          "additionalProperties": true,
          "title": "Success Criteria",
          "type": "object"
        },
        "tags": {
          "items": {
            "type": "string"
          },
          "title": "Tags",
          "type": "array"
        },
        "created_at": {
          "format": "date-time",
          "title": "Created At",
          "type": "string"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "scenario_id",
        "name",
        "description",
        "vulnerability_type",
        "difficulty_level",
        "target_config",
        "expected_plan",
        "success_criteria"
      ],
      "title": "StandardScenario",
      "type": "object"
    },
    "ScenarioTestResult": {
      "description": "場景測試結果 - 模型在標準場景上的表現",
      "properties": {
        "test_id": {
          "title": "Test Id",
          "type": "string"
        },
        "scenario_id": {
          "title": "Scenario Id",
          "type": "string"
        },
        "model_version": {
          "title": "Model Version",
          "type": "string"
        },
        "generated_plan": {
          "additionalProperties": true,
          "title": "Generated Plan",
          "type": "object"
        },
        "execution_result": {
          "additionalProperties": true,
          "title": "Execution Result",
          "type": "object"
        },
        "score": {
          "title": "Score",
          "type": "number"
        },
        "comparison": {
          "additionalProperties": true,
          "title": "Comparison",
          "type": "object"
        },
        "passed": {
          "title": "Passed",
          "type": "boolean"
        },
        "tested_at": {
          "format": "date-time",
          "title": "Tested At",
          "type": "string"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "test_id",
        "scenario_id",
        "model_version",
        "generated_plan",
        "execution_result",
        "score",
        "comparison",
        "passed"
      ],
      "title": "ScenarioTestResult",
      "type": "object"
    },
    "ExploitPayload": {
      "description": "漏洞利用載荷",
      "properties": {
        "payload_id": {
          "description": "載荷ID",
          "title": "Payload Id",
          "type": "string"
        },
        "payload_type": {
          "description": "載荷類型",
          "title": "Payload Type",
          "type": "string"
        },
        "payload_content": {
          "description": "載荷內容",
          "title": "Payload Content",
          "type": "string"
        },
        "encoding": {
          "default": "none",
          "description": "編碼方式",
          "title": "Encoding",
          "type": "string"
        },
        "obfuscation": {
          "default": false,
          "description": "是否混淆",
          "title": "Obfuscation",
          "type": "boolean"
        },
        "bypass_technique": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "繞過技術",
          "title": "Bypass Technique"
        },
        "target_technology": {
          "description": "目標技術",
          "items": {
            "type": "string"
          },
          "title": "Target Technology",
          "type": "array"
        },
        "required_context": {
          "additionalProperties": true,
          "description": "所需上下文",
          "title": "Required Context",
          "type": "object"
        },
        "effectiveness_score": {
          "description": "效果評分",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Effectiveness Score",
          "type": "number"
        },
        "detection_evasion": {
          "description": "逃避檢測能力",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Detection Evasion",
          "type": "number"
        },
        "success_rate": {
          "description": "成功率",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Success Rate",
          "type": "number"
        },
        "usage_count": {
          "description": "使用次數",
          "minimum": 0,
          "title": "Usage Count",
          "type": "integer"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "payload_id",
        "payload_type",
        "payload_content",
        "effectiveness_score",
        "detection_evasion",
        "success_rate",
        "usage_count"
      ],
      "title": "ExploitPayload",
      "type": "object"
    },
    "Confidence": {
      "enum": [
        "Certain",
        "Firm",
        "Possible"
      ],
      "title": "Confidence",
      "type": "string"
    },
    "TestStatus": {
      "description": "測試狀態枚舉 - 用於追蹤測試執行狀態",
      "enum": [
        "draft",
        "pending",
        "running",
        "completed",
        "failed",
        "cancelled"
      ],
      "title": "TestStatus",
      "type": "string"
    },
    "TestExecution": {
      "description": "測試執行記錄",
      "properties": {
        "execution_id": {
          "description": "執行ID",
          "title": "Execution Id",
          "type": "string"
        },
        "test_case_id": {
          "description": "測試案例ID",
          "title": "Test Case Id",
          "type": "string"
        },
        "target_url": {
          "description": "目標URL",
          "title": "Target Url",
          "type": "string"
        },
        "timeout": {
          "default": 30,
          "description": "超時時間(秒)",
          "minimum": 1,
          "title": "Timeout",
          "type": "integer"
        },
        "retry_attempts": {
          "default": 3,
          "description": "重試次數",
          "minimum": 0,
          "title": "Retry Attempts",
          "type": "integer"
        },
        "status": {
          "$ref": "#/$defs/TestStatus",
          "description": "執行狀態"
        },
        "start_time": {
          "format": "date-time",
          "title": "Start Time",
          "type": "string"
        },
        "end_time": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "結束時間",
          "title": "End Time"
        },
        "duration": {
          "anyOf": [
            {
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "執行時間(秒)",
          "title": "Duration"
        },
        "success": {
          "description": "是否成功",
          "title": "Success",
          "type": "boolean"
        },
        "vulnerability_found": {
          "description": "是否發現漏洞",
          "title": "Vulnerability Found",
          "type": "boolean"
        },
        "confidence_level": {
          "$ref": "#/$defs/Confidence",
          "description": "結果置信度"
        },
        "request_data": {
          "additionalProperties": true,
          "description": "請求數據",
          "title": "Request Data",
          "type": "object"
        },
        "response_data": {
          "additionalProperties": true,
          "description": "響應數據",
          "title": "Response Data",
          "type": "object"
        },
        "evidence": {
          "description": "證據列表",
          "items": {
            "type": "string"
          },
          "title": "Evidence",
          "type": "array"
        },
        "error_message": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "錯誤消息",
          "title": "Error Message"
        },
        "cpu_usage": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "CPU使用率",
          "title": "Cpu Usage"
        },
        "memory_usage": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "內存使用(MB)",
          "title": "Memory Usage"
        },
        "network_traffic": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "網絡流量(bytes)",
          "title": "Network Traffic"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "execution_id",
        "test_case_id",
        "target_url",
        "status",
        "success",
        "vulnerability_found",
        "confidence_level"
      ],
      "title": "TestExecution",
      "type": "object"
    },
    "Severity": {
      "enum": [
        "Critical",
        "High",
        "Medium",
        "Low",
        "Informational"
      ],
      "title": "Severity",
      "type": "string"
    },
    "ExploitResult": {
      "description": "漏洞利用結果",
      "properties": {
        "result_id": {
          "description": "結果ID",
          "title": "Result Id",
          "type": "string"
        },
        "exploit_id": {
          "description": "利用ID",
          "title": "Exploit Id",
          "type": "string"
        },
        "target_id": {
          "description": "目標ID",
          "title": "Target Id",
          "type": "string"
        },
        "success": {
          "description": "利用是否成功",
          "title": "Success",
          "type": "boolean"
        },
        "severity": {
          "$ref": "#/$defs/Severity",
          "description": "嚴重程度"
        },
        "impact_level": {
          "description": "影響級別",
          "title": "Impact Level",
          "type": "string"
        },
        "exploit_technique": {
          "description": "利用技術",
          "title": "Exploit Technique",
          "type": "string"
        },
        "payload_used": {
          "description": "使用的載荷",
          "title": "Payload Used",
          "type": "string"
        },
        "execution_time": {
          "description": "執行時間(秒)",
          "minimum": 0.0,
          "title": "Execution Time",
          "type": "number"
        },
        "access_gained": {
          "additionalProperties": true,
          "description": "獲得的訪問權限",
          "title": "Access Gained",
          "type": "object"
        },
        "data_extracted": {
          "description": "提取的數據",
          "items": {
            "type": "string"
          },
          "title": "Data Extracted",
          "type": "array"
        },
        "system_impact": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "系統影響",
          "title": "System Impact"
        },
        "detection_bypassed": {
          "description": "是否繞過檢測",
          "title": "Detection Bypassed",
          "type": "boolean"
        },
        "artifacts_left": {
          "description": "留下的痕跡",
          "items": {
            "type": "string"
          },
          "title": "Artifacts Left",
          "type": "array"
        },
        "remediation_verified": {
          "default": false,
          "description": "修復是否已驗證",
          "title": "Remediation Verified",
          "type": "boolean"
        },
        "retest_required": {
          "default": true,
          "description": "是否需要重測",
          "title": "Retest Required",
          "type": "boolean"
        },
        "executed_at": {
          "format": "date-time",
          "title": "Executed At",
          "type": "string"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "result_id",
        "exploit_id",
        "target_id",
        "success",
        "severity",
        "impact_level",
        "exploit_technique",
        "payload_used",
        "execution_time",
        "detection_bypassed"
      ],
      "title": "ExploitResult",
      "type": "object"
    },
    "TestStrategy": {
      "description": "測試策略",
      "properties": {
        "strategy_id": {
          "description": "策略ID",
          "title": "Strategy Id",
          "type": "string"
        },
        "strategy_name": {
          "description": "策略名稱",
          "title": "Strategy Name",
          "type": "string"
        },
        "target_type": {
          "description": "目標類型",
          "title": "Target Type",
          "type": "string"
        },
        "test_categories": {
          "description": "測試分類",
          "items": {
            "type": "string"
          },
          "title": "Test Categories",
          "type": "array"
        },
        "test_sequence": {
          "description": "測試順序",
          "items": {
            "type": "string"
          },
          "title": "Test Sequence",
          "type": "array"
        },
        "parallel_execution": {
          "default": false,
          "description": "是否並行執行",
          "title": "Parallel Execution",
          "type": "boolean"
        },
        "trigger_conditions": {
          "description": "觸發條件",
          "items": {
            "type": "string"
          },
          "title": "Trigger Conditions",
          "type": "array"
        },
        "stop_conditions": {
          "description": "停止條件",
          "items": {
            "type": "string"
          },
          "title": "Stop Conditions",
          "type": "array"
        },
        "priority_weights": {
          "additionalProperties": {
            "type": "number"
          },
          "description": "優先級權重",
          "title": "Priority Weights",
          "type": "object"
        },
        "resource_limits": {
          "additionalProperties": true,
          "description": "資源限制",
          "title": "Resource Limits",
          "type": "object"
        },
        "learning_enabled": {
          "default": true,
          "description": "是否啟用學習",
          "title": "Learning Enabled",
          "type": "boolean"
        },
        "adaptation_threshold": {
          "description": "適應閾值",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Adaptation Threshold",
          "type": "number"
        },
        "effectiveness_score": {
          "description": "效果評分",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Effectiveness Score",
          "type": "number"
        },
        "usage_count": {
          "description": "使用次數",
          "minimum": 0,
          "title": "Usage Count",
          "type": "integer"
        },
        "success_rate": {
          "description": "成功率",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Success Rate",
          "type": "number"
        },
        "created_at": {
          "format": "date-time",
          "title": "Created At",
          "type": "string"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "strategy_id",
        "strategy_name",
        "target_type",
        "test_categories",
        "test_sequence",
        "adaptation_threshold",
        "effectiveness_score",
        "usage_count",
        "success_rate"
      ],
      "title": "TestStrategy",
      "type": "object"
    },
    "Vulnerability": {
      "description": "漏洞基本資訊 - 用於 Finding 中的漏洞描述\n\n符合標準：\n- CWE: Common Weakness Enumeration (MITRE)\n- CVE: Common Vulnerabilities and Exposures\n- CVSS: Common Vulnerability Scoring System v3.1/v4.0\n- OWASP: Open Web Application Security Project",
      "properties": {
        "name": {
          "$ref": "#/$defs/VulnerabilityType"
        },
        "cwe": {
          "anyOf": [
            {
              "pattern": "^CWE-\\d+$",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "CWE ID (格式: CWE-XXX)，參考 https://cwe.mitre.org/",
          "title": "Cwe"
        },
        "cve": {
          "anyOf": [
            {
              "pattern": "^CVE-\\d{4}-\\d{4,}$",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "CVE ID (格式: CVE-YYYY-NNNNN)，參考 https://cve.mitre.org/",
          "title": "Cve"
        },
        "severity": {
          "$ref": "#/$defs/Severity"
        },
        "confidence": {
          "$ref": "#/$defs/Confidence"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "cvss_score": {
          "anyOf": [
            {
              "maximum": 10.0,
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "CVSS v3.1 Base Score (0.0-10.0)，參考 https://www.first.org/cvss/",
          "title": "Cvss Score"
        },
        "cvss_vector": {
          "anyOf": [
            {
              "pattern": "^CVSS:3\\.[01]/.*",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "CVSS v3.1 Vector String，例如: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "title": "Cvss Vector"
        },
        "owasp_category": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "OWASP Top 10 分類，例如: A03:2021-Injection",
          "title": "Owasp Category"
        }
      },
      "required": [
        "name",
        "severity",
        "confidence"
      ],
      "title": "Vulnerability",
      "type": "object"
    },
    "Target": {
      "description": "目標資訊 - 漏洞所在位置",
      "properties": {
        "url": {
          "title": "Url"
        },
        "parameter": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Parameter"
        },
        "method": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Method"
        },
        "headers": {
          "additionalProperties": {
            "type": "string"
          },
          "title": "Headers",
          "type": "object"
        },
        "params": {
          "additionalProperties": true,
          "title": "Params",
          "type": "object"
        },
        "body": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Body"
        }
      },
      "required": [
        "url"
      ],
      "title": "Target",
      "type": "object"
    },
    "FindingTarget": {
      "description": "目標資訊 - 漏洞所在位置",
      "properties": {
        "url": {
          "title": "Url"
        },
        "parameter": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Parameter"
        },
        "method": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Method"
        },
        "headers": {
          "additionalProperties": {
            "type": "string"
          },
          "title": "Headers",
          "type": "object"
        },
        "params": {
          "additionalProperties": true,
          "title": "Params",
          "type": "object"
        },
        "body": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Body"
        }
      },
      "required": [
        "url"
      ],
      "title": "Target",
      "type": "object"
    },
    "FindingEvidence": {
      "description": "漏洞證據",
      "properties": {
        "payload": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Payload"
        },
        "response_time_delta": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Response Time Delta"
        },
        "db_version": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Db Version"
        },
        "request": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Request"
        },
        "response": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Response"
        },
        "proof": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Proof"
        }
      },
      "title": "FindingEvidence",
      "type": "object"
    },
    "FindingImpact": {
      "description": "漏洞影響描述",
      "properties": {
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "business_impact": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Business Impact"
        },
        "technical_impact": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Technical Impact"
        },
        "affected_users": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Affected Users"
        },
        "estimated_cost": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Estimated Cost"
        }
      },
      "title": "FindingImpact",
      "type": "object"
    },
    "FindingRecommendation": {
      "description": "漏洞修復建議",
      "properties": {
        "fix": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Fix"
        },
        "priority": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Priority"
        },
        "remediation_steps": {
          "items": {
            "type": "string"
          },
          "title": "Remediation Steps",
          "type": "array"
        },
        "references": {
          "items": {
            "type": "string"
          },
          "title": "References",
          "type": "array"
        }
      },
      "title": "FindingRecommendation",
      "type": "object"
    },
    "FindingPayload": {
      "description": "漏洞發現 Payload - 統一的漏洞報告格式",
      "properties": {
        "finding_id": {
          "title": "Finding Id",
          "type": "string"
        },
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "status": {
          "title": "Status",
          "type": "string"
        },
        "vulnerability": {
          "$ref": "#/$defs/Vulnerability"
        },
        "target": {
          "$ref": "#/$defs/Target"
        },
        "strategy": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Strategy"
        },
        "evidence": {
          "anyOf": [
            {
              "$ref": "#/$defs/FindingEvidence"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "impact": {
          "anyOf": [
            {
              "$ref": "#/$defs/FindingImpact"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "recommendation": {
          "anyOf": [
            {
              "$ref": "#/$defs/FindingRecommendation"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "created_at": {
          "format": "date-time",
          "title": "Created At",
          "type": "string"
        },
        "updated_at": {
          "format": "date-time",
          "title": "Updated At",
          "type": "string"
        }
      },
      "required": [
        "finding_id",
        "task_id",
        "scan_id",
        "status",
        "vulnerability",
        "target"
      ],
      "title": "FindingPayload",
      "type": "object"
    },
    "SensitiveMatch": {
      "description": "敏感資訊匹配結果",
      "properties": {
        "match_id": {
          "title": "Match Id",
          "type": "string"
        },
        "pattern_name": {
          "title": "Pattern Name",
          "type": "string"
        },
        "matched_text": {
          "title": "Matched Text",
          "type": "string"
        },
        "context": {
          "title": "Context",
          "type": "string"
        },
        "confidence": {
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Confidence",
          "type": "number"
        },
        "line_number": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Line Number"
        },
        "file_path": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "File Path"
        },
        "url": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Url"
        },
        "severity": {
          "$ref": "#/$defs/Severity",
          "default": "Medium"
        }
      },
      "required": [
        "match_id",
        "pattern_name",
        "matched_text",
        "context",
        "confidence"
      ],
      "title": "SensitiveMatch",
      "type": "object"
    },
    "JavaScriptAnalysisResult": {
      "description": "JavaScript 分析結果",
      "properties": {
        "analysis_id": {
          "title": "Analysis Id",
          "type": "string"
        },
        "url": {
          "title": "Url",
          "type": "string"
        },
        "source_size_bytes": {
          "title": "Source Size Bytes",
          "type": "integer"
        },
        "dangerous_functions": {
          "items": {
            "type": "string"
          },
          "title": "Dangerous Functions",
          "type": "array"
        },
        "external_resources": {
          "items": {
            "type": "string"
          },
          "title": "External Resources",
          "type": "array"
        },
        "data_leaks": {
          "items": {
            "additionalProperties": {
              "type": "string"
            },
            "type": "object"
          },
          "title": "Data Leaks",
          "type": "array"
        },
        "findings": {
          "items": {
            "type": "string"
          },
          "title": "Findings",
          "type": "array"
        },
        "apis_called": {
          "items": {
            "type": "string"
          },
          "title": "Apis Called",
          "type": "array"
        },
        "ajax_endpoints": {
          "items": {
            "type": "string"
          },
          "title": "Ajax Endpoints",
          "type": "array"
        },
        "suspicious_patterns": {
          "items": {
            "type": "string"
          },
          "title": "Suspicious Patterns",
          "type": "array"
        },
        "risk_score": {
          "default": 0.0,
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Risk Score",
          "type": "number"
        },
        "security_score": {
          "default": 100,
          "maximum": 100,
          "minimum": 0,
          "title": "Security Score",
          "type": "integer"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "analysis_id",
        "url",
        "source_size_bytes"
      ],
      "title": "JavaScriptAnalysisResult",
      "type": "object"
    },
    "VulnerabilityCorrelation": {
      "description": "漏洞關聯分析結果",
      "properties": {
        "correlation_id": {
          "title": "Correlation Id",
          "type": "string"
        },
        "correlation_type": {
          "title": "Correlation Type",
          "type": "string"
        },
        "related_findings": {
          "items": {
            "type": "string"
          },
          "title": "Related Findings",
          "type": "array"
        },
        "confidence_score": {
          "title": "Confidence Score",
          "type": "number"
        },
        "root_cause": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Root Cause"
        },
        "common_components": {
          "items": {
            "type": "string"
          },
          "title": "Common Components",
          "type": "array"
        },
        "explanation": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Explanation"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "correlation_id",
        "correlation_type",
        "related_findings",
        "confidence_score"
      ],
      "title": "VulnerabilityCorrelation",
      "type": "object"
    },
    "CodeLevelRootCause": {
      "description": "程式碼層面根因分析結果",
      "properties": {
        "analysis_id": {
          "title": "Analysis Id",
          "type": "string"
        },
        "vulnerable_component": {
          "title": "Vulnerable Component",
          "type": "string"
        },
        "affected_findings": {
          "items": {
            "type": "string"
          },
          "title": "Affected Findings",
          "type": "array"
        },
        "code_location": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Code Location"
        },
        "vulnerability_pattern": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Vulnerability Pattern"
        },
        "fix_recommendation": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Fix Recommendation"
        }
      },
      "required": [
        "analysis_id",
        "vulnerable_component",
        "affected_findings"
      ],
      "title": "CodeLevelRootCause",
      "type": "object"
    },
    "SASTDASTCorrelation": {
      "description": "SAST-DAST 資料流關聯結果",
      "properties": {
        "correlation_id": {
          "title": "Correlation Id",
          "type": "string"
        },
        "sast_finding_id": {
          "title": "Sast Finding Id",
          "type": "string"
        },
        "dast_finding_id": {
          "title": "Dast Finding Id",
          "type": "string"
        },
        "data_flow_path": {
          "items": {
            "type": "string"
          },
          "title": "Data Flow Path",
          "type": "array"
        },
        "verification_status": {
          "title": "Verification Status",
          "type": "string"
        },
        "confidence_score": {
          "title": "Confidence Score",
          "type": "number"
        },
        "explanation": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Explanation"
        }
      },
      "required": [
        "correlation_id",
        "sast_finding_id",
        "dast_finding_id",
        "data_flow_path",
        "verification_status",
        "confidence_score"
      ],
      "title": "SASTDASTCorrelation",
      "type": "object"
    },
    "AIVerificationRequest": {
      "description": "AI 驅動漏洞驗證請求",
      "properties": {
        "verification_id": {
          "title": "Verification Id",
          "type": "string"
        },
        "finding_id": {
          "title": "Finding Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "vulnerability_type": {
          "$ref": "#/$defs/VulnerabilityType"
        },
        "target": {
          "$ref": "#/$defs/Target"
        },
        "evidence": {
          "$ref": "#/$defs/FindingEvidence"
        },
        "verification_mode": {
          "default": "non_destructive",
          "title": "Verification Mode",
          "type": "string"
        },
        "context": {
          "additionalProperties": true,
          "title": "Context",
          "type": "object"
        }
      },
      "required": [
        "verification_id",
        "finding_id",
        "scan_id",
        "vulnerability_type",
        "target",
        "evidence"
      ],
      "title": "AIVerificationRequest",
      "type": "object"
    },
    "AIVerificationResult": {
      "description": "AI 驅動漏洞驗證結果",
      "properties": {
        "verification_id": {
          "title": "Verification Id",
          "type": "string"
        },
        "finding_id": {
          "title": "Finding Id",
          "type": "string"
        },
        "verification_status": {
          "title": "Verification Status",
          "type": "string"
        },
        "confidence_score": {
          "title": "Confidence Score",
          "type": "number"
        },
        "verification_method": {
          "title": "Verification Method",
          "type": "string"
        },
        "test_steps": {
          "items": {
            "type": "string"
          },
          "title": "Test Steps",
          "type": "array"
        },
        "observations": {
          "items": {
            "type": "string"
          },
          "title": "Observations",
          "type": "array"
        },
        "recommendations": {
          "items": {
            "type": "string"
          },
          "title": "Recommendations",
          "type": "array"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "verification_id",
        "finding_id",
        "verification_status",
        "confidence_score",
        "verification_method"
      ],
      "title": "AIVerificationResult",
      "type": "object"
    },
    "HeartbeatPayload": {
      "description": "心跳 Payload",
      "properties": {
        "module": {
          "$ref": "#/$defs/ModuleName"
        },
        "worker_id": {
          "title": "Worker Id",
          "type": "string"
        },
        "capacity": {
          "title": "Capacity",
          "type": "integer"
        }
      },
      "required": [
        "module",
        "worker_id",
        "capacity"
      ],
      "title": "HeartbeatPayload",
      "type": "object"
    },
    "ModuleStatus": {
      "description": "模組狀態報告 - 用於模組健康檢查和監控",
      "properties": {
        "module": {
          "$ref": "#/$defs/ModuleName"
        },
        "status": {
          "title": "Status",
          "type": "string"
        },
        "worker_id": {
          "title": "Worker Id",
          "type": "string"
        },
        "worker_count": {
          "default": 1,
          "title": "Worker Count",
          "type": "integer"
        },
        "queue_size": {
          "default": 0,
          "title": "Queue Size",
          "type": "integer"
        },
        "tasks_completed": {
          "default": 0,
          "title": "Tasks Completed",
          "type": "integer"
        },
        "tasks_failed": {
          "default": 0,
          "title": "Tasks Failed",
          "type": "integer"
        },
        "last_heartbeat": {
          "format": "date-time",
          "title": "Last Heartbeat",
          "type": "string"
        },
        "metrics": {
          "additionalProperties": true,
          "title": "Metrics",
          "type": "object"
        },
        "uptime_seconds": {
          "default": 0.0,
          "title": "Uptime Seconds",
          "type": "number"
        }
      },
      "required": [
        "module",
        "status",
        "worker_id"
      ],
      "title": "ModuleStatus",
      "type": "object"
    },
    "FunctionTelemetry": {
      "description": "功能模組遙測數據基礎類",
      "properties": {
        "payloads_sent": {
          "default": 0,
          "title": "Payloads Sent",
          "type": "integer"
        },
        "detections": {
          "default": 0,
          "title": "Detections",
          "type": "integer"
        },
        "attempts": {
          "default": 0,
          "title": "Attempts",
          "type": "integer"
        },
        "errors": {
          "items": {
            "type": "string"
          },
          "title": "Errors",
          "type": "array"
        },
        "duration_seconds": {
          "default": 0.0,
          "title": "Duration Seconds",
          "type": "number"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "title": "FunctionTelemetry",
      "type": "object"
    },
    "AdaptiveBehaviorInfo": {
      "description": "自適應行為信息",
      "properties": {
        "initial_batch_size": {
          "default": 10,
          "title": "Initial Batch Size",
          "type": "integer"
        },
        "final_batch_size": {
          "default": 10,
          "title": "Final Batch Size",
          "type": "integer"
        },
        "rate_adjustments": {
          "default": 0,
          "title": "Rate Adjustments",
          "type": "integer"
        },
        "protection_detections": {
          "default": 0,
          "title": "Protection Detections",
          "type": "integer"
        },
        "bypass_attempts": {
          "default": 0,
          "title": "Bypass Attempts",
          "type": "integer"
        },
        "success_rate": {
          "default": 0.0,
          "title": "Success Rate",
          "type": "number"
        },
        "details": {
          "additionalProperties": true,
          "title": "Details",
          "type": "object"
        }
      },
      "title": "AdaptiveBehaviorInfo",
      "type": "object"
    },
    "EarlyStoppingInfo": {
      "description": "提前停止信息",
      "properties": {
        "reason": {
          "$ref": "#/$defs/StoppingReason"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        },
        "total_tests": {
          "title": "Total Tests",
          "type": "integer"
        },
        "completed_tests": {
          "title": "Completed Tests",
          "type": "integer"
        },
        "remaining_tests": {
          "title": "Remaining Tests",
          "type": "integer"
        },
        "details": {
          "additionalProperties": true,
          "title": "Details",
          "type": "object"
        }
      },
      "required": [
        "reason",
        "total_tests",
        "completed_tests",
        "remaining_tests"
      ],
      "title": "EarlyStoppingInfo",
      "type": "object"
    },
    "ErrorCategory": {
      "description": "錯誤分類 - 用於統計和分析",
      "enum": [
        "network",
        "timeout",
        "rate_limit",
        "validation",
        "protection",
        "parsing",
        "authentication",
        "authorization",
        "unknown"
      ],
      "title": "ErrorCategory",
      "type": "string"
    },
    "ErrorRecord": {
      "description": "錯誤記錄",
      "properties": {
        "category": {
          "$ref": "#/$defs/ErrorCategory"
        },
        "message": {
          "title": "Message",
          "type": "string"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        },
        "details": {
          "additionalProperties": true,
          "title": "Details",
          "type": "object"
        }
      },
      "required": [
        "category",
        "message"
      ],
      "title": "ErrorRecord",
      "type": "object"
    },
    "OastCallbackDetail": {
      "description": "OAST 回調詳情",
      "properties": {
        "callback_type": {
          "title": "Callback Type",
          "type": "string"
        },
        "token": {
          "title": "Token",
          "type": "string"
        },
        "source_ip": {
          "title": "Source Ip",
          "type": "string"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        },
        "protocol": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Protocol"
        },
        "raw_data": {
          "additionalProperties": true,
          "title": "Raw Data",
          "type": "object"
        }
      },
      "required": [
        "callback_type",
        "token",
        "source_ip",
        "timestamp"
      ],
      "title": "OastCallbackDetail",
      "type": "object"
    },
    "StoppingReason": {
      "description": "Early Stopping 原因 - 用於記錄檢測提前終止的原因",
      "enum": [
        "max_vulnerabilities_reached",
        "time_limit_exceeded",
        "protection_detected",
        "error_threshold_exceeded",
        "rate_limited",
        "no_response_timeout",
        "manual_stop",
        "resource_exhausted"
      ],
      "title": "StoppingReason",
      "type": "string"
    },
    "EnhancedFunctionTelemetry": {
      "description": "增強版功能模組遙測 - 統一擴展所有 Worker 模組\n\n繼承自 FunctionTelemetry，新增:\n- 結構化錯誤記錄 (分類、時間戳、詳情)\n- OAST 回調追蹤 (支持 HTTP/DNS/SMTP 等)\n- 提前停止檢測 (8種原因，含剩餘測試數)\n- 自適應行為監控 (批次大小、成功率、繞過嘗試)",
      "properties": {
        "payloads_sent": {
          "default": 0,
          "title": "Payloads Sent",
          "type": "integer"
        },
        "detections": {
          "default": 0,
          "title": "Detections",
          "type": "integer"
        },
        "attempts": {
          "default": 0,
          "title": "Attempts",
          "type": "integer"
        },
        "errors": {
          "items": {
            "type": "string"
          },
          "title": "Errors",
          "type": "array"
        },
        "duration_seconds": {
          "default": 0.0,
          "title": "Duration Seconds",
          "type": "number"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        },
        "error_records": {
          "items": {
            "$ref": "#/$defs/ErrorRecord"
          },
          "title": "Error Records",
          "type": "array"
        },
        "oast_callbacks": {
          "items": {
            "$ref": "#/$defs/OastCallbackDetail"
          },
          "title": "Oast Callbacks",
          "type": "array"
        },
        "early_stopping": {
          "anyOf": [
            {
              "$ref": "#/$defs/EarlyStoppingInfo"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "adaptive_behavior": {
          "anyOf": [
            {
              "$ref": "#/$defs/AdaptiveBehaviorInfo"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        }
      },
      "title": "EnhancedFunctionTelemetry",
      "type": "object"
    },
    "FunctionExecutionResult": {
      "description": "功能模組執行結果統一格式",
      "properties": {
        "findings": {
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Findings",
          "type": "array"
        },
        "telemetry": {
          "additionalProperties": true,
          "title": "Telemetry",
          "type": "object"
        },
        "errors": {
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Errors",
          "type": "array"
        },
        "duration_seconds": {
          "default": 0.0,
          "title": "Duration Seconds",
          "type": "number"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "findings",
        "telemetry"
      ],
      "title": "FunctionExecutionResult",
      "type": "object"
    },
    "OastEvent": {
      "description": "OAST (Out-of-Band Application Security Testing) 事件數據合約",
      "properties": {
        "event_id": {
          "title": "Event Id",
          "type": "string"
        },
        "probe_token": {
          "title": "Probe Token",
          "type": "string"
        },
        "event_type": {
          "title": "Event Type",
          "type": "string"
        },
        "source_ip": {
          "title": "Source Ip",
          "type": "string"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        },
        "protocol": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Protocol"
        },
        "raw_request": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Raw Request"
        },
        "raw_data": {
          "additionalProperties": true,
          "title": "Raw Data",
          "type": "object"
        }
      },
      "required": [
        "event_id",
        "probe_token",
        "event_type",
        "source_ip"
      ],
      "title": "OastEvent",
      "type": "object"
    },
    "OastProbe": {
      "description": "OAST 探針數據合約",
      "properties": {
        "probe_id": {
          "title": "Probe Id",
          "type": "string"
        },
        "token": {
          "title": "Token",
          "type": "string"
        },
        "callback_url": {
          "title": "Callback Url",
          "type": "string"
        },
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "created_at": {
          "format": "date-time",
          "title": "Created At",
          "type": "string"
        },
        "expires_at": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Expires At"
        },
        "status": {
          "default": "active",
          "title": "Status",
          "type": "string"
        }
      },
      "required": [
        "probe_id",
        "token",
        "callback_url",
        "task_id",
        "scan_id"
      ],
      "title": "OastProbe",
      "type": "object"
    },
    "SIEMEventPayload": {
      "description": "SIEM 事件 Payload",
      "properties": {
        "event_id": {
          "title": "Event Id",
          "type": "string"
        },
        "event_type": {
          "title": "Event Type",
          "type": "string"
        },
        "severity": {
          "title": "Severity",
          "type": "string"
        },
        "source": {
          "title": "Source",
          "type": "string"
        },
        "destination": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Destination"
        },
        "message": {
          "title": "Message",
          "type": "string"
        },
        "details": {
          "additionalProperties": true,
          "title": "Details",
          "type": "object"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "event_id",
        "event_type",
        "severity",
        "source",
        "message"
      ],
      "title": "SIEMEventPayload",
      "type": "object"
    },
    "SIEMEvent": {
      "description": "SIEM事件記錄",
      "properties": {
        "event_id": {
          "description": "事件ID",
          "title": "Event Id",
          "type": "string"
        },
        "event_type": {
          "description": "事件類型",
          "title": "Event Type",
          "type": "string"
        },
        "source_system": {
          "description": "來源系統",
          "title": "Source System",
          "type": "string"
        },
        "timestamp": {
          "description": "事件時間戳",
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        },
        "received_at": {
          "format": "date-time",
          "title": "Received At",
          "type": "string"
        },
        "severity": {
          "$ref": "#/$defs/Severity",
          "description": "嚴重程度"
        },
        "category": {
          "description": "事件分類",
          "title": "Category",
          "type": "string"
        },
        "subcategory": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "事件子分類",
          "title": "Subcategory"
        },
        "source_ip": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "來源IP",
          "title": "Source Ip"
        },
        "source_port": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "來源端口",
          "title": "Source Port"
        },
        "destination_ip": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "目標IP",
          "title": "Destination Ip"
        },
        "destination_port": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "目標端口",
          "title": "Destination Port"
        },
        "username": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "用戶名",
          "title": "Username"
        },
        "asset_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "資產ID",
          "title": "Asset Id"
        },
        "hostname": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "主機名",
          "title": "Hostname"
        },
        "description": {
          "description": "事件描述",
          "title": "Description",
          "type": "string"
        },
        "raw_log": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "原始日誌",
          "title": "Raw Log"
        },
        "correlation_rules": {
          "description": "觸發的關聯規則",
          "items": {
            "type": "string"
          },
          "title": "Correlation Rules",
          "type": "array"
        },
        "related_events": {
          "description": "相關事件ID",
          "items": {
            "type": "string"
          },
          "title": "Related Events",
          "type": "array"
        },
        "status": {
          "default": "new",
          "description": "處理狀態",
          "title": "Status",
          "type": "string"
        },
        "assigned_to": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "分配給",
          "title": "Assigned To"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "event_id",
        "event_type",
        "source_system",
        "timestamp",
        "severity",
        "category",
        "description"
      ],
      "title": "SIEMEvent",
      "type": "object"
    },
    "NotificationPayload": {
      "description": "通知 Payload - 用於 Slack/Teams/Email",
      "properties": {
        "notification_id": {
          "title": "Notification Id",
          "type": "string"
        },
        "notification_type": {
          "title": "Notification Type",
          "type": "string"
        },
        "priority": {
          "title": "Priority",
          "type": "string"
        },
        "title": {
          "title": "Title",
          "type": "string"
        },
        "message": {
          "title": "Message",
          "type": "string"
        },
        "details": {
          "additionalProperties": true,
          "title": "Details",
          "type": "object"
        },
        "recipients": {
          "items": {
            "type": "string"
          },
          "title": "Recipients",
          "type": "array"
        },
        "attachments": {
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Attachments",
          "type": "array"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "notification_id",
        "notification_type",
        "priority",
        "title",
        "message"
      ],
      "title": "NotificationPayload",
      "type": "object"
    },
    "CVSSv3Metrics": {
      "description": "CVSS v3.1 標準指標",
      "properties": {
        "attack_vector": {
          "description": "攻擊向量",
          "enum": [
            "N",
            "A",
            "L",
            "P"
          ],
          "title": "Attack Vector",
          "type": "string"
        },
        "attack_complexity": {
          "description": "攻擊複雜度",
          "enum": [
            "L",
            "H"
          ],
          "title": "Attack Complexity",
          "type": "string"
        },
        "privileges_required": {
          "description": "所需權限",
          "enum": [
            "N",
            "L",
            "H"
          ],
          "title": "Privileges Required",
          "type": "string"
        },
        "user_interaction": {
          "description": "用戶交互",
          "enum": [
            "N",
            "R"
          ],
          "title": "User Interaction",
          "type": "string"
        },
        "scope": {
          "description": "範圍",
          "enum": [
            "U",
            "C"
          ],
          "title": "Scope",
          "type": "string"
        },
        "confidentiality": {
          "description": "機密性影響",
          "enum": [
            "N",
            "L",
            "H"
          ],
          "title": "Confidentiality",
          "type": "string"
        },
        "integrity": {
          "description": "完整性影響",
          "enum": [
            "N",
            "L",
            "H"
          ],
          "title": "Integrity",
          "type": "string"
        },
        "availability": {
          "description": "可用性影響",
          "enum": [
            "N",
            "L",
            "H"
          ],
          "title": "Availability",
          "type": "string"
        },
        "exploit_code_maturity": {
          "default": "X",
          "description": "漏洞利用代碼成熟度",
          "enum": [
            "X",
            "H",
            "F",
            "P",
            "U"
          ],
          "title": "Exploit Code Maturity",
          "type": "string"
        },
        "remediation_level": {
          "default": "X",
          "description": "修復級別",
          "enum": [
            "X",
            "U",
            "W",
            "T",
            "O"
          ],
          "title": "Remediation Level",
          "type": "string"
        },
        "report_confidence": {
          "default": "X",
          "description": "報告置信度",
          "enum": [
            "X",
            "C",
            "R",
            "U"
          ],
          "title": "Report Confidence",
          "type": "string"
        },
        "confidentiality_requirement": {
          "default": "X",
          "description": "機密性要求",
          "enum": [
            "X",
            "L",
            "M",
            "H"
          ],
          "title": "Confidentiality Requirement",
          "type": "string"
        },
        "integrity_requirement": {
          "default": "X",
          "description": "完整性要求",
          "enum": [
            "X",
            "L",
            "M",
            "H"
          ],
          "title": "Integrity Requirement",
          "type": "string"
        },
        "availability_requirement": {
          "default": "X",
          "description": "可用性要求",
          "enum": [
            "X",
            "L",
            "M",
            "H"
          ],
          "title": "Availability Requirement",
          "type": "string"
        },
        "base_score": {
          "anyOf": [
            {
              "maximum": 10.0,
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "基本分數",
          "title": "Base Score"
        },
        "temporal_score": {
          "anyOf": [
            {
              "maximum": 10.0,
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "時間分數",
          "title": "Temporal Score"
        },
        "environmental_score": {
          "anyOf": [
            {
              "maximum": 10.0,
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "環境分數",
          "title": "Environmental Score"
        },
        "vector_string": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "CVSS 向量字符串",
          "title": "Vector String"
        }
      },
      "required": [
        "attack_vector",
        "attack_complexity",
        "privileges_required",
        "user_interaction",
        "scope",
        "confidentiality",
        "integrity",
        "availability"
      ],
      "title": "CVSSv3Metrics",
      "type": "object"
    },
    "AttackStep": {
      "description": "攻擊步驟 (整合 MITRE ATT&CK)",
      "properties": {
        "step_id": {
          "title": "Step Id",
          "type": "string"
        },
        "action": {
          "title": "Action",
          "type": "string"
        },
        "tool_type": {
          "title": "Tool Type",
          "type": "string"
        },
        "target": {
          "additionalProperties": true,
          "title": "Target",
          "type": "object"
        },
        "parameters": {
          "additionalProperties": true,
          "title": "Parameters",
          "type": "object"
        },
        "expected_result": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Expected Result"
        },
        "timeout_seconds": {
          "default": 30.0,
          "title": "Timeout Seconds",
          "type": "number"
        },
        "retry_count": {
          "default": 0,
          "title": "Retry Count",
          "type": "integer"
        },
        "mitre_technique_id": {
          "anyOf": [
            {
              "pattern": "^T\\d{4}(\\.\\d{3})?$",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Mitre Technique Id"
        },
        "mitre_tactic": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Mitre Tactic"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "step_id",
        "action",
        "tool_type"
      ],
      "title": "AttackStep",
      "type": "object"
    },
    "AttackPlan": {
      "description": "攻擊計畫",
      "properties": {
        "plan_id": {
          "title": "Plan Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "attack_type": {
          "$ref": "#/$defs/VulnerabilityType"
        },
        "steps": {
          "items": {
            "$ref": "#/$defs/AttackStep"
          },
          "title": "Steps",
          "type": "array"
        },
        "dependencies": {
          "additionalProperties": {
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "title": "Dependencies",
          "type": "object"
        },
        "context": {
          "additionalProperties": true,
          "title": "Context",
          "type": "object"
        },
        "target_info": {
          "additionalProperties": true,
          "title": "Target Info",
          "type": "object"
        },
        "created_at": {
          "format": "date-time",
          "title": "Created At",
          "type": "string"
        },
        "created_by": {
          "default": "ai_planner",
          "title": "Created By",
          "type": "string"
        },
        "mitre_techniques": {
          "items": {
            "type": "string"
          },
          "title": "Mitre Techniques",
          "type": "array"
        },
        "mitre_tactics": {
          "items": {
            "type": "string"
          },
          "title": "Mitre Tactics",
          "type": "array"
        },
        "capec_id": {
          "anyOf": [
            {
              "pattern": "^CAPEC-\\d+$",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Capec Id"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "plan_id",
        "scan_id",
        "attack_type",
        "steps"
      ],
      "title": "AttackPlan",
      "type": "object"
    },
    "TraceRecord": {
      "description": "執行追蹤記錄",
      "properties": {
        "trace_id": {
          "title": "Trace Id",
          "type": "string"
        },
        "plan_id": {
          "title": "Plan Id",
          "type": "string"
        },
        "step_id": {
          "title": "Step Id",
          "type": "string"
        },
        "session_id": {
          "title": "Session Id",
          "type": "string"
        },
        "tool_name": {
          "title": "Tool Name",
          "type": "string"
        },
        "input_data": {
          "additionalProperties": true,
          "title": "Input Data",
          "type": "object"
        },
        "output_data": {
          "additionalProperties": true,
          "title": "Output Data",
          "type": "object"
        },
        "status": {
          "title": "Status",
          "type": "string"
        },
        "error_message": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Error Message"
        },
        "execution_time_seconds": {
          "default": 0.0,
          "title": "Execution Time Seconds",
          "type": "number"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        },
        "environment_response": {
          "additionalProperties": true,
          "title": "Environment Response",
          "type": "object"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "trace_id",
        "plan_id",
        "step_id",
        "session_id",
        "tool_name",
        "status"
      ],
      "title": "TraceRecord",
      "type": "object"
    },
    "PlanExecutionMetrics": {
      "description": "計畫執行指標",
      "properties": {
        "plan_id": {
          "title": "Plan Id",
          "type": "string"
        },
        "session_id": {
          "title": "Session Id",
          "type": "string"
        },
        "expected_steps": {
          "title": "Expected Steps",
          "type": "integer"
        },
        "executed_steps": {
          "title": "Executed Steps",
          "type": "integer"
        },
        "completed_steps": {
          "title": "Completed Steps",
          "type": "integer"
        },
        "failed_steps": {
          "title": "Failed Steps",
          "type": "integer"
        },
        "skipped_steps": {
          "title": "Skipped Steps",
          "type": "integer"
        },
        "extra_actions": {
          "title": "Extra Actions",
          "type": "integer"
        },
        "completion_rate": {
          "title": "Completion Rate",
          "type": "number"
        },
        "success_rate": {
          "title": "Success Rate",
          "type": "number"
        },
        "sequence_accuracy": {
          "title": "Sequence Accuracy",
          "type": "number"
        },
        "goal_achieved": {
          "title": "Goal Achieved",
          "type": "boolean"
        },
        "reward_score": {
          "title": "Reward Score",
          "type": "number"
        },
        "total_execution_time": {
          "title": "Total Execution Time",
          "type": "number"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "plan_id",
        "session_id",
        "expected_steps",
        "executed_steps",
        "completed_steps",
        "failed_steps",
        "skipped_steps",
        "extra_actions",
        "completion_rate",
        "success_rate",
        "sequence_accuracy",
        "goal_achieved",
        "reward_score",
        "total_execution_time"
      ],
      "title": "PlanExecutionMetrics",
      "type": "object"
    },
    "PlanExecutionResult": {
      "description": "計畫執行結果",
      "properties": {
        "result_id": {
          "title": "Result Id",
          "type": "string"
        },
        "plan_id": {
          "title": "Plan Id",
          "type": "string"
        },
        "session_id": {
          "title": "Session Id",
          "type": "string"
        },
        "plan": {
          "$ref": "#/$defs/AttackPlan"
        },
        "trace": {
          "items": {
            "$ref": "#/$defs/TraceRecord"
          },
          "title": "Trace",
          "type": "array"
        },
        "metrics": {
          "$ref": "#/$defs/PlanExecutionMetrics"
        },
        "findings": {
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Findings",
          "type": "array"
        },
        "anomalies": {
          "items": {
            "type": "string"
          },
          "title": "Anomalies",
          "type": "array"
        },
        "recommendations": {
          "items": {
            "type": "string"
          },
          "title": "Recommendations",
          "type": "array"
        },
        "status": {
          "title": "Status",
          "type": "string"
        },
        "completed_at": {
          "format": "date-time",
          "title": "Completed At",
          "type": "string"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "result_id",
        "plan_id",
        "session_id",
        "plan",
        "trace",
        "metrics",
        "status"
      ],
      "title": "PlanExecutionResult",
      "type": "object"
    },
    "ModelTrainingConfig": {
      "description": "模型訓練配置",
      "properties": {
        "config_id": {
          "title": "Config Id",
          "type": "string"
        },
        "model_type": {
          "title": "Model Type",
          "type": "string"
        },
        "training_mode": {
          "title": "Training Mode",
          "type": "string"
        },
        "batch_size": {
          "default": 32,
          "title": "Batch Size",
          "type": "integer"
        },
        "learning_rate": {
          "default": 0.001,
          "title": "Learning Rate",
          "type": "number"
        },
        "epochs": {
          "default": 10,
          "title": "Epochs",
          "type": "integer"
        },
        "validation_split": {
          "default": 0.2,
          "title": "Validation Split",
          "type": "number"
        },
        "early_stopping": {
          "default": true,
          "title": "Early Stopping",
          "type": "boolean"
        },
        "patience": {
          "default": 3,
          "title": "Patience",
          "type": "integer"
        },
        "reward_function": {
          "default": "completion_rate",
          "title": "Reward Function",
          "type": "string"
        },
        "discount_factor": {
          "default": 0.99,
          "title": "Discount Factor",
          "type": "number"
        },
        "exploration_rate": {
          "default": 0.1,
          "title": "Exploration Rate",
          "type": "number"
        },
        "hyperparameters": {
          "additionalProperties": true,
          "title": "Hyperparameters",
          "type": "object"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "config_id",
        "model_type",
        "training_mode"
      ],
      "title": "ModelTrainingConfig",
      "type": "object"
    },
    "AITrainingStartPayload": {
      "description": "AI 訓練啟動請求",
      "properties": {
        "training_id": {
          "title": "Training Id",
          "type": "string"
        },
        "training_type": {
          "title": "Training Type",
          "type": "string"
        },
        "scenario_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Scenario Id"
        },
        "target_vulnerability": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Target Vulnerability"
        },
        "config": {
          "$ref": "#/$defs/ModelTrainingConfig"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "training_id",
        "training_type",
        "config"
      ],
      "title": "AITrainingStartPayload",
      "type": "object"
    },
    "AITrainingProgressPayload": {
      "description": "AI 訓練進度報告",
      "properties": {
        "training_id": {
          "title": "Training Id",
          "type": "string"
        },
        "episode_number": {
          "title": "Episode Number",
          "type": "integer"
        },
        "total_episodes": {
          "title": "Total Episodes",
          "type": "integer"
        },
        "successful_episodes": {
          "default": 0,
          "title": "Successful Episodes",
          "type": "integer"
        },
        "failed_episodes": {
          "default": 0,
          "title": "Failed Episodes",
          "type": "integer"
        },
        "total_samples": {
          "default": 0,
          "title": "Total Samples",
          "type": "integer"
        },
        "high_quality_samples": {
          "default": 0,
          "title": "High Quality Samples",
          "type": "integer"
        },
        "avg_reward": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Avg Reward"
        },
        "avg_quality": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Avg Quality"
        },
        "best_reward": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Best Reward"
        },
        "model_metrics": {
          "additionalProperties": {
            "type": "number"
          },
          "title": "Model Metrics",
          "type": "object"
        },
        "status": {
          "default": "running",
          "title": "Status",
          "type": "string"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "training_id",
        "episode_number",
        "total_episodes"
      ],
      "title": "AITrainingProgressPayload",
      "type": "object"
    },
    "AITrainingCompletedPayload": {
      "description": "AI 訓練完成報告 - 訓練會話完成時的最終報告",
      "properties": {
        "training_id": {
          "title": "Training Id",
          "type": "string"
        },
        "status": {
          "title": "Status",
          "type": "string"
        },
        "total_episodes": {
          "title": "Total Episodes",
          "type": "integer"
        },
        "successful_episodes": {
          "title": "Successful Episodes",
          "type": "integer"
        },
        "failed_episodes": {
          "title": "Failed Episodes",
          "type": "integer"
        },
        "total_duration_seconds": {
          "title": "Total Duration Seconds",
          "type": "number"
        },
        "total_samples": {
          "title": "Total Samples",
          "type": "integer"
        },
        "high_quality_samples": {
          "title": "High Quality Samples",
          "type": "integer"
        },
        "medium_quality_samples": {
          "title": "Medium Quality Samples",
          "type": "integer"
        },
        "low_quality_samples": {
          "title": "Low Quality Samples",
          "type": "integer"
        },
        "final_avg_reward": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Final Avg Reward"
        },
        "final_avg_quality": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Final Avg Quality"
        },
        "best_episode_reward": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Best Episode Reward"
        },
        "model_checkpoint_path": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Model Checkpoint Path"
        },
        "model_metrics": {
          "additionalProperties": {
            "type": "number"
          },
          "title": "Model Metrics",
          "type": "object"
        },
        "error_message": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Error Message"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "completed_at": {
          "format": "date-time",
          "title": "Completed At",
          "type": "string"
        }
      },
      "required": [
        "training_id",
        "status",
        "total_episodes",
        "successful_episodes",
        "failed_episodes",
        "total_duration_seconds",
        "total_samples",
        "high_quality_samples",
        "medium_quality_samples",
        "low_quality_samples"
      ],
      "title": "AITrainingCompletedPayload",
      "type": "object"
    },
    "AIExperienceCreatedEvent": {
      "description": "AI 經驗樣本創建事件 - 當新的經驗樣本被創建時發送",
      "properties": {
        "experience_id": {
          "title": "Experience Id",
          "type": "string"
        },
        "training_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Training Id"
        },
        "trace_id": {
          "title": "Trace Id",
          "type": "string"
        },
        "vulnerability_type": {
          "title": "Vulnerability Type",
          "type": "string"
        },
        "quality_score": {
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Quality Score",
          "type": "number"
        },
        "success": {
          "title": "Success",
          "type": "boolean"
        },
        "plan_summary": {
          "additionalProperties": true,
          "title": "Plan Summary",
          "type": "object"
        },
        "result_summary": {
          "additionalProperties": true,
          "title": "Result Summary",
          "type": "object"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "experience_id",
        "trace_id",
        "vulnerability_type",
        "quality_score",
        "success"
      ],
      "title": "AIExperienceCreatedEvent",
      "type": "object"
    },
    "AITraceCompletedEvent": {
      "description": "AI 執行追蹤完成事件 - 當執行追蹤完成時發送",
      "properties": {
        "trace_id": {
          "title": "Trace Id",
          "type": "string"
        },
        "session_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Session Id"
        },
        "training_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Training Id"
        },
        "total_steps": {
          "title": "Total Steps",
          "type": "integer"
        },
        "successful_steps": {
          "title": "Successful Steps",
          "type": "integer"
        },
        "failed_steps": {
          "title": "Failed Steps",
          "type": "integer"
        },
        "duration_seconds": {
          "title": "Duration Seconds",
          "type": "number"
        },
        "final_success": {
          "title": "Final Success",
          "type": "boolean"
        },
        "plan_type": {
          "title": "Plan Type",
          "type": "string"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "trace_id",
        "total_steps",
        "successful_steps",
        "failed_steps",
        "duration_seconds",
        "final_success",
        "plan_type"
      ],
      "title": "AITraceCompletedEvent",
      "type": "object"
    },
    "AIModelUpdatedEvent": {
      "description": "AI 模型更新事件 - 當模型被訓練更新時發送",
      "properties": {
        "model_id": {
          "title": "Model Id",
          "type": "string"
        },
        "model_version": {
          "title": "Model Version",
          "type": "string"
        },
        "training_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Training Id"
        },
        "update_type": {
          "title": "Update Type",
          "type": "string"
        },
        "performance_metrics": {
          "additionalProperties": {
            "type": "number"
          },
          "title": "Performance Metrics",
          "type": "object"
        },
        "model_path": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Model Path"
        },
        "checkpoint_path": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Checkpoint Path"
        },
        "is_deployed": {
          "default": false,
          "title": "Is Deployed",
          "type": "boolean"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "model_id",
        "model_version",
        "update_type"
      ],
      "title": "AIModelUpdatedEvent",
      "type": "object"
    },
    "AIModelDeployCommand": {
      "description": "AI 模型部署命令 - 用於部署訓練好的模型到生產環境",
      "properties": {
        "model_id": {
          "title": "Model Id",
          "type": "string"
        },
        "model_version": {
          "title": "Model Version",
          "type": "string"
        },
        "checkpoint_path": {
          "title": "Checkpoint Path",
          "type": "string"
        },
        "deployment_target": {
          "default": "production",
          "title": "Deployment Target",
          "type": "string"
        },
        "deployment_config": {
          "additionalProperties": true,
          "title": "Deployment Config",
          "type": "object"
        },
        "require_validation": {
          "default": true,
          "title": "Require Validation",
          "type": "boolean"
        },
        "min_performance_threshold": {
          "additionalProperties": {
            "type": "number"
          },
          "title": "Min Performance Threshold",
          "type": "object"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "model_id",
        "model_version",
        "checkpoint_path"
      ],
      "title": "AIModelDeployCommand",
      "type": "object"
    },
    "RAGKnowledgeUpdatePayload": {
      "description": "RAG 知識庫更新請求",
      "properties": {
        "knowledge_type": {
          "title": "Knowledge Type",
          "type": "string"
        },
        "content": {
          "title": "Content",
          "type": "string"
        },
        "source_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Source Id"
        },
        "category": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Category"
        },
        "tags": {
          "items": {
            "type": "string"
          },
          "title": "Tags",
          "type": "array"
        },
        "related_cve": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Related Cve"
        },
        "related_cwe": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Related Cwe"
        },
        "mitre_techniques": {
          "items": {
            "type": "string"
          },
          "title": "Mitre Techniques",
          "type": "array"
        },
        "confidence": {
          "default": 1.0,
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Confidence",
          "type": "number"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "knowledge_type",
        "content"
      ],
      "title": "RAGKnowledgeUpdatePayload",
      "type": "object"
    },
    "RAGQueryPayload": {
      "description": "RAG 查詢請求",
      "properties": {
        "query_id": {
          "title": "Query Id",
          "type": "string"
        },
        "query_text": {
          "title": "Query Text",
          "type": "string"
        },
        "top_k": {
          "default": 5,
          "maximum": 100,
          "minimum": 1,
          "title": "Top K",
          "type": "integer"
        },
        "min_similarity": {
          "default": 0.5,
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Min Similarity",
          "type": "number"
        },
        "knowledge_types": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Knowledge Types"
        },
        "categories": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Categories"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "query_id",
        "query_text"
      ],
      "title": "RAGQueryPayload",
      "type": "object"
    },
    "RAGResponsePayload": {
      "description": "RAG 查詢響應 - RAG 知識庫查詢的結果",
      "properties": {
        "query_id": {
          "title": "Query Id",
          "type": "string"
        },
        "results": {
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Results",
          "type": "array"
        },
        "total_results": {
          "title": "Total Results",
          "type": "integer"
        },
        "avg_similarity": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Avg Similarity"
        },
        "enhanced_context": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Enhanced Context"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "query_id",
        "total_results"
      ],
      "title": "RAGResponsePayload",
      "type": "object"
    },
    "ExperienceSample": {
      "description": "經驗樣本 (用於強化學習)",
      "properties": {
        "sample_id": {
          "description": "樣本唯一標識",
          "title": "Sample Id",
          "type": "string"
        },
        "session_id": {
          "description": "會話ID",
          "title": "Session Id",
          "type": "string"
        },
        "plan_id": {
          "description": "計劃ID",
          "title": "Plan Id",
          "type": "string"
        },
        "state_before": {
          "additionalProperties": true,
          "description": "執行前狀態",
          "title": "State Before",
          "type": "object"
        },
        "action_taken": {
          "additionalProperties": true,
          "description": "採取的行動",
          "title": "Action Taken",
          "type": "object"
        },
        "state_after": {
          "additionalProperties": true,
          "description": "執行後狀態",
          "title": "State After",
          "type": "object"
        },
        "reward": {
          "description": "獎勵值",
          "title": "Reward",
          "type": "number"
        },
        "reward_breakdown": {
          "additionalProperties": {
            "type": "number"
          },
          "description": "獎勵分解 (completion, success, sequence, goal)",
          "title": "Reward Breakdown",
          "type": "object"
        },
        "context": {
          "additionalProperties": true,
          "description": "環境上下文",
          "title": "Context",
          "type": "object"
        },
        "target_info": {
          "additionalProperties": true,
          "description": "目標信息",
          "title": "Target Info",
          "type": "object"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        },
        "duration_ms": {
          "anyOf": [
            {
              "minimum": 0,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "執行時長",
          "title": "Duration Ms"
        },
        "quality_score": {
          "anyOf": [
            {
              "maximum": 1.0,
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "樣本質量分數",
          "title": "Quality Score"
        },
        "is_positive": {
          "description": "是否為正樣本",
          "title": "Is Positive",
          "type": "boolean"
        },
        "confidence": {
          "default": 1.0,
          "description": "樣本置信度",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Confidence",
          "type": "number"
        },
        "learning_tags": {
          "description": "學習標籤",
          "items": {
            "type": "string"
          },
          "title": "Learning Tags",
          "type": "array"
        },
        "difficulty_level": {
          "default": 1,
          "description": "難度級別",
          "maximum": 5,
          "minimum": 1,
          "title": "Difficulty Level",
          "type": "integer"
        }
      },
      "required": [
        "sample_id",
        "session_id",
        "plan_id",
        "state_before",
        "action_taken",
        "state_after",
        "reward",
        "is_positive"
      ],
      "title": "ExperienceSample",
      "type": "object"
    },
    "EnhancedVulnerability": {
      "description": "增強漏洞信息 (整合 AI 分析結果)",
      "properties": {
        "vulnerability_id": {
          "description": "漏洞唯一標識",
          "title": "Vulnerability Id",
          "type": "string"
        },
        "title": {
          "description": "漏洞標題",
          "title": "Title",
          "type": "string"
        },
        "description": {
          "description": "漏洞描述",
          "title": "Description",
          "type": "string"
        },
        "vulnerability_type": {
          "description": "漏洞類型",
          "title": "Vulnerability Type",
          "type": "string"
        },
        "severity": {
          "description": "嚴重性",
          "enum": [
            "low",
            "medium",
            "high",
            "critical"
          ],
          "title": "Severity",
          "type": "string"
        },
        "url": {
          "description": "漏洞URL",
          "title": "Url",
          "type": "string"
        },
        "parameter": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "參數名",
          "title": "Parameter"
        },
        "location": {
          "description": "參數位置",
          "title": "Location",
          "type": "string"
        },
        "cvss_metrics": {
          "anyOf": [
            {
              "$ref": "#/$defs/CVSSv3Metrics"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "CVSS v3.1 指標"
        },
        "ai_confidence": {
          "description": "AI 置信度",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Ai Confidence",
          "type": "number"
        },
        "ai_risk_assessment": {
          "additionalProperties": true,
          "description": "AI 風險評估",
          "title": "Ai Risk Assessment",
          "type": "object"
        },
        "exploitability_score": {
          "description": "可利用性分數",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Exploitability Score",
          "type": "number"
        },
        "attack_vector": {
          "description": "攻擊向量",
          "title": "Attack Vector",
          "type": "string"
        },
        "attack_complexity": {
          "description": "攻擊複雜度",
          "title": "Attack Complexity",
          "type": "string"
        },
        "prerequisites": {
          "description": "利用前提",
          "items": {
            "type": "string"
          },
          "title": "Prerequisites",
          "type": "array"
        },
        "business_impact": {
          "additionalProperties": true,
          "description": "業務影響",
          "title": "Business Impact",
          "type": "object"
        },
        "technical_impact": {
          "additionalProperties": true,
          "description": "技術影響",
          "title": "Technical Impact",
          "type": "object"
        },
        "remediation_effort": {
          "description": "修復難度",
          "title": "Remediation Effort",
          "type": "string"
        },
        "remediation_priority": {
          "description": "修復優先級",
          "maximum": 5,
          "minimum": 1,
          "title": "Remediation Priority",
          "type": "integer"
        },
        "fix_recommendations": {
          "description": "修復建議",
          "items": {
            "type": "string"
          },
          "title": "Fix Recommendations",
          "type": "array"
        },
        "poc_available": {
          "default": false,
          "description": "是否有概念驗證",
          "title": "Poc Available",
          "type": "boolean"
        },
        "verified": {
          "default": false,
          "description": "是否已驗證",
          "title": "Verified",
          "type": "boolean"
        },
        "false_positive_probability": {
          "description": "誤報概率",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "False Positive Probability",
          "type": "number"
        },
        "discovered_at": {
          "format": "date-time",
          "title": "Discovered At",
          "type": "string"
        },
        "last_verified_at": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "最後驗證時間",
          "title": "Last Verified At"
        },
        "tags": {
          "description": "標籤",
          "items": {
            "type": "string"
          },
          "title": "Tags",
          "type": "array"
        },
        "references": {
          "description": "參考資料",
          "items": {
            "type": "string"
          },
          "title": "References",
          "type": "array"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "額外元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "vulnerability_id",
        "title",
        "description",
        "vulnerability_type",
        "severity",
        "url",
        "location",
        "ai_confidence",
        "exploitability_score",
        "attack_vector",
        "attack_complexity",
        "remediation_effort",
        "remediation_priority",
        "false_positive_probability"
      ],
      "title": "EnhancedVulnerability",
      "type": "object"
    },
    "SARIFLocation": {
      "description": "SARIF 位置信息",
      "properties": {
        "uri": {
          "description": "資源URI",
          "title": "Uri",
          "type": "string"
        },
        "start_line": {
          "anyOf": [
            {
              "minimum": 1,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "開始行號",
          "title": "Start Line"
        },
        "start_column": {
          "anyOf": [
            {
              "minimum": 1,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "開始列號",
          "title": "Start Column"
        },
        "end_line": {
          "anyOf": [
            {
              "minimum": 1,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "結束行號",
          "title": "End Line"
        },
        "end_column": {
          "anyOf": [
            {
              "minimum": 1,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "結束列號",
          "title": "End Column"
        }
      },
      "required": [
        "uri"
      ],
      "title": "SARIFLocation",
      "type": "object"
    },
    "SARIFResult": {
      "description": "SARIF 結果",
      "properties": {
        "rule_id": {
          "description": "規則ID",
          "title": "Rule Id",
          "type": "string"
        },
        "message": {
          "description": "消息",
          "title": "Message",
          "type": "string"
        },
        "level": {
          "description": "級別",
          "enum": [
            "error",
            "warning",
            "info",
            "note"
          ],
          "title": "Level",
          "type": "string"
        },
        "locations": {
          "description": "位置列表",
          "items": {
            "$ref": "#/$defs/SARIFLocation"
          },
          "title": "Locations",
          "type": "array"
        },
        "partial_fingerprints": {
          "additionalProperties": {
            "type": "string"
          },
          "description": "部分指紋",
          "title": "Partial Fingerprints",
          "type": "object"
        },
        "properties": {
          "type": "object",
          "additionalProperties": true,
          "description": "屬性",
          "title": "Properties"
        }
      },
      "required": [
        "rule_id",
        "message",
        "level",
        "locations"
      ],
      "title": "SARIFResult",
      "type": "object"
    },
    "SARIFRule": {
      "description": "SARIF 規則",
      "properties": {
        "id": {
          "description": "規則ID",
          "title": "Id",
          "type": "string"
        },
        "name": {
          "description": "規則名稱",
          "title": "Name",
          "type": "string"
        },
        "short_description": {
          "description": "簡短描述",
          "title": "Short Description",
          "type": "string"
        },
        "full_description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "完整描述",
          "title": "Full Description"
        },
        "help_uri": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "幫助URI",
          "title": "Help Uri"
        },
        "default_level": {
          "default": "warning",
          "description": "默認級別",
          "enum": [
            "error",
            "warning",
            "info",
            "note"
          ],
          "title": "Default Level",
          "type": "string"
        },
        "properties": {
          "type": "object",
          "additionalProperties": true,
          "description": "屬性",
          "title": "Properties"
        }
      },
      "required": [
        "id",
        "name",
        "short_description"
      ],
      "title": "SARIFRule",
      "type": "object"
    },
    "SARIFTool": {
      "description": "SARIF 工具信息",
      "properties": {
        "name": {
          "description": "工具名稱",
          "title": "Name",
          "type": "string"
        },
        "version": {
          "description": "版本",
          "title": "Version",
          "type": "string"
        },
        "information_uri": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "信息URI",
          "title": "Information Uri"
        },
        "rules": {
          "description": "規則列表",
          "items": {
            "$ref": "#/$defs/SARIFRule"
          },
          "title": "Rules",
          "type": "array"
        }
      },
      "required": [
        "name",
        "version"
      ],
      "title": "SARIFTool",
      "type": "object"
    },
    "SARIFRun": {
      "description": "SARIF 運行",
      "properties": {
        "tool": {
          "$ref": "#/$defs/SARIFTool",
          "description": "工具信息"
        },
        "results": {
          "description": "結果列表",
          "items": {
            "$ref": "#/$defs/SARIFResult"
          },
          "title": "Results",
          "type": "array"
        },
        "invocations": {
          "description": "調用信息",
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Invocations",
          "type": "array"
        },
        "artifacts": {
          "description": "工件信息",
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Artifacts",
          "type": "array"
        },
        "properties": {
          "type": "object",
          "additionalProperties": true,
          "description": "屬性",
          "title": "Properties"
        }
      },
      "required": [
        "tool",
        "results"
      ],
      "title": "SARIFRun",
      "type": "object"
    },
    "SARIFReport": {
      "description": "SARIF v2.1.0 報告",
      "properties": {
        "version": {
          "default": "2.1.0",
          "description": "SARIF版本",
          "title": "Version",
          "type": "string"
        },
        "$schema": {
          "default": "https://json.schemastore.org/sarif-2.1.0.json",
          "description": "JSON Schema URL",
          "title": "$Schema",
          "type": "string"
        },
        "runs": {
          "description": "運行列表",
          "items": {
            "$ref": "#/$defs/SARIFRun"
          },
          "title": "Runs",
          "type": "array"
        },
        "properties": {
          "type": "object",
          "additionalProperties": true,
          "description": "屬性",
          "title": "Properties"
        }
      },
      "required": [
        "runs"
      ],
      "title": "SARIFReport",
      "type": "object"
    },
    "AssetExposure": {
      "description": "資產網路暴露度",
      "enum": [
        "internet_facing",
        "dmz",
        "internal_network",
        "isolated"
      ],
      "title": "AssetExposure",
      "type": "string"
    },
    "AssetType": {
      "description": "資產類型",
      "enum": [
        "url",
        "repository",
        "host",
        "container",
        "api_endpoint",
        "mobile_app",
        "web_application",
        "database",
        "api_service"
      ],
      "title": "AssetType",
      "type": "string"
    },
    "BusinessCriticality": {
      "description": "業務重要性等級",
      "enum": [
        "critical",
        "high",
        "medium",
        "low"
      ],
      "title": "BusinessCriticality",
      "type": "string"
    },
    "ComplianceFramework": {
      "description": "合規框架標籤",
      "enum": [
        "pci-dss",
        "hipaa",
        "gdpr",
        "sox",
        "iso27001",
        "nist",
        "cis"
      ],
      "title": "ComplianceFramework",
      "type": "string"
    },
    "DataSensitivity": {
      "description": "資料敏感度等級",
      "enum": [
        "highly_sensitive",
        "sensitive",
        "internal",
        "public"
      ],
      "title": "DataSensitivity",
      "type": "string"
    },
    "Environment": {
      "description": "環境類型",
      "enum": [
        "production",
        "staging",
        "development",
        "testing"
      ],
      "title": "Environment",
      "type": "string"
    },
    "AssetLifecyclePayload": {
      "description": "資產生命週期管理 Payload",
      "properties": {
        "asset_id": {
          "title": "Asset Id",
          "type": "string"
        },
        "asset_type": {
          "$ref": "#/$defs/AssetType"
        },
        "value": {
          "title": "Value",
          "type": "string"
        },
        "environment": {
          "$ref": "#/$defs/Environment"
        },
        "business_criticality": {
          "$ref": "#/$defs/BusinessCriticality"
        },
        "data_sensitivity": {
          "anyOf": [
            {
              "$ref": "#/$defs/DataSensitivity"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "asset_exposure": {
          "anyOf": [
            {
              "$ref": "#/$defs/AssetExposure"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "owner": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Owner"
        },
        "team": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Team"
        },
        "compliance_tags": {
          "items": {
            "$ref": "#/$defs/ComplianceFramework"
          },
          "title": "Compliance Tags",
          "type": "array"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "created_at": {
          "format": "date-time",
          "title": "Created At",
          "type": "string"
        }
      },
      "required": [
        "asset_id",
        "asset_type",
        "value",
        "environment",
        "business_criticality"
      ],
      "title": "AssetLifecyclePayload",
      "type": "object"
    },
    "Exploitability": {
      "description": "漏洞可利用性評估",
      "enum": [
        "proven",
        "high",
        "medium",
        "low",
        "theoretical"
      ],
      "title": "Exploitability",
      "type": "string"
    },
    "VulnerabilityStatus": {
      "description": "漏洞狀態 - 用於漏洞生命週期管理",
      "enum": [
        "new",
        "open",
        "in_progress",
        "fixed",
        "verified",
        "risk_accepted",
        "false_positive",
        "wont_fix",
        "duplicate"
      ],
      "title": "VulnerabilityStatus",
      "type": "string"
    },
    "VulnerabilityLifecyclePayload": {
      "description": "漏洞生命週期管理 Payload",
      "properties": {
        "vulnerability_id": {
          "title": "Vulnerability Id",
          "type": "string"
        },
        "finding_id": {
          "title": "Finding Id",
          "type": "string"
        },
        "asset_id": {
          "title": "Asset Id",
          "type": "string"
        },
        "vulnerability_type": {
          "$ref": "#/$defs/VulnerabilityType"
        },
        "severity": {
          "$ref": "#/$defs/Severity"
        },
        "confidence": {
          "$ref": "#/$defs/Confidence"
        },
        "status": {
          "$ref": "#/$defs/VulnerabilityStatus"
        },
        "exploitability": {
          "anyOf": [
            {
              "$ref": "#/$defs/Exploitability"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "assigned_to": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Assigned To"
        },
        "due_date": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Due Date"
        },
        "first_detected": {
          "format": "date-time",
          "title": "First Detected",
          "type": "string"
        },
        "last_seen": {
          "format": "date-time",
          "title": "Last Seen",
          "type": "string"
        },
        "resolution_date": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Resolution Date"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "vulnerability_id",
        "finding_id",
        "asset_id",
        "vulnerability_type",
        "severity",
        "confidence",
        "status"
      ],
      "title": "VulnerabilityLifecyclePayload",
      "type": "object"
    },
    "VulnerabilityUpdatePayload": {
      "description": "漏洞狀態更新 Payload",
      "properties": {
        "vulnerability_id": {
          "title": "Vulnerability Id",
          "type": "string"
        },
        "status": {
          "$ref": "#/$defs/VulnerabilityStatus"
        },
        "assigned_to": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Assigned To"
        },
        "comment": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Comment"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "updated_by": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Updated By"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "vulnerability_id",
        "status"
      ],
      "title": "VulnerabilityUpdatePayload",
      "type": "object"
    },
    "DiscoveredAsset": {
      "description": "探索到的資產",
      "properties": {
        "asset_id": {
          "title": "Asset Id",
          "type": "string"
        },
        "asset_type": {
          "$ref": "#/$defs/AssetType"
        },
        "value": {
          "title": "Value",
          "type": "string"
        },
        "discovery_method": {
          "title": "Discovery Method",
          "type": "string"
        },
        "confidence": {
          "$ref": "#/$defs/Confidence"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "discovered_at": {
          "format": "date-time",
          "title": "Discovered At",
          "type": "string"
        }
      },
      "required": [
        "asset_id",
        "asset_type",
        "value",
        "discovery_method",
        "confidence"
      ],
      "title": "DiscoveredAsset",
      "type": "object"
    },
    "TechnicalFingerprint": {
      "description": "技術指紋識別",
      "properties": {
        "technology": {
          "description": "技術名稱",
          "title": "Technology",
          "type": "string"
        },
        "version": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "版本信息",
          "title": "Version"
        },
        "confidence": {
          "description": "置信度",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Confidence",
          "type": "number"
        },
        "detection_method": {
          "description": "檢測方法",
          "title": "Detection Method",
          "type": "string"
        },
        "evidence": {
          "description": "檢測證據",
          "items": {
            "type": "string"
          },
          "title": "Evidence",
          "type": "array"
        },
        "category": {
          "description": "技術分類",
          "title": "Category",
          "type": "string"
        },
        "subcategory": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "子分類",
          "title": "Subcategory"
        },
        "known_vulnerabilities": {
          "description": "已知漏洞",
          "items": {
            "type": "string"
          },
          "title": "Known Vulnerabilities",
          "type": "array"
        },
        "eol_status": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "是否已停止支持",
          "title": "Eol Status"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "額外信息",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "technology",
        "confidence",
        "detection_method",
        "category"
      ],
      "title": "TechnicalFingerprint",
      "type": "object"
    },
    "AssetInventoryItem": {
      "description": "資產清單項目",
      "properties": {
        "asset_id": {
          "description": "資產唯一標識",
          "title": "Asset Id",
          "type": "string"
        },
        "asset_type": {
          "description": "資產類型",
          "title": "Asset Type",
          "type": "string"
        },
        "name": {
          "description": "資產名稱",
          "title": "Name",
          "type": "string"
        },
        "ip_address": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "IP地址",
          "title": "Ip Address"
        },
        "hostname": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "主機名",
          "title": "Hostname"
        },
        "domain": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "域名",
          "title": "Domain"
        },
        "ports": {
          "description": "開放端口",
          "items": {
            "type": "integer"
          },
          "title": "Ports",
          "type": "array"
        },
        "fingerprints": {
          "description": "技術指紋",
          "items": {
            "$ref": "#/$defs/TechnicalFingerprint"
          },
          "title": "Fingerprints",
          "type": "array"
        },
        "business_criticality": {
          "description": "業務重要性",
          "title": "Business Criticality",
          "type": "string"
        },
        "owner": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "負責人",
          "title": "Owner"
        },
        "environment": {
          "description": "環境類型",
          "title": "Environment",
          "type": "string"
        },
        "last_scanned": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "最後掃描時間",
          "title": "Last Scanned"
        },
        "vulnerability_count": {
          "description": "漏洞數量",
          "minimum": 0,
          "title": "Vulnerability Count",
          "type": "integer"
        },
        "risk_score": {
          "description": "風險評分",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Risk Score",
          "type": "number"
        },
        "discovered_at": {
          "format": "date-time",
          "title": "Discovered At",
          "type": "string"
        },
        "updated_at": {
          "format": "date-time",
          "title": "Updated At",
          "type": "string"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "asset_id",
        "asset_type",
        "name",
        "business_criticality",
        "environment",
        "vulnerability_count",
        "risk_score"
      ],
      "title": "AssetInventoryItem",
      "type": "object"
    },
    "EASMAsset": {
      "description": "外部攻擊面管理資產",
      "properties": {
        "asset_id": {
          "description": "資產ID",
          "title": "Asset Id",
          "type": "string"
        },
        "asset_type": {
          "description": "資產類型",
          "title": "Asset Type",
          "type": "string"
        },
        "value": {
          "description": "資產值",
          "title": "Value",
          "type": "string"
        },
        "discovery_method": {
          "description": "發現方法",
          "title": "Discovery Method",
          "type": "string"
        },
        "discovery_source": {
          "description": "發現來源",
          "title": "Discovery Source",
          "type": "string"
        },
        "first_discovered": {
          "description": "首次發現時間",
          "format": "date-time",
          "title": "First Discovered",
          "type": "string"
        },
        "last_seen": {
          "description": "最後發現時間",
          "format": "date-time",
          "title": "Last Seen",
          "type": "string"
        },
        "status": {
          "description": "資產狀態",
          "title": "Status",
          "type": "string"
        },
        "confidence": {
          "description": "置信度",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Confidence",
          "type": "number"
        },
        "technologies": {
          "description": "檢測到的技術",
          "items": {
            "type": "string"
          },
          "title": "Technologies",
          "type": "array"
        },
        "services": {
          "description": "運行的服務",
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Services",
          "type": "array"
        },
        "certificates": {
          "description": "SSL證書信息",
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Certificates",
          "type": "array"
        },
        "risk_score": {
          "description": "風險評分",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Risk Score",
          "type": "number"
        },
        "vulnerability_count": {
          "description": "漏洞數量",
          "minimum": 0,
          "title": "Vulnerability Count",
          "type": "integer"
        },
        "exposure_level": {
          "description": "暴露級別",
          "title": "Exposure Level",
          "type": "string"
        },
        "business_unit": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "業務單位",
          "title": "Business Unit"
        },
        "owner": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "負責人",
          "title": "Owner"
        },
        "criticality": {
          "description": "重要性",
          "title": "Criticality",
          "type": "string"
        },
        "compliance_status": {
          "additionalProperties": {
            "type": "boolean"
          },
          "description": "合規狀態",
          "title": "Compliance Status",
          "type": "object"
        },
        "policy_violations": {
          "description": "政策違規",
          "items": {
            "type": "string"
          },
          "title": "Policy Violations",
          "type": "array"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "asset_id",
        "asset_type",
        "value",
        "discovery_method",
        "discovery_source",
        "first_discovered",
        "last_seen",
        "status",
        "confidence",
        "risk_score",
        "vulnerability_count",
        "exposure_level",
        "criticality"
      ],
      "title": "EASMAsset",
      "type": "object"
    },
    "RiskAssessmentContext": {
      "description": "風險評估上下文",
      "properties": {
        "environment": {
          "$ref": "#/$defs/Environment"
        },
        "business_criticality": {
          "$ref": "#/$defs/BusinessCriticality"
        },
        "data_sensitivity": {
          "anyOf": [
            {
              "$ref": "#/$defs/DataSensitivity"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "asset_exposure": {
          "anyOf": [
            {
              "$ref": "#/$defs/AssetExposure"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "compliance_tags": {
          "items": {
            "$ref": "#/$defs/ComplianceFramework"
          },
          "title": "Compliance Tags",
          "type": "array"
        },
        "asset_value": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Asset Value"
        },
        "user_base": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "User Base"
        },
        "sla_hours": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Sla Hours"
        }
      },
      "required": [
        "environment",
        "business_criticality"
      ],
      "title": "RiskAssessmentContext",
      "type": "object"
    },
    "RiskLevel": {
      "description": "風險等級 - 用於風險評估",
      "enum": [
        "critical",
        "high",
        "medium",
        "low",
        "info"
      ],
      "title": "RiskLevel",
      "type": "string"
    },
    "RiskAssessmentResult": {
      "description": "風險評估結果",
      "properties": {
        "finding_id": {
          "title": "Finding Id",
          "type": "string"
        },
        "technical_risk_score": {
          "title": "Technical Risk Score",
          "type": "number"
        },
        "business_risk_score": {
          "title": "Business Risk Score",
          "type": "number"
        },
        "risk_level": {
          "$ref": "#/$defs/RiskLevel"
        },
        "priority_score": {
          "title": "Priority Score",
          "type": "number"
        },
        "context_multiplier": {
          "title": "Context Multiplier",
          "type": "number"
        },
        "business_impact": {
          "additionalProperties": true,
          "title": "Business Impact",
          "type": "object"
        },
        "recommendations": {
          "items": {
            "type": "string"
          },
          "title": "Recommendations",
          "type": "array"
        },
        "estimated_effort": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Estimated Effort"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "finding_id",
        "technical_risk_score",
        "business_risk_score",
        "risk_level",
        "priority_score",
        "context_multiplier"
      ],
      "title": "RiskAssessmentResult",
      "type": "object"
    },
    "RiskTrendAnalysis": {
      "description": "風險趨勢分析",
      "properties": {
        "period_start": {
          "format": "date-time",
          "title": "Period Start",
          "type": "string"
        },
        "period_end": {
          "format": "date-time",
          "title": "Period End",
          "type": "string"
        },
        "total_vulnerabilities": {
          "title": "Total Vulnerabilities",
          "type": "integer"
        },
        "risk_distribution": {
          "additionalProperties": {
            "type": "integer"
          },
          "title": "Risk Distribution",
          "type": "object"
        },
        "average_risk_score": {
          "title": "Average Risk Score",
          "type": "number"
        },
        "trend": {
          "title": "Trend",
          "type": "string"
        },
        "improvement_percentage": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Improvement Percentage"
        },
        "top_risks": {
          "items": {
            "additionalProperties": true,
            "type": "object"
          },
          "title": "Top Risks",
          "type": "array"
        }
      },
      "required": [
        "period_start",
        "period_end",
        "total_vulnerabilities",
        "risk_distribution",
        "average_risk_score",
        "trend"
      ],
      "title": "RiskTrendAnalysis",
      "type": "object"
    },
    "AttackPathNodeType": {
      "description": "攻擊路徑節點類型",
      "enum": [
        "attacker",
        "asset",
        "vulnerability",
        "credential",
        "database",
        "api_endpoint",
        "internal_network"
      ],
      "title": "AttackPathNodeType",
      "type": "string"
    },
    "AttackPathNode": {
      "description": "攻擊路徑節點",
      "properties": {
        "node_id": {
          "title": "Node Id",
          "type": "string"
        },
        "node_type": {
          "$ref": "#/$defs/AttackPathNodeType"
        },
        "name": {
          "title": "Name",
          "type": "string"
        },
        "properties": {
          "type": "object",
          "additionalProperties": true,
          "title": "Properties"
        }
      },
      "required": [
        "node_id",
        "node_type",
        "name"
      ],
      "title": "AttackPathNode",
      "type": "object"
    },
    "AttackPathEdgeType": {
      "description": "攻擊路徑邊類型",
      "enum": [
        "exploits",
        "leads_to",
        "grants_access",
        "exposes",
        "contains",
        "can_access"
      ],
      "title": "AttackPathEdgeType",
      "type": "string"
    },
    "AttackPathEdge": {
      "description": "攻擊路徑邊",
      "properties": {
        "edge_id": {
          "title": "Edge Id",
          "type": "string"
        },
        "source_node_id": {
          "title": "Source Node Id",
          "type": "string"
        },
        "target_node_id": {
          "title": "Target Node Id",
          "type": "string"
        },
        "edge_type": {
          "$ref": "#/$defs/AttackPathEdgeType"
        },
        "risk_score": {
          "default": 0.0,
          "title": "Risk Score",
          "type": "number"
        },
        "properties": {
          "type": "object",
          "additionalProperties": true,
          "title": "Properties"
        }
      },
      "required": [
        "edge_id",
        "source_node_id",
        "target_node_id",
        "edge_type"
      ],
      "title": "AttackPathEdge",
      "type": "object"
    },
    "AttackPathPayload": {
      "description": "攻擊路徑 Payload",
      "properties": {
        "path_id": {
          "title": "Path Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "source_node": {
          "$ref": "#/$defs/AttackPathNode"
        },
        "target_node": {
          "$ref": "#/$defs/AttackPathNode"
        },
        "nodes": {
          "items": {
            "$ref": "#/$defs/AttackPathNode"
          },
          "title": "Nodes",
          "type": "array"
        },
        "edges": {
          "items": {
            "$ref": "#/$defs/AttackPathEdge"
          },
          "title": "Edges",
          "type": "array"
        },
        "total_risk_score": {
          "title": "Total Risk Score",
          "type": "number"
        },
        "path_length": {
          "title": "Path Length",
          "type": "integer"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "path_id",
        "scan_id",
        "source_node",
        "target_node",
        "nodes",
        "edges",
        "total_risk_score",
        "path_length"
      ],
      "title": "AttackPathPayload",
      "type": "object"
    },
    "AttackPathRecommendation": {
      "description": "攻擊路徑推薦",
      "properties": {
        "path_id": {
          "title": "Path Id",
          "type": "string"
        },
        "risk_level": {
          "$ref": "#/$defs/RiskLevel"
        },
        "priority_score": {
          "title": "Priority Score",
          "type": "number"
        },
        "executive_summary": {
          "title": "Executive Summary",
          "type": "string"
        },
        "technical_explanation": {
          "title": "Technical Explanation",
          "type": "string"
        },
        "business_impact": {
          "title": "Business Impact",
          "type": "string"
        },
        "remediation_steps": {
          "items": {
            "type": "string"
          },
          "title": "Remediation Steps",
          "type": "array"
        },
        "quick_wins": {
          "items": {
            "type": "string"
          },
          "title": "Quick Wins",
          "type": "array"
        },
        "affected_assets": {
          "items": {
            "type": "string"
          },
          "title": "Affected Assets",
          "type": "array"
        },
        "estimated_effort": {
          "title": "Estimated Effort",
          "type": "string"
        },
        "estimated_risk_reduction": {
          "title": "Estimated Risk Reduction",
          "type": "number"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "path_id",
        "risk_level",
        "priority_score",
        "executive_summary",
        "technical_explanation",
        "business_impact",
        "remediation_steps",
        "estimated_effort",
        "estimated_risk_reduction"
      ],
      "title": "AttackPathRecommendation",
      "type": "object"
    },
    "EnhancedFindingPayload": {
      "description": "增強版漏洞發現 Payload - 集成所有業界標準\n\n此 Schema 擴展了基礎 FindingPayload，添加了完整的標準支持",
      "properties": {
        "finding_id": {
          "title": "Finding Id",
          "type": "string"
        },
        "task_id": {
          "title": "Task Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "status": {
          "title": "Status",
          "type": "string"
        },
        "vulnerability": {
          "$ref": "#/$defs/EnhancedVulnerability"
        },
        "target": {
          "$ref": "#/$defs/Target"
        },
        "strategy": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Strategy"
        },
        "evidence": {
          "anyOf": [
            {
              "$ref": "#/$defs/FindingEvidence"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "impact": {
          "anyOf": [
            {
              "$ref": "#/$defs/FindingImpact"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "recommendation": {
          "anyOf": [
            {
              "$ref": "#/$defs/FindingRecommendation"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "sarif_result": {
          "anyOf": [
            {
              "$ref": "#/$defs/SARIFResult"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        },
        "created_at": {
          "format": "date-time",
          "title": "Created At",
          "type": "string"
        },
        "updated_at": {
          "format": "date-time",
          "title": "Updated At",
          "type": "string"
        }
      },
      "required": [
        "finding_id",
        "task_id",
        "scan_id",
        "status",
        "vulnerability",
        "target"
      ],
      "title": "EnhancedFindingPayload",
      "type": "object"
    },
    "EnhancedScanScope": {
      "description": "增強掃描範圍定義",
      "properties": {
        "included_hosts": {
          "description": "包含的主機",
          "items": {
            "type": "string"
          },
          "title": "Included Hosts",
          "type": "array"
        },
        "excluded_hosts": {
          "description": "排除的主機",
          "items": {
            "type": "string"
          },
          "title": "Excluded Hosts",
          "type": "array"
        },
        "included_paths": {
          "description": "包含的路徑",
          "items": {
            "type": "string"
          },
          "title": "Included Paths",
          "type": "array"
        },
        "excluded_paths": {
          "description": "排除的路徑",
          "items": {
            "type": "string"
          },
          "title": "Excluded Paths",
          "type": "array"
        },
        "max_depth": {
          "default": 5,
          "description": "最大掃描深度",
          "maximum": 20,
          "minimum": 1,
          "title": "Max Depth",
          "type": "integer"
        }
      },
      "title": "EnhancedScanScope",
      "type": "object"
    },
    "EnhancedScanRequest": {
      "description": "增強掃描請求",
      "properties": {
        "scan_id": {
          "description": "掃描ID",
          "pattern": "^scan_[a-zA-Z0-9_]+$",
          "title": "Scan Id",
          "type": "string"
        },
        "targets": {
          "description": "目標URL列表",
          "items": {
            "format": "uri",
            "maxLength": 2083,
            "minLength": 1,
            "type": "string"
          },
          "minItems": 1,
          "title": "Targets",
          "type": "array"
        },
        "scope": {
          "$ref": "#/$defs/EnhancedScanScope",
          "description": "掃描範圍"
        },
        "strategy": {
          "description": "掃描策略",
          "pattern": "^[a-zA-Z0-9_]+$",
          "title": "Strategy",
          "type": "string"
        },
        "priority": {
          "default": 5,
          "description": "優先級 1-10",
          "maximum": 10,
          "minimum": 1,
          "title": "Priority",
          "type": "integer"
        },
        "max_duration": {
          "default": 3600,
          "description": "最大執行時間(秒)",
          "minimum": 60,
          "title": "Max Duration",
          "type": "integer"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "額外元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "scan_id",
        "targets",
        "scope",
        "strategy"
      ],
      "title": "EnhancedScanRequest",
      "type": "object"
    },
    "EnhancedFunctionTaskTarget": {
      "description": "增強功能測試目標",
      "properties": {
        "url": {
          "description": "目標URL",
          "format": "uri",
          "maxLength": 2083,
          "minLength": 1,
          "title": "Url",
          "type": "string"
        },
        "method": {
          "default": "GET",
          "description": "HTTP方法",
          "title": "Method",
          "type": "string"
        },
        "headers": {
          "additionalProperties": {
            "type": "string"
          },
          "description": "HTTP標頭",
          "title": "Headers",
          "type": "object"
        },
        "cookies": {
          "additionalProperties": {
            "type": "string"
          },
          "description": "Cookie",
          "title": "Cookies",
          "type": "object"
        },
        "parameters": {
          "additionalProperties": {
            "type": "string"
          },
          "description": "參數",
          "title": "Parameters",
          "type": "object"
        },
        "body": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "請求體",
          "title": "Body"
        },
        "auth_required": {
          "default": false,
          "description": "是否需要認證",
          "title": "Auth Required",
          "type": "boolean"
        }
      },
      "required": [
        "url"
      ],
      "title": "EnhancedFunctionTaskTarget",
      "type": "object"
    },
    "EnhancedIOCRecord": {
      "description": "增強威脅指標記錄 (Indicator of Compromise)",
      "properties": {
        "ioc_id": {
          "description": "IOC唯一標識符",
          "title": "Ioc Id",
          "type": "string"
        },
        "ioc_type": {
          "description": "IOC類型",
          "title": "Ioc Type",
          "type": "string"
        },
        "value": {
          "description": "IOC值",
          "title": "Value",
          "type": "string"
        },
        "threat_type": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "威脅類型",
          "title": "Threat Type"
        },
        "malware_family": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "惡意軟體家族",
          "title": "Malware Family"
        },
        "campaign": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "攻擊活動",
          "title": "Campaign"
        },
        "severity": {
          "$ref": "#/$defs/Severity",
          "description": "嚴重程度"
        },
        "confidence": {
          "description": "可信度 0-100",
          "maximum": 100,
          "minimum": 0,
          "title": "Confidence",
          "type": "integer"
        },
        "reputation_score": {
          "description": "聲譽分數",
          "maximum": 100,
          "minimum": 0,
          "title": "Reputation Score",
          "type": "integer"
        },
        "first_seen": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "首次發現時間",
          "title": "First Seen"
        },
        "last_seen": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "最後發現時間",
          "title": "Last Seen"
        },
        "expires_at": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "過期時間",
          "title": "Expires At"
        },
        "tags": {
          "description": "標籤",
          "items": {
            "type": "string"
          },
          "title": "Tags",
          "type": "array"
        },
        "mitre_techniques": {
          "description": "MITRE ATT&CK技術",
          "items": {
            "type": "string"
          },
          "title": "Mitre Techniques",
          "type": "array"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "ioc_id",
        "ioc_type",
        "value",
        "severity",
        "confidence",
        "reputation_score"
      ],
      "title": "EnhancedIOCRecord",
      "type": "object"
    },
    "EnhancedRiskAssessment": {
      "description": "增強風險評估",
      "properties": {
        "assessment_id": {
          "description": "評估ID",
          "title": "Assessment Id",
          "type": "string"
        },
        "target_id": {
          "description": "目標ID",
          "title": "Target Id",
          "type": "string"
        },
        "overall_risk_score": {
          "description": "總體風險評分",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Overall Risk Score",
          "type": "number"
        },
        "likelihood_score": {
          "description": "可能性評分",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Likelihood Score",
          "type": "number"
        },
        "impact_score": {
          "description": "影響評分",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Impact Score",
          "type": "number"
        },
        "risk_level": {
          "$ref": "#/$defs/Severity",
          "description": "風險級別"
        },
        "risk_category": {
          "description": "風險分類",
          "title": "Risk Category",
          "type": "string"
        },
        "risk_factors": {
          "description": "風險因子列表",
          "items": {
            "$ref": "#/$defs/RiskFactor"
          },
          "title": "Risk Factors",
          "type": "array"
        },
        "cvss_metrics": {
          "anyOf": [
            {
              "$ref": "#/$defs/CVSSv3Metrics"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "CVSS評分"
        },
        "business_impact": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "業務影響描述",
          "title": "Business Impact"
        },
        "affected_assets": {
          "description": "受影響資產",
          "items": {
            "type": "string"
          },
          "title": "Affected Assets",
          "type": "array"
        },
        "mitigation_strategies": {
          "description": "緩解策略",
          "items": {
            "type": "string"
          },
          "title": "Mitigation Strategies",
          "type": "array"
        },
        "residual_risk": {
          "description": "殘餘風險",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Residual Risk",
          "type": "number"
        },
        "assessed_at": {
          "format": "date-time",
          "title": "Assessed At",
          "type": "string"
        },
        "valid_until": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "有效期限",
          "title": "Valid Until"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "assessment_id",
        "target_id",
        "overall_risk_score",
        "likelihood_score",
        "impact_score",
        "risk_level",
        "risk_category",
        "risk_factors",
        "residual_risk"
      ],
      "title": "EnhancedRiskAssessment",
      "type": "object"
    },
    "EnhancedAttackPathNode": {
      "description": "增強攻擊路徑節點",
      "properties": {
        "node_id": {
          "description": "節點ID",
          "title": "Node Id",
          "type": "string"
        },
        "node_type": {
          "description": "節點類型",
          "title": "Node Type",
          "type": "string"
        },
        "name": {
          "description": "節點名稱",
          "title": "Name",
          "type": "string"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "節點描述",
          "title": "Description"
        },
        "exploitability": {
          "description": "可利用性",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Exploitability",
          "type": "number"
        },
        "impact": {
          "description": "影響度",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Impact",
          "type": "number"
        },
        "difficulty": {
          "description": "難度",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Difficulty",
          "type": "number"
        },
        "mitre_technique": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "MITRE技術ID",
          "title": "Mitre Technique"
        },
        "mitre_tactic": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "MITRE戰術",
          "title": "Mitre Tactic"
        },
        "prerequisites": {
          "description": "前置條件",
          "items": {
            "type": "string"
          },
          "title": "Prerequisites",
          "type": "array"
        },
        "consequences": {
          "description": "後果",
          "items": {
            "type": "string"
          },
          "title": "Consequences",
          "type": "array"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "node_id",
        "node_type",
        "name",
        "exploitability",
        "impact",
        "difficulty"
      ],
      "title": "EnhancedAttackPathNode",
      "type": "object"
    },
    "EnhancedAttackPath": {
      "description": "增強攻擊路徑",
      "properties": {
        "path_id": {
          "description": "路徑ID",
          "title": "Path Id",
          "type": "string"
        },
        "target_asset": {
          "description": "目標資產",
          "title": "Target Asset",
          "type": "string"
        },
        "nodes": {
          "description": "路徑節點",
          "items": {
            "$ref": "#/$defs/EnhancedAttackPathNode"
          },
          "title": "Nodes",
          "type": "array"
        },
        "edges": {
          "description": "邊關係",
          "items": {
            "additionalProperties": {
              "type": "string"
            },
            "type": "object"
          },
          "title": "Edges",
          "type": "array"
        },
        "path_feasibility": {
          "description": "路徑可行性",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Path Feasibility",
          "type": "number"
        },
        "estimated_time": {
          "description": "估計時間(分鐘)",
          "minimum": 0,
          "title": "Estimated Time",
          "type": "integer"
        },
        "skill_level_required": {
          "description": "所需技能等級",
          "title": "Skill Level Required",
          "type": "string"
        },
        "success_probability": {
          "description": "成功概率",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Success Probability",
          "type": "number"
        },
        "detection_probability": {
          "description": "被檢測概率",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Detection Probability",
          "type": "number"
        },
        "overall_risk": {
          "description": "總體風險",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Overall Risk",
          "type": "number"
        },
        "blocking_controls": {
          "description": "阻斷控制",
          "items": {
            "type": "string"
          },
          "title": "Blocking Controls",
          "type": "array"
        },
        "detection_controls": {
          "description": "檢測控制",
          "items": {
            "type": "string"
          },
          "title": "Detection Controls",
          "type": "array"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "path_id",
        "target_asset",
        "nodes",
        "edges",
        "path_feasibility",
        "estimated_time",
        "skill_level_required",
        "success_probability",
        "detection_probability",
        "overall_risk"
      ],
      "title": "EnhancedAttackPath",
      "type": "object"
    },
    "EnhancedTaskExecution": {
      "description": "增強任務執行",
      "properties": {
        "task_id": {
          "description": "任務ID",
          "title": "Task Id",
          "type": "string"
        },
        "task_type": {
          "description": "任務類型",
          "title": "Task Type",
          "type": "string"
        },
        "module_name": {
          "$ref": "#/$defs/ModuleName",
          "description": "執行模組"
        },
        "priority": {
          "description": "優先級",
          "maximum": 10,
          "minimum": 1,
          "title": "Priority",
          "type": "integer"
        },
        "timeout": {
          "default": 3600,
          "description": "超時時間(秒)",
          "minimum": 60,
          "title": "Timeout",
          "type": "integer"
        },
        "retry_count": {
          "default": 3,
          "description": "重試次數",
          "minimum": 0,
          "title": "Retry Count",
          "type": "integer"
        },
        "dependencies": {
          "description": "任務依賴",
          "items": {
            "$ref": "#/$defs/TaskDependency"
          },
          "title": "Dependencies",
          "type": "array"
        },
        "status": {
          "$ref": "#/$defs/TestStatus",
          "description": "執行狀態"
        },
        "progress": {
          "description": "執行進度",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Progress",
          "type": "number"
        },
        "result_data": {
          "additionalProperties": true,
          "description": "結果數據",
          "title": "Result Data",
          "type": "object"
        },
        "error_message": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "錯誤消息",
          "title": "Error Message"
        },
        "cpu_usage": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "CPU使用率",
          "title": "Cpu Usage"
        },
        "memory_usage": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "內存使用(MB)",
          "title": "Memory Usage"
        },
        "created_at": {
          "format": "date-time",
          "title": "Created At",
          "type": "string"
        },
        "started_at": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "開始時間",
          "title": "Started At"
        },
        "completed_at": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "完成時間",
          "title": "Completed At"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "task_id",
        "task_type",
        "module_name",
        "priority",
        "status",
        "progress"
      ],
      "title": "EnhancedTaskExecution",
      "type": "object"
    },
    "EnhancedVulnerabilityCorrelation": {
      "description": "增強漏洞關聯分析",
      "properties": {
        "correlation_id": {
          "description": "關聯分析ID",
          "title": "Correlation Id",
          "type": "string"
        },
        "primary_vulnerability": {
          "description": "主要漏洞ID",
          "title": "Primary Vulnerability",
          "type": "string"
        },
        "related_vulnerabilities": {
          "description": "相關漏洞列表",
          "items": {
            "type": "string"
          },
          "title": "Related Vulnerabilities",
          "type": "array"
        },
        "correlation_strength": {
          "description": "關聯強度",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Correlation Strength",
          "type": "number"
        },
        "correlation_type": {
          "description": "關聯類型",
          "title": "Correlation Type",
          "type": "string"
        },
        "combined_risk_score": {
          "description": "組合風險評分",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Combined Risk Score",
          "type": "number"
        },
        "exploitation_complexity": {
          "description": "利用複雜度",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Exploitation Complexity",
          "type": "number"
        },
        "attack_scenarios": {
          "description": "攻擊場景",
          "items": {
            "type": "string"
          },
          "title": "Attack Scenarios",
          "type": "array"
        },
        "recommended_order": {
          "description": "建議利用順序",
          "items": {
            "type": "string"
          },
          "title": "Recommended Order",
          "type": "array"
        },
        "coordinated_mitigation": {
          "description": "協調緩解措施",
          "items": {
            "type": "string"
          },
          "title": "Coordinated Mitigation",
          "type": "array"
        },
        "priority_ranking": {
          "description": "優先級排序",
          "items": {
            "type": "string"
          },
          "title": "Priority Ranking",
          "type": "array"
        },
        "analyzed_at": {
          "format": "date-time",
          "title": "Analyzed At",
          "type": "string"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "correlation_id",
        "primary_vulnerability",
        "related_vulnerabilities",
        "correlation_strength",
        "correlation_type",
        "combined_risk_score",
        "exploitation_complexity"
      ],
      "title": "EnhancedVulnerabilityCorrelation",
      "type": "object"
    },
    "SessionState": {
      "description": "會話狀態 - 多步驟攻擊鏈的會話管理",
      "properties": {
        "session_id": {
          "title": "Session Id",
          "type": "string"
        },
        "plan_id": {
          "title": "Plan Id",
          "type": "string"
        },
        "scan_id": {
          "title": "Scan Id",
          "type": "string"
        },
        "status": {
          "title": "Status",
          "type": "string"
        },
        "current_step_index": {
          "default": 0,
          "title": "Current Step Index",
          "type": "integer"
        },
        "completed_steps": {
          "items": {
            "type": "string"
          },
          "title": "Completed Steps",
          "type": "array"
        },
        "pending_steps": {
          "items": {
            "type": "string"
          },
          "title": "Pending Steps",
          "type": "array"
        },
        "context": {
          "additionalProperties": true,
          "title": "Context",
          "type": "object"
        },
        "variables": {
          "additionalProperties": true,
          "title": "Variables",
          "type": "object"
        },
        "started_at": {
          "format": "date-time",
          "title": "Started At",
          "type": "string"
        },
        "updated_at": {
          "format": "date-time",
          "title": "Updated At",
          "type": "string"
        },
        "timeout_at": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Timeout At"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "session_id",
        "plan_id",
        "scan_id",
        "status"
      ],
      "title": "SessionState",
      "type": "object"
    },
    "ModelTrainingResult": {
      "description": "模型訓練結果",
      "properties": {
        "training_id": {
          "title": "Training Id",
          "type": "string"
        },
        "config": {
          "additionalProperties": true,
          "title": "Config",
          "type": "object"
        },
        "model_version": {
          "title": "Model Version",
          "type": "string"
        },
        "training_samples": {
          "title": "Training Samples",
          "type": "integer"
        },
        "validation_samples": {
          "title": "Validation Samples",
          "type": "integer"
        },
        "training_loss": {
          "title": "Training Loss",
          "type": "number"
        },
        "validation_loss": {
          "title": "Validation Loss",
          "type": "number"
        },
        "accuracy": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Accuracy"
        },
        "precision": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Precision"
        },
        "recall": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Recall"
        },
        "f1_score": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "F1 Score"
        },
        "average_reward": {
          "anyOf": [
            {
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Average Reward"
        },
        "training_duration_seconds": {
          "default": 0.0,
          "title": "Training Duration Seconds",
          "type": "number"
        },
        "started_at": {
          "format": "date-time",
          "title": "Started At",
          "type": "string"
        },
        "completed_at": {
          "format": "date-time",
          "title": "Completed At",
          "type": "string"
        },
        "metrics": {
          "additionalProperties": true,
          "title": "Metrics",
          "type": "object"
        },
        "model_path": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Model Path"
        },
        "metadata": {
          "additionalProperties": true,
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "training_id",
        "config",
        "model_version",
        "training_samples",
        "validation_samples",
        "training_loss",
        "validation_loss"
      ],
      "title": "ModelTrainingResult",
      "type": "object"
    },
    "TaskQueue": {
      "description": "任務隊列",
      "properties": {
        "queue_id": {
          "description": "隊列ID",
          "title": "Queue Id",
          "type": "string"
        },
        "queue_name": {
          "description": "隊列名稱",
          "title": "Queue Name",
          "type": "string"
        },
        "max_concurrent_tasks": {
          "default": 5,
          "description": "最大併發任務數",
          "minimum": 1,
          "title": "Max Concurrent Tasks",
          "type": "integer"
        },
        "task_timeout": {
          "default": 3600,
          "description": "任務超時(秒)",
          "minimum": 60,
          "title": "Task Timeout",
          "type": "integer"
        },
        "pending_tasks": {
          "description": "等待任務",
          "items": {
            "type": "string"
          },
          "title": "Pending Tasks",
          "type": "array"
        },
        "running_tasks": {
          "description": "運行任務",
          "items": {
            "type": "string"
          },
          "title": "Running Tasks",
          "type": "array"
        },
        "completed_tasks": {
          "description": "完成任務",
          "items": {
            "type": "string"
          },
          "title": "Completed Tasks",
          "type": "array"
        },
        "total_processed": {
          "description": "總處理數",
          "minimum": 0,
          "title": "Total Processed",
          "type": "integer"
        },
        "success_rate": {
          "description": "成功率",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Success Rate",
          "type": "number"
        },
        "average_execution_time": {
          "description": "平均執行時間",
          "minimum": 0.0,
          "title": "Average Execution Time",
          "type": "number"
        },
        "created_at": {
          "format": "date-time",
          "title": "Created At",
          "type": "string"
        },
        "last_activity": {
          "format": "date-time",
          "title": "Last Activity",
          "type": "string"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "queue_id",
        "queue_name",
        "total_processed",
        "success_rate",
        "average_execution_time"
      ],
      "title": "TaskQueue",
      "type": "object"
    },
    "EnhancedModuleStatus": {
      "description": "增強模組狀態",
      "properties": {
        "module_name": {
          "$ref": "#/$defs/ModuleName",
          "description": "模組名稱"
        },
        "version": {
          "description": "模組版本",
          "title": "Version",
          "type": "string"
        },
        "status": {
          "description": "運行狀態",
          "title": "Status",
          "type": "string"
        },
        "health_score": {
          "description": "健康評分",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Health Score",
          "type": "number"
        },
        "cpu_usage": {
          "description": "CPU使用率",
          "maximum": 100.0,
          "minimum": 0.0,
          "title": "Cpu Usage",
          "type": "number"
        },
        "memory_usage": {
          "description": "內存使用(MB)",
          "minimum": 0.0,
          "title": "Memory Usage",
          "type": "number"
        },
        "active_connections": {
          "description": "活躍連接數",
          "minimum": 0,
          "title": "Active Connections",
          "type": "integer"
        },
        "tasks_processed": {
          "description": "處理任務數",
          "minimum": 0,
          "title": "Tasks Processed",
          "type": "integer"
        },
        "tasks_pending": {
          "description": "待處理任務數",
          "minimum": 0,
          "title": "Tasks Pending",
          "type": "integer"
        },
        "error_count": {
          "description": "錯誤次數",
          "minimum": 0,
          "title": "Error Count",
          "type": "integer"
        },
        "started_at": {
          "description": "啟動時間",
          "format": "date-time",
          "title": "Started At",
          "type": "string"
        },
        "last_heartbeat": {
          "description": "最後心跳",
          "format": "date-time",
          "title": "Last Heartbeat",
          "type": "string"
        },
        "uptime_seconds": {
          "description": "運行時間(秒)",
          "minimum": 0,
          "title": "Uptime Seconds",
          "type": "integer"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "module_name",
        "version",
        "status",
        "health_score",
        "cpu_usage",
        "memory_usage",
        "active_connections",
        "tasks_processed",
        "tasks_pending",
        "error_count",
        "started_at",
        "last_heartbeat",
        "uptime_seconds"
      ],
      "title": "EnhancedModuleStatus",
      "type": "object"
    },
    "SystemOrchestration": {
      "description": "系統編排",
      "properties": {
        "orchestration_id": {
          "description": "編排ID",
          "title": "Orchestration Id",
          "type": "string"
        },
        "orchestration_name": {
          "description": "編排名稱",
          "title": "Orchestration Name",
          "type": "string"
        },
        "module_statuses": {
          "description": "模組狀態列表",
          "items": {
            "$ref": "#/$defs/EnhancedModuleStatus"
          },
          "title": "Module Statuses",
          "type": "array"
        },
        "scan_configuration": {
          "additionalProperties": true,
          "description": "掃描配置",
          "title": "Scan Configuration",
          "type": "object"
        },
        "resource_allocation": {
          "additionalProperties": true,
          "description": "資源分配",
          "title": "Resource Allocation",
          "type": "object"
        },
        "overall_status": {
          "description": "整體狀態",
          "title": "Overall Status",
          "type": "string"
        },
        "active_scans": {
          "description": "活躍掃描數",
          "minimum": 0,
          "title": "Active Scans",
          "type": "integer"
        },
        "queued_tasks": {
          "description": "排隊任務數",
          "minimum": 0,
          "title": "Queued Tasks",
          "type": "integer"
        },
        "system_cpu": {
          "description": "系統CPU",
          "maximum": 100.0,
          "minimum": 0.0,
          "title": "System Cpu",
          "type": "number"
        },
        "system_memory": {
          "description": "系統內存(MB)",
          "minimum": 0.0,
          "title": "System Memory",
          "type": "number"
        },
        "network_throughput": {
          "description": "網絡吞吐量(Mbps)",
          "minimum": 0.0,
          "title": "Network Throughput",
          "type": "number"
        },
        "created_at": {
          "format": "date-time",
          "title": "Created At",
          "type": "string"
        },
        "updated_at": {
          "format": "date-time",
          "title": "Updated At",
          "type": "string"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "orchestration_id",
        "orchestration_name",
        "module_statuses",
        "overall_status",
        "active_scans",
        "queued_tasks",
        "system_cpu",
        "system_memory",
        "network_throughput"
      ],
      "title": "SystemOrchestration",
      "type": "object"
    },
    "WebhookPayload": {
      "description": "Webhook載荷",
      "properties": {
        "webhook_id": {
          "description": "Webhook ID",
          "title": "Webhook Id",
          "type": "string"
        },
        "event_type": {
          "description": "事件類型",
          "title": "Event Type",
          "type": "string"
        },
        "source": {
          "description": "來源系統",
          "title": "Source",
          "type": "string"
        },
        "timestamp": {
          "format": "date-time",
          "title": "Timestamp",
          "type": "string"
        },
        "data": {
          "additionalProperties": true,
          "description": "事件數據",
          "title": "Data",
          "type": "object"
        },
        "delivery_url": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "交付URL",
          "title": "Delivery Url"
        },
        "retry_count": {
          "default": 0,
          "description": "重試次數",
          "minimum": 0,
          "title": "Retry Count",
          "type": "integer"
        },
        "max_retries": {
          "default": 3,
          "description": "最大重試次數",
          "minimum": 0,
          "title": "Max Retries",
          "type": "integer"
        },
        "status": {
          "default": "pending",
          "description": "狀態",
          "title": "Status",
          "type": "string"
        },
        "delivered_at": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "交付時間",
          "title": "Delivered At"
        },
        "error_message": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "錯誤消息",
          "title": "Error Message"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "webhook_id",
        "event_type",
        "source"
      ],
      "title": "WebhookPayload",
      "type": "object"
    },
    "CVEReference": {
      "description": "CVE 參考資訊\n\n符合標準: CVE Numbering Authority (https://www.cve.org/)",
      "properties": {
        "cve_id": {
          "description": "CVE ID (格式: CVE-YYYY-NNNNN)",
          "pattern": "^CVE-\\d{4}-\\d{4,}$",
          "title": "Cve Id",
          "type": "string"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "cvss_score": {
          "anyOf": [
            {
              "maximum": 10.0,
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Cvss Score"
        },
        "cvss_vector": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Cvss Vector"
        },
        "references": {
          "items": {
            "type": "string"
          },
          "title": "References",
          "type": "array"
        },
        "published_date": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Published Date"
        },
        "last_modified_date": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Last Modified Date"
        }
      },
      "required": [
        "cve_id"
      ],
      "title": "CVEReference",
      "type": "object"
    },
    "CWEReference": {
      "description": "CWE 參考資訊\n\n符合標準: Common Weakness Enumeration (https://cwe.mitre.org/)",
      "properties": {
        "cwe_id": {
          "description": "CWE ID (格式: CWE-XXX)",
          "pattern": "^CWE-\\d+$",
          "title": "Cwe Id",
          "type": "string"
        },
        "name": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Name"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "weakness_category": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Weakness Category"
        },
        "likelihood_of_exploit": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Likelihood Of Exploit"
        }
      },
      "required": [
        "cwe_id"
      ],
      "title": "CWEReference",
      "type": "object"
    },
    "VulnerabilityDiscovery": {
      "description": "漏洞發現記錄",
      "properties": {
        "discovery_id": {
          "description": "發現ID",
          "title": "Discovery Id",
          "type": "string"
        },
        "vulnerability_id": {
          "description": "漏洞ID",
          "title": "Vulnerability Id",
          "type": "string"
        },
        "asset_id": {
          "description": "相關資產ID",
          "title": "Asset Id",
          "type": "string"
        },
        "title": {
          "description": "漏洞標題",
          "title": "Title",
          "type": "string"
        },
        "description": {
          "description": "漏洞描述",
          "title": "Description",
          "type": "string"
        },
        "severity": {
          "$ref": "#/$defs/Severity",
          "description": "嚴重程度"
        },
        "confidence": {
          "$ref": "#/$defs/Confidence",
          "description": "置信度"
        },
        "vulnerability_type": {
          "description": "漏洞類型",
          "title": "Vulnerability Type",
          "type": "string"
        },
        "affected_component": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "受影響組件",
          "title": "Affected Component"
        },
        "attack_vector": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "攻擊向量",
          "title": "Attack Vector"
        },
        "detection_method": {
          "description": "檢測方法",
          "title": "Detection Method",
          "type": "string"
        },
        "scanner_name": {
          "description": "掃描器名稱",
          "title": "Scanner Name",
          "type": "string"
        },
        "scan_rule_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "掃描規則ID",
          "title": "Scan Rule Id"
        },
        "evidence": {
          "description": "漏洞證據",
          "items": {
            "type": "string"
          },
          "title": "Evidence",
          "type": "array"
        },
        "proof_of_concept": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "概念驗證",
          "title": "Proof Of Concept"
        },
        "false_positive_likelihood": {
          "description": "誤報可能性",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "False Positive Likelihood",
          "type": "number"
        },
        "impact_assessment": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "影響評估",
          "title": "Impact Assessment"
        },
        "exploitability": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "可利用性",
          "title": "Exploitability"
        },
        "remediation_advice": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "修復建議",
          "title": "Remediation Advice"
        },
        "remediation_priority": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "修復優先級",
          "title": "Remediation Priority"
        },
        "cve_ids": {
          "description": "CVE標識符",
          "items": {
            "type": "string"
          },
          "title": "Cve Ids",
          "type": "array"
        },
        "cwe_ids": {
          "description": "CWE標識符",
          "items": {
            "type": "string"
          },
          "title": "Cwe Ids",
          "type": "array"
        },
        "cvss_score": {
          "anyOf": [
            {
              "maximum": 10.0,
              "minimum": 0.0,
              "type": "number"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "CVSS評分",
          "title": "Cvss Score"
        },
        "discovered_at": {
          "format": "date-time",
          "title": "Discovered At",
          "type": "string"
        },
        "metadata": {
          "additionalProperties": true,
          "description": "元數據",
          "title": "Metadata",
          "type": "object"
        }
      },
      "required": [
        "discovery_id",
        "vulnerability_id",
        "asset_id",
        "title",
        "description",
        "severity",
        "confidence",
        "vulnerability_type",
        "detection_method",
        "scanner_name",
        "false_positive_likelihood"
      ],
      "title": "VulnerabilityDiscovery",
      "type": "object"
    },
    "LanguageFramework": {
      "description": "程式語言框架枚舉",
      "enum": [
        "react",
        "vue",
        "angular",
        "nodejs",
        "express",
        "nextjs",
        "nuxtjs",
        "django",
        "flask",
        "fastapi",
        "tornado",
        "gin",
        "echo",
        "fiber",
        "beego",
        "actix_web",
        "warp",
        "rocket",
        "axum",
        "spring",
        "spring_boot",
        "struts",
        "dotnet",
        "aspnet",
        "unknown"
      ],
      "title": "LanguageFramework",
      "type": "string"
    },
    "ProgrammingLanguage": {
      "description": "程式語言枚舉",
      "enum": [
        "rust",
        "go",
        "c",
        "cpp",
        "csharp",
        "python",
        "javascript",
        "typescript",
        "ruby",
        "php",
        "java",
        "kotlin",
        "scala",
        "haskell",
        "erlang",
        "elixir",
        "html",
        "css",
        "sass",
        "less",
        "sql",
        "graphql",
        "yaml",
        "json",
        "toml",
        "xml",
        "bash",
        "powershell",
        "zsh",
        "unknown"
      ],
      "title": "ProgrammingLanguage",
      "type": "string"
    },
    "LanguageDetectionResult": {
      "description": "程式語言檢測結果",
      "properties": {
        "primary_language": {
          "$ref": "#/$defs/ProgrammingLanguage",
          "description": "主要程式語言"
        },
        "confidence": {
          "description": "檢測信心度",
          "maximum": 1.0,
          "minimum": 0.0,
          "title": "Confidence",
          "type": "number"
        },
        "secondary_languages": {
          "description": "次要程式語言",
          "items": {
            "$ref": "#/$defs/ProgrammingLanguage"
          },
          "title": "Secondary Languages",
          "type": "array"
        },
        "frameworks": {
          "description": "檢測到的框架",
          "items": {
            "$ref": "#/$defs/LanguageFramework"
          },
          "title": "Frameworks",
          "type": "array"
        },
        "file_extensions": {
          "description": "檔案副檔名",
          "items": {
            "type": "string"
          },
          "title": "File Extensions",
          "type": "array"
        },
        "lines_of_code": {
          "description": "程式碼行數",
          "minimum": 0,
          "title": "Lines Of Code",
          "type": "integer"
        }
      },
      "required": [
        "primary_language",
        "confidence",
        "lines_of_code"
      ],
      "title": "LanguageDetectionResult",
      "type": "object"
    },
    "VulnerabilityByLanguage": {
      "description": "按程式語言分類的漏洞類型",
      "enum": [
        "buffer_overflow",
        "use_after_free",
        "memory_leak",
        "null_pointer_dereference",
        "type_confusion",
        "prototype_pollution",
        "race_condition",
        "deadlock",
        "data_race",
        "deserialization",
        "pickle_injection",
        "code_injection",
        "eval_injection",
        "template_injection",
        "sql_injection",
        "xss",
        "xxe",
        "ldap_injection",
        "dependency_confusion",
        "supply_chain",
        "misconfiguration"
      ],
      "title": "VulnerabilityByLanguage",
      "type": "string"
    },
    "LanguageSpecificVulnerability": {
      "description": "特定程式語言的漏洞",
      "properties": {
        "language": {
          "$ref": "#/$defs/ProgrammingLanguage",
          "description": "程式語言"
        },
        "vulnerability_type": {
          "$ref": "#/$defs/VulnerabilityByLanguage",
          "description": "漏洞類型"
        },
        "severity": {
          "$ref": "#/$defs/Severity",
          "description": "嚴重程度"
        },
        "description": {
          "description": "漏洞描述",
          "title": "Description",
          "type": "string"
        },
        "code_snippet": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "問題程式碼片段",
          "title": "Code Snippet"
        },
        "line_number": {
          "anyOf": [
            {
              "minimum": 1,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "行號",
          "title": "Line Number"
        },
        "file_path": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "檔案路徑",
          "title": "File Path"
        },
        "function_name": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "函數名稱",
          "title": "Function Name"
        },
        "remediation": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "修復建議",
          "title": "Remediation"
        },
        "cwe_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "CWE ID",
          "title": "Cwe Id"
        },
        "owasp_category": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "OWASP 分類",
          "title": "Owasp Category"
        }
      },
      "required": [
        "language",
        "vulnerability_type",
        "severity",
        "description"
      ],
      "title": "LanguageSpecificVulnerability",
      "type": "object"
    },
    "MultiLanguageCodebase": {
      "description": "多語言程式碼庫分析",
      "properties": {
        "project_name": {
          "description": "專案名稱",
          "title": "Project Name",
          "type": "string"
        },
        "languages": {
          "additionalProperties": {
            "type": "integer"
          },
          "description": "語言分布（語言：程式碼行數）",
          "propertyNames": {
            "$ref": "#/$defs/ProgrammingLanguage"
          },
          "title": "Languages",
          "type": "object"
        },
        "primary_language": {
          "$ref": "#/$defs/ProgrammingLanguage",
          "description": "主要程式語言"
        },
        "frameworks": {
          "description": "使用的框架",
          "items": {
            "$ref": "#/$defs/LanguageFramework"
          },
          "title": "Frameworks",
          "type": "array"
        },
        "total_files": {
          "description": "總檔案數",
          "minimum": 0,
          "title": "Total Files",
          "type": "integer"
        },
        "total_lines": {
          "description": "總程式碼行數",
          "minimum": 0,
          "title": "Total Lines",
          "type": "integer"
        },
        "vulnerability_distribution": {
          "additionalProperties": {
            "type": "integer"
          },
          "description": "各語言漏洞分布",
          "propertyNames": {
            "$ref": "#/$defs/ProgrammingLanguage"
          },
          "title": "Vulnerability Distribution",
          "type": "object"
        },
        "dependencies": {
          "additionalProperties": {
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "description": "依賴套件（語言：套件列表）",
          "title": "Dependencies",
          "type": "object"
        }
      },
      "required": [
        "project_name",
        "languages",
        "primary_language",
        "total_files",
        "total_lines"
      ],
      "title": "MultiLanguageCodebase",
      "type": "object"
    },
    "CodeQualityMetric": {
      "description": "程式碼品質指標",
      "enum": [
        "cyclomatic_complexity",
        "cognitive_complexity",
        "halstead_complexity",
        "line_coverage",
        "branch_coverage",
        "function_coverage",
        "code_duplication",
        "clone_detection",
        "maintainability_index",
        "technical_debt",
        "execution_time",
        "memory_usage",
        "cpu_usage"
      ],
      "title": "CodeQualityMetric",
      "type": "string"
    },
    "SecurityPattern": {
      "description": "安全模式枚舉 - 針對不同程式語言的安全實踐",
      "enum": [
        "input_validation",
        "sanitization",
        "encoding",
        "authentication",
        "authorization",
        "jwt_validation",
        "encryption",
        "hashing",
        "digital_signature",
        "secure_random",
        "safe_deserialization",
        "bounds_checking",
        "thread_safety",
        "atomic_operations",
        "lock_free",
        "error_handling",
        "fail_secure",
        "logging"
      ],
      "title": "SecurityPattern",
      "type": "string"
    },
    "LanguageSpecificScanConfig": {
      "description": "特定程式語言的掃描配置",
      "properties": {
        "language": {
          "$ref": "#/$defs/ProgrammingLanguage",
          "description": "目標程式語言"
        },
        "scan_patterns": {
          "description": "要檢查的安全模式",
          "items": {
            "$ref": "#/$defs/SecurityPattern"
          },
          "title": "Scan Patterns",
          "type": "array"
        },
        "quality_metrics": {
          "description": "程式碼品質指標",
          "items": {
            "$ref": "#/$defs/CodeQualityMetric"
          },
          "title": "Quality Metrics",
          "type": "array"
        },
        "exclude_paths": {
          "description": "排除路徑",
          "items": {
            "type": "string"
          },
          "title": "Exclude Paths",
          "type": "array"
        },
        "include_patterns": {
          "description": "包含檔案模式",
          "items": {
            "type": "string"
          },
          "title": "Include Patterns",
          "type": "array"
        },
        "custom_rules": {
          "description": "自訂規則",
          "items": {
            "type": "string"
          },
          "title": "Custom Rules",
          "type": "array"
        },
        "max_file_size": {
          "default": 1048576,
          "description": "最大檔案大小（bytes）",
          "title": "Max File Size",
          "type": "integer"
        },
        "timeout_seconds": {
          "default": 300,
          "description": "掃描超時時間（秒）",
          "title": "Timeout Seconds",
          "type": "integer"
        }
      },
      "required": [
        "language",
        "scan_patterns"
      ],
      "title": "LanguageSpecificScanConfig",
      "type": "object"
    },
    "CrossLanguageAnalysis": {
      "description": "跨語言分析結果",
      "properties": {
        "analysis_id": {
          "description": "分析ID",
          "title": "Analysis Id",
          "type": "string"
        },
        "project_name": {
          "description": "專案名稱",
          "title": "Project Name",
          "type": "string"
        },
        "languages_analyzed": {
          "description": "分析的語言",
          "items": {
            "$ref": "#/$defs/ProgrammingLanguage"
          },
          "title": "Languages Analyzed",
          "type": "array"
        },
        "cross_language_issues": {
          "description": "跨語言問題",
          "items": {
            "type": "string"
          },
          "title": "Cross Language Issues",
          "type": "array"
        },
        "integration_points": {
          "description": "語言整合點",
          "items": {
            "type": "string"
          },
          "title": "Integration Points",
          "type": "array"
        },
        "security_boundaries": {
          "description": "安全邊界",
          "items": {
            "type": "string"
          },
          "title": "Security Boundaries",
          "type": "array"
        },
        "data_flow_risks": {
          "description": "資料流風險",
          "items": {
            "type": "string"
          },
          "title": "Data Flow Risks",
          "type": "array"
        },
        "recommendations": {
          "description": "建議",
          "items": {
            "type": "string"
          },
          "title": "Recommendations",
          "type": "array"
        },
        "risk_score": {
          "description": "風險評分",
          "maximum": 10.0,
          "minimum": 0.0,
          "title": "Risk Score",
          "type": "number"
        }
      },
      "required": [
        "analysis_id",
        "project_name",
        "languages_analyzed",
        "risk_score"
      ],
      "title": "CrossLanguageAnalysis",
      "type": "object"
    },
    "LanguageSpecificPayload": {
      "description": "特定程式語言的測試載荷",
      "properties": {
        "language": {
          "$ref": "#/$defs/ProgrammingLanguage",
          "description": "目標程式語言"
        },
        "payload_type": {
          "description": "載荷類型",
          "title": "Payload Type",
          "type": "string"
        },
        "payload_content": {
          "description": "載荷內容",
          "title": "Payload Content",
          "type": "string"
        },
        "encoding": {
          "default": "utf-8",
          "description": "編碼方式",
          "title": "Encoding",
          "type": "string"
        },
        "expected_behavior": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "預期行為",
          "title": "Expected Behavior"
        },
        "bypass_techniques": {
          "description": "繞過技術",
          "items": {
            "type": "string"
          },
          "title": "Bypass Techniques",
          "type": "array"
        },
        "target_functions": {
          "description": "目標函數",
          "items": {
            "type": "string"
          },
          "title": "Target Functions",
          "type": "array"
        },
        "success_indicators": {
          "description": "成功指標",
          "items": {
            "type": "string"
          },
          "title": "Success Indicators",
          "type": "array"
        }
      },
      "required": [
        "language",
        "payload_type",
        "payload_content"
      ],
      "title": "LanguageSpecificPayload",
      "type": "object"
    },
    "AILanguageModel": {
      "description": "AI 程式語言模型配置",
      "properties": {
        "model_name": {
          "description": "模型名稱",
          "title": "Model Name",
          "type": "string"
        },
        "supported_languages": {
          "description": "支援的語言",
          "items": {
            "$ref": "#/$defs/ProgrammingLanguage"
          },
          "title": "Supported Languages",
          "type": "array"
        },
        "model_type": {
          "description": "模型類型",
          "title": "Model Type",
          "type": "string"
        },
        "version": {
          "description": "模型版本",
          "title": "Version",
          "type": "string"
        },
        "capabilities": {
          "description": "能力列表",
          "items": {
            "type": "string"
          },
          "title": "Capabilities",
          "type": "array"
        },
        "training_data_size": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "訓練資料大小",
          "title": "Training Data Size"
        },
        "accuracy_metrics": {
          "additionalProperties": {
            "type": "number"
          },
          "description": "精確度指標",
          "title": "Accuracy Metrics",
          "type": "object"
        },
        "api_endpoint": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "API 端點",
          "title": "Api Endpoint"
        },
        "authentication_required": {
          "default": true,
          "description": "是否需要認證",
          "title": "Authentication Required",
          "type": "boolean"
        }
      },
      "required": [
        "model_name",
        "supported_languages",
        "model_type",
        "version",
        "capabilities"
      ],
      "title": "AILanguageModel",
      "type": "object"
    },
    "CodeQualityReport": {
      "description": "程式碼品質報告",
      "properties": {
        "language": {
          "$ref": "#/$defs/ProgrammingLanguage",
          "description": "程式語言"
        },
        "file_path": {
          "description": "檔案路徑",
          "title": "File Path",
          "type": "string"
        },
        "metrics": {
          "additionalProperties": {
            "type": "number"
          },
          "description": "品質指標",
          "propertyNames": {
            "$ref": "#/$defs/CodeQualityMetric"
          },
          "title": "Metrics",
          "type": "object"
        },
        "issues": {
          "description": "發現的問題",
          "items": {
            "type": "string"
          },
          "title": "Issues",
          "type": "array"
        },
        "suggestions": {
          "description": "改進建議",
          "items": {
            "type": "string"
          },
          "title": "Suggestions",
          "type": "array"
        },
        "overall_score": {
          "description": "整體評分",
          "maximum": 100.0,
          "minimum": 0.0,
          "title": "Overall Score",
          "type": "number"
        },
        "timestamp": {
          "description": "分析時間",
          "title": "Timestamp",
          "type": "string"
        }
      },
      "required": [
        "language",
        "file_path",
        "metrics",
        "overall_score",
        "timestamp"
      ],
      "title": "CodeQualityReport",
      "type": "object"
    },
    "LanguageInteroperability": {
      "description": "語言互操作性分析",
      "properties": {
        "source_language": {
          "$ref": "#/$defs/ProgrammingLanguage",
          "description": "來源語言"
        },
        "target_language": {
          "$ref": "#/$defs/ProgrammingLanguage",
          "description": "目標語言"
        },
        "interop_method": {
          "description": "互操作方法",
          "title": "Interop Method",
          "type": "string"
        },
        "security_considerations": {
          "description": "安全考量",
          "items": {
            "type": "string"
          },
          "title": "Security Considerations",
          "type": "array"
        },
        "performance_impact": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "效能影響",
          "title": "Performance Impact"
        },
        "compatibility_issues": {
          "description": "相容性問題",
          "items": {
            "type": "string"
          },
          "title": "Compatibility Issues",
          "type": "array"
        },
        "recommendations": {
          "description": "建議",
          "items": {
            "type": "string"
          },
          "title": "Recommendations",
          "type": "array"
        }
      },
      "required": [
        "source_language",
        "target_language",
        "interop_method"
      ],
      "title": "LanguageInteroperability",
      "type": "object"
    }
  }
}