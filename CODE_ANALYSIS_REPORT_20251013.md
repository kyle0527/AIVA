# AIVA å°ˆæ¡ˆç¨‹å¼ç¢¼åˆ†æå ±å‘Š

**ç”Ÿæˆæ™‚é–“**: 2025-10-13 12:16:23
**åˆ†æå·¥å…·**: `tools/analyze_codebase.py`
**åˆ†æç¯„åœ**: æ•´å€‹ AIVA å°ˆæ¡ˆ

---

## ğŸ“Š åŸ·è¡Œæ‘˜è¦

### æ•´é«”çµ±è¨ˆ

| æŒ‡æ¨™ | æ•¸å€¼ |
|------|------|
| **ç¸½æª”æ¡ˆæ•¸** | 155 |
| **ç¸½ç¨‹å¼ç¢¼è¡Œæ•¸** | 27,015 è¡Œ |
| **ç¨‹å¼ç¢¼è¡Œ** | 22,435 è¡Œ (83.0%) |
| **è¨»è§£è¡Œ** | 2,590 è¡Œ (9.6%) |
| **ç©ºç™½è¡Œ** | 4,580 è¡Œ (16.9%) |
| **ç¸½å‡½æ•¸æ•¸** | 704 |
| **ç¸½é¡åˆ¥æ•¸** | 299 |
| **ç¸½å°å…¥æ•¸** | 803 |
| **å¹³å‡è¤‡é›œåº¦** | 11.94 |

### ç¨‹å¼ç¢¼å“è³ªæŒ‡æ¨™

| æŒ‡æ¨™ | è¦†è“‹ç‡ | ç‹€æ…‹ |
|------|--------|------|
| **é¡å‹æç¤ºè¦†è“‹ç‡** | 74.8% (116/155) | âš ï¸ éœ€æ”¹é€² |
| **æ–‡æª”å­—ä¸²è¦†è“‹ç‡** | 81.9% (127/155) | âœ… è‰¯å¥½ |

### ç·¨ç¢¼ç›¸å®¹æ€§

| æŒ‡æ¨™ | çµæœ |
|------|------|
| **æª¢æŸ¥æª”æ¡ˆæ•¸** | 157 |
| **CP950 ä¸ç›¸å®¹å•é¡Œ** | 0 |
| **ç‹€æ…‹** | âœ… å…¨éƒ¨é€šé |

---

## ğŸ“ æ¨¡çµ„åˆ†æ

### æ¨¡çµ„çµ±è¨ˆ

| æ¨¡çµ„ | æª”æ¡ˆæ•¸ | ç¨‹å¼ç¢¼è¡Œæ•¸ | å‡½æ•¸æ•¸ | é¡åˆ¥æ•¸ | è¤‡é›œåº¦ | ä½”æ¯” |
|------|--------|-----------|--------|--------|--------|------|
| **function** | 53 | 9,864 | 228 | 119 | 795 | 36.5% |
| **scan** | 28 | 7,163 | 199 | 53 | 415 | 26.5% |
| **core** | 28 | 4,850 | 128 | 55 | 285 | 18.0% |
| **integration** | 32 | 3,174 | 96 | 24 | 193 | 11.7% |
| **aiva_common** | 13 | 1,960 | 53 | 48 | 162 | 7.3% |
| **å…¶ä»–** | 1 | 4 | 0 | 0 | 1 | 0.01% |

### æ¨¡çµ„ç‰¹æ€§åˆ†æ

#### ğŸ”¥ function æ¨¡çµ„ (æœ€å¤§æ¨¡çµ„)

- **ç‰¹é»**: åŒ…å«å„ç¨®æ¼æ´æª¢æ¸¬åŠŸèƒ½
- **è¤‡é›œåº¦**: æœ€é«˜ (795)
- **æ”¹é€²å»ºè­°**:
  - éœ€è¦é‡æ§‹é«˜è¤‡é›œåº¦å‡½æ•¸
  - æå‡é¡å‹æç¤ºè¦†è“‹ç‡
  - è£œå……æ–‡æª”å­—ä¸²

#### ğŸ” scan æ¨¡çµ„ (ç¬¬äºŒå¤§æ¨¡çµ„)

- **ç‰¹é»**: æƒæå¼•æ“å’Œå‹•æ…‹å…§å®¹æå–
- **è¤‡é›œåº¦**: æ¬¡é«˜ (415)
- **æ”¹é€²å»ºè­°**:
  - å„ªåŒ–å‹•æ…‹å…§å®¹æå–å™¨
  - ç°¡åŒ–ç€è¦½å™¨æ± ç®¡ç†é‚è¼¯

#### ğŸ§  core æ¨¡çµ„ (æ ¸å¿ƒæ¨¡çµ„)

- **ç‰¹é»**: AI å¼•æ“å’Œæ ¸å¿ƒåˆ†æåŠŸèƒ½
- **è¤‡é›œåº¦**: ä¸­ç­‰ (285)
- **æ”¹é€²å»ºè­°**:
  - å®Œå–„ AI æ¨¡å‹è¨“ç·´æ–‡æª”
  - æå‡å·¥å…·å‡½æ•¸çš„é¡å‹å®‰å…¨æ€§

---

## ğŸ”¥ é«˜è¤‡é›œåº¦æª”æ¡ˆåˆ†æ

### Top 10 æœ€è¤‡é›œçš„æª”æ¡ˆ

| æ’å | æª”æ¡ˆè·¯å¾‘ | è¤‡é›œåº¦ | è¡Œæ•¸ | å‡½æ•¸æ•¸ | ç‹€æ…‹ |
|------|---------|--------|------|--------|------|
| 1 | `aiva_common/utils/network/ratelimit.py` | 91 | 659 | 22 | âš ï¸ æ€¥éœ€é‡æ§‹ |
| 2 | `scan/.../dynamic_content_extractor.py` | 54 | 695 | 7 | âš ï¸ éœ€é‡æ§‹ |
| 3 | `function/function_ssrf/.../worker.py` | 49 | 432 | 8 | âš ï¸ éœ€é‡æ§‹ |
| 4 | `function/function_xss/.../worker.py` | 48 | 444 | 11 | âš ï¸ éœ€é‡æ§‹ |
| 5 | `scan/.../headless_browser_pool.py` | 48 | 553 | 12 | âš ï¸ éœ€é‡æ§‹ |
| 6 | `function/.../traditional_detector.py` | 45 | 237 | 6 | âš ï¸ éœ€é‡æ§‹ |
| 7 | `function/.../param_semantics_analyzer.py` | 44 | 225 | 8 | âš ï¸ éœ€é‡æ§‹ |
| 8 | `function/.../smart_ssrf_detector.py` | 42 | 532 | 7 | âš ï¸ éœ€é‡æ§‹ |
| 9 | `core/aiva_core/ai_engine/tools.py` | 38 | 435 | 13 | âš ï¸ éœ€æ”¹é€² |
| 10 | `function/.../internal_address_detector.py` | 36 | 339 | 7 | âš ï¸ éœ€æ”¹é€² |

### è¤‡é›œåº¦åˆ†æ

- **æ¥µé«˜è¤‡é›œåº¦ (>50)**: 2 å€‹æª”æ¡ˆ
- **é«˜è¤‡é›œåº¦ (40-50)**: 6 å€‹æª”æ¡ˆ
- **ä¸­ç­‰è¤‡é›œåº¦ (30-40)**: 12 å€‹æª”æ¡ˆ
- **å»ºè­°é–¾å€¼**: 30 (McCabe)

---

## ğŸ“ ç¨‹å¼ç¢¼å“è³ªå•é¡Œ

### ç¼ºå°‘æ–‡æª”å­—ä¸²çš„æª”æ¡ˆ (28 å€‹)

**Priority 1 - Worker æª”æ¡ˆ**:

- `function/function_ssrf/aiva_func_ssrf/worker.py`
- `function/function_xss/aiva_func_xss/worker.py`
- `scan/aiva_scan/worker.py`
- `integration/aiva_integration/app.py`

**Priority 2 - æ ¸å¿ƒåŠŸèƒ½**:

- `core/aiva_core/ai_model/train_classifier.py`
- å…¶ä»– 23 å€‹æª”æ¡ˆ

### ç¼ºå°‘é¡å‹æç¤ºçš„æª”æ¡ˆ (39 å€‹)

å»ºè­°å„ªå…ˆç‚ºä»¥ä¸‹é¡å‹çš„æª”æ¡ˆæ·»åŠ é¡å‹æç¤ºï¼š

1. å…¬å…± API ä»‹é¢
2. æ ¸å¿ƒæ¥­å‹™é‚è¼¯
3. å·¥å…·å‡½æ•¸

---

## ğŸ¯ æ”¹é€²å»ºè­°

### å„ªå…ˆç´š P0 (ç·Šæ€¥)

1. **é‡æ§‹é«˜è¤‡é›œåº¦æª”æ¡ˆ**
   - ç›®æ¨™: `ratelimit.py` (è¤‡é›œåº¦ 91 â†’ <30)
   - æ–¹æ³•: æ‹†åˆ†å¤§å‡½æ•¸ã€æå–é‡è¤‡é‚è¼¯ã€ç°¡åŒ–æ¢ä»¶åˆ†æ”¯

2. **è£œå…… Worker æ–‡æª”**
   - ç‚ºæ‰€æœ‰ worker.py æ·»åŠ å®Œæ•´çš„æ–‡æª”å­—ä¸²
   - åŒ…æ‹¬: é¡åˆ¥èªªæ˜ã€æ–¹æ³•èªªæ˜ã€åƒæ•¸èªªæ˜ã€è¿”å›å€¼èªªæ˜

### å„ªå…ˆç´š P1 (é‡è¦)

3. **æå‡é¡å‹æç¤ºè¦†è“‹ç‡**
   - ç›®æ¨™: å¾ 74.8% â†’ 90%+
   - é‡é»: function å’Œ scan æ¨¡çµ„

4. **å„ªåŒ–å‹•æ…‹å¼•æ“**
   - ç°¡åŒ– `dynamic_content_extractor.py`
   - é‡æ§‹ `headless_browser_pool.py`

### å„ªå…ˆç´š P2 (æ”¹é€²)

5. **æ¨™æº–åŒ–éŒ¯èª¤è™•ç†**
   - çµ±ä¸€ç•°å¸¸é¡å‹
   - æ·»åŠ è©³ç´°çš„éŒ¯èª¤è¨Šæ¯

6. **å¢åŠ å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡**
   - ç‚ºé«˜è¤‡é›œåº¦æ¨¡çµ„æ·»åŠ æ¸¬è©¦
   - ç›®æ¨™è¦†è“‹ç‡: 80%+

---

## ğŸ› ï¸ ä½¿ç”¨çš„åˆ†æå·¥å…·

### 1. analyze_codebase.py

- **åŠŸèƒ½**: å…¨é¢çš„ç¨‹å¼ç¢¼éœæ…‹åˆ†æ
- **è¼¸å‡º**: JSON + æ–‡å­—å ±å‘Š
- **ä½ç½®**: `_out/analysis/`

### 2. find_non_cp950_filtered.py

- **åŠŸèƒ½**: æª¢æŸ¥ç·¨ç¢¼ç›¸å®¹æ€§
- **çµæœ**: âœ… ç„¡å•é¡Œ
- **è¼¸å‡º**: `tools/non_cp950_filtered_report.txt`

### 3. å…¶ä»–å¯ç”¨å·¥å…·

- `py2mermaid.py`: ç”Ÿæˆ Mermaid æµç¨‹åœ–
- `markdown_check.py`: Markdown æ ¼å¼æª¢æŸ¥
- `update_imports.py`: å°å…¥èªå¥æ›´æ–°
- `replace_emoji.py`: Emoji æ›¿æ›

---

## ğŸ“ˆ è¶¨å‹¢èˆ‡å»ºè­°

### ç¨‹å¼ç¢¼å¥åº·åº¦è©•åˆ†

| é …ç›® | è©•åˆ† | èªªæ˜ |
|------|------|------|
| **çµæ§‹æ¸…æ™°åº¦** | 8/10 | æ¨¡çµ„åŒ–è‰¯å¥½ï¼Œè·è²¬åˆ†æ˜ |
| **ç¨‹å¼ç¢¼å“è³ª** | 7/10 | é¡å‹æç¤ºå’Œæ–‡æª”éœ€æ”¹é€² |
| **å¯ç¶­è­·æ€§** | 6/10 | é«˜è¤‡é›œåº¦æª”æ¡ˆè¼ƒå¤š |
| **æ¸¬è©¦è¦†è“‹** | ?/10 | éœ€é€²ä¸€æ­¥è©•ä¼° |
| **æ–‡æª”å®Œæ•´æ€§** | 7/10 | å¤šæ•¸æª”æ¡ˆæœ‰æ–‡æª” |

**ç¸½é«”è©•åˆ†**: **7/10** (è‰¯å¥½ï¼Œä½†æœ‰æ”¹é€²ç©ºé–“)

### ä¸‹ä¸€æ­¥è¡Œå‹•

1. âœ… **å·²å®Œæˆ**: ç’°å¢ƒé…ç½®ã€ç¨‹å¼ç¢¼åˆ†æ
2. ğŸ”„ **é€²è¡Œä¸­**: è­˜åˆ¥é‡æ§‹ç›®æ¨™
3. ğŸ“‹ **å¾…è¾¦**:
   - åŸ·è¡Œé‡æ§‹è¨ˆç•«
   - è£œå……æ–‡æª”å’Œé¡å‹æç¤º
   - å¢åŠ å–®å…ƒæ¸¬è©¦
   - æ€§èƒ½å„ªåŒ–

---

## ğŸ“Š é™„éŒ„

### æª”æ¡ˆåˆ†ä½ˆ

```
AIVA (155 files, 27,015 lines)
â”œâ”€â”€ function/       (53 files, 36.5%)  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â”œâ”€â”€ scan/          (28 files, 26.5%)  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â”œâ”€â”€ core/          (28 files, 18.0%)  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â”œâ”€â”€ integration/   (32 files, 11.7%)  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â””â”€â”€ aiva_common/   (13 files,  7.3%)  â–ˆâ–ˆâ–ˆâ–ˆ
```

### ç›¸é—œæ–‡ä»¶

- **å®Œæ•´ JSON å ±å‘Š**: `_out/analysis/analysis_report_20251013_121623.json`
- **æ–‡å­—å ±å‘Š**: `_out/analysis/analysis_report_20251013_121623.txt`
- **ç·¨ç¢¼å ±å‘Š**: `tools/non_cp950_filtered_report.txt`
- **å·¥å…·æ–‡æª”**: `tools/README.md`

---

**å ±å‘ŠçµæŸ** | ç”Ÿæˆæ–¼ 2025-10-13 | AIVA å°ˆæ¡ˆåœ˜éšŠ
