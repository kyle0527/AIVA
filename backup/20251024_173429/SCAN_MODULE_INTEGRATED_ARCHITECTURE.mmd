---
title: AIVA Scan Module Integrated Architecture
---
flowchart TB
    %% User Interface Layer
    subgraph UI["User Interface Layer"]
        CLI["Command Line Interface"]
        API["REST API Endpoints"] 
        WEB["Web Dashboard"]
    end

    %% Configuration and Strategy Layer
    subgraph CONFIG["Configuration & Strategy Management"]
        SC["Strategy Controller"]
        CCC["Config Control Center"]
        AM["Authentication Manager"]
        HM["Header Configuration"]
        SM["Scope Manager"]
    end

    %% Core Scanning Engines
    subgraph ENGINES["Dual Scanning Engines"]
        subgraph STATIC["Static Engine (Python)"]
            HC["HTTP Client"]
            SCP["Static Content Parser"]
            UQM["URL Queue Manager"]
        end
        
        subgraph DYNAMIC["Dynamic Engine (TypeScript)"]
            HBP["Headless Browser Pool"]
            DCE["Dynamic Content Extractor"] 
            JIS["JS Interaction Simulator"]
            AAH["AJAX API Handler"]
        end
    end

    %% Information Gathering Components
    subgraph INFO["Information Gathering"]
        JSA["JavaScript Source Analyzer"]
        SID["Sensitive Info Detector"]
        PF["Passive Fingerprinter"]
        FM["Fingerprint Manager"]
    end

    %% Security Scanning Components  
    subgraph SECURITY["Security Scanning"]
        OSS["Optimized Security Scanner"]
        VS["Vulnerability Scanner"]
        SDS["Sensitive Data Scanner"]
        NS["Network Scanner"]
        SD["Service Detector"]
    end

    %% Context and Orchestration
    subgraph ORCHESTRATION["Orchestration & Context"]
        SO["Scan Orchestrator"]
        SCX["Scan Context"]
        W["Worker Processes"]
    end

    %% Data and Results
    subgraph DATA["Data Management"]
        SCHEMAS["Result Schemas"]
        DB[("Results Database")]
        LOG[("Audit Logs")]
    end

    %% Integration Points
    subgraph INTEGRATION["Integration Services"]
        AI_REC["AI Operation Recorder"]
        PERF["Performance Monitor"]
        META["Metadata Analyzer"]
        RPT["Report Generator"]
    end

    %% Flow Connections - Strategy Selection
    CLI --> SC
    API --> SC 
    WEB --> SC
    
    SC --> CCC
    SC -.->|"Strategy: CONSERVATIVE/FAST/STEALTH"| STATIC
    SC -.->|"Strategy: BALANCED/DEEP/AGGRESSIVE"| STATIC
    SC -.->|"Strategy: BALANCED/DEEP/AGGRESSIVE"| DYNAMIC

    %% Configuration Flow
    CCC --> AM
    CCC --> HM
    CCC --> SM
    CCC --> SO

    %% Orchestration Flow
    SO --> SCX
    SO --> STATIC
    SO --> DYNAMIC
    SO --> W

    %% Engine to Information Gathering
    STATIC --> INFO
    DYNAMIC --> INFO
    INFO --> FM

    %% Security Scanning Flow
    STATIC --> SECURITY
    DYNAMIC --> SECURITY
    INFO --> SECURITY

    %% Data Flow
    SECURITY --> SCHEMAS
    INFO --> SCHEMAS
    SCHEMAS --> DB
    SO --> LOG

    %% Integration Flow
    SO --> INTEGRATION
    SECURITY --> AI_REC
    PERF --> META
    SCHEMAS --> RPT

    %% Styling for different components
    classDef strategy fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef engine fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef security fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef data fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef integration fill:#fce4ec,stroke:#880e4f,stroke-width:2px

    %% Apply styles
    class SC,CCC,AM,HM,SM strategy
    class HC,SCP,UQM,HBP,DCE,JIS,AAH engine
    class OSS,VS,SDS,NS,SD security
    class SCHEMAS,DB,LOG data
    class AI_REC,PERF,META,RPT integration

    %% Critical Path Highlighting
    SC ==>|"Critical Path"| CCC
    CCC ==>|"Critical Path"| SO
    SO ==>|"Critical Path"| STATIC
    SO ==>|"Critical Path"| DYNAMIC